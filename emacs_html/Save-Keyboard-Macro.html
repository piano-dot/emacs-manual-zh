<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Save Keyboard Macro (GNU Emacs Manual)</title>

<meta name="description" content="Save Keyboard Macro (GNU Emacs Manual)">
<meta name="keywords" content="Save Keyboard Macro (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Keyboard-Macros.html" rel="up" title="Keyboard Macros">
<link href="Edit-Keyboard-Macro.html" rel="next" title="Edit Keyboard Macro">
<link href="Keyboard-Macro-Query.html" rel="prev" title="Keyboard Macro Query">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="Save-Keyboard-Macro">
<div class="nav-panel">
<p>
Next: <a href="Edit-Keyboard-Macro.html" accesskey="n" rel="next">Editing a Keyboard Macro</a>, Previous: <a href="Keyboard-Macro-Query.html" accesskey="p" rel="prev">Executing Macros with Variations</a>, Up: <a href="Keyboard-Macros.html" accesskey="u" rel="up">Keyboard Macros</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Naming-and-Saving-Keyboard-Macros"><span>18.5 Naming and Saving Keyboard Macros<a class="copiable-link" href="#Naming-and-Saving-Keyboard-Macros"> &para;</a></span></h3>

<dl class="table">
<dt><kbd class="kbd">C-x C-k n</kbd></dt>
<dd><p>Give a command name (for the duration of the Emacs session) to the most
recently defined keyboard macro (<code class="code">kmacro-name-last-macro</code>).
</p></dd>
<dt><kbd class="kbd">C-x C-k b</kbd></dt>
<dd><p>Bind the most recently defined keyboard macro to a key sequence (for
the duration of the session) (<code class="code">kmacro-bind-to-key</code>).
</p></dd>
<dt><kbd class="kbd">M-x insert-kbd-macro</kbd></dt>
<dd><p>Insert in the buffer a keyboard macro&rsquo;s definition, as Lisp code.
</p></dd>
</dl>

<a class="index-entry-id" id="index-saving-keyboard-macros"></a>
<a class="index-entry-id" id="index-kmacro_002dname_002dlast_002dmacro"></a>
<a class="index-entry-id" id="index-C_002dx-C_002dk-n"></a>
<p>If you wish to save a keyboard macro for later use, you can give it
a name using <kbd class="kbd">C-x C-k n</kbd> (<code class="code">kmacro-name-last-macro</code>).
This reads a name as an argument using the minibuffer and defines that
name to execute the last keyboard macro, in its current form.  (If you
later add to the definition of this macro, that does not alter the
name&rsquo;s definition as a macro.)  The macro name is a Lisp symbol, and
defining it in this way makes it a valid command name for calling with
<kbd class="kbd">M-x</kbd> or for binding a key to with <code class="code">keymap-global-set</code>
(see <a class="pxref" href="Keymaps.html">Keymaps</a>).  If you specify a name that has a prior definition
other than a keyboard macro, an error message is shown and nothing is
changed.
</p>
<a class="index-entry-id" id="index-binding-keyboard-macros"></a>
<a class="index-entry-id" id="index-kmacro_002dbind_002dto_002dkey"></a>
<a class="index-entry-id" id="index-C_002dx-C_002dk-b"></a>
<p>You can also bind the last keyboard macro (in its current form) to a
key, using <kbd class="kbd">C-x C-k b</kbd> (<code class="code">kmacro-bind-to-key</code>) followed by the
key sequence you want to bind.  You can bind to any key sequence in
the global keymap, but since most key sequences already have other
bindings, you should select the key sequence carefully.  If you try to
bind to a key sequence with an existing binding (in any keymap), this
command asks you for confirmation before replacing the existing binding.
</p>
<p>To avoid problems caused by overriding existing bindings, the key
sequences <kbd class="kbd">C-x C-k 0</kbd> through <kbd class="kbd">C-x C-k 9</kbd> and <kbd class="kbd">C-x C-k A</kbd>
through <kbd class="kbd">C-x C-k Z</kbd> are reserved for your own keyboard macro
bindings.  In fact, to bind to one of these key sequences, you only
need to type the digit or letter rather than the whole key sequences.
For example,
</p>
<div class="example">
<pre class="example-preformatted">C-x C-k b 4
</pre></div>

<p>will bind the last keyboard macro to the key sequence <kbd class="kbd">C-x C-k 4</kbd>.
</p>
<a class="index-entry-id" id="index-insert_002dkbd_002dmacro"></a>
<p>Once a macro has a command name, you can save its definition in a file.
Then it can be used in another editing session.  First, visit the file
you want to save the definition in.  Then use this command:
</p>
<div class="example">
<pre class="example-preformatted">M-x insert-kbd-macro <kbd class="key">RET</kbd> <var class="var">macroname</var> <kbd class="key">RET</kbd>
</pre></div>

<p>This inserts some Lisp code that, when executed later, will define the
same macro with the same definition it has now.  (You don&rsquo;t need to
understand Lisp code to do this, because <code class="code">insert-kbd-macro</code> writes
the Lisp code for you.)  Then save the file.  You can load the file
later with <code class="code">load-file</code> (see <a class="pxref" href="Lisp-Libraries.html">Libraries of Lisp Code for Emacs</a>).  If the file you
save in is your init file <samp class="file">~/.emacs</samp> (see <a class="pxref" href="Init-File.html">The Emacs Initialization File</a>) then the
macro will be defined each time you run Emacs.
</p>
<p>If you give <code class="code">insert-kbd-macro</code> a prefix argument, it makes
additional Lisp code to record the keys (if any) that you have bound
to <var class="var">macroname</var>, so that the macro will be reassigned the same keys
when you load the file.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Edit-Keyboard-Macro.html">Editing a Keyboard Macro</a>, Previous: <a href="Keyboard-Macro-Query.html">Executing Macros with Variations</a>, Up: <a href="Keyboard-Macros.html">Keyboard Macros</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
