<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>ls in Lisp (GNU Emacs Manual)</title>

<meta name="description" content="ls in Lisp (GNU Emacs Manual)">
<meta name="keywords" content="ls in Lisp (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Microsoft-Windows.html" rel="up" title="Microsoft Windows">
<link href="Windows-HOME.html" rel="next" title="Windows HOME">
<link href="Windows-Files.html" rel="prev" title="Windows Files">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="ls-in-Lisp">
<div class="nav-panel">
<p>
Next: <a href="Windows-HOME.html" accesskey="n" rel="next">HOME and Startup Directories on MS-Windows</a>, Previous: <a href="Windows-Files.html" accesskey="p" rel="prev">File Names on MS-Windows</a>, Up: <a href="Microsoft-Windows.html" accesskey="u" rel="up">Emacs and Microsoft Windows/MS-DOS</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Emulation-of-ls-on-MS_002dWindows"><span>I.4 Emulation of <code class="code">ls</code> on MS-Windows<a class="copiable-link" href="#Emulation-of-ls-on-MS_002dWindows"> &para;</a></span></h3>
<a class="index-entry-id" id="index-Dired_002c-and-MS_002dWindows_002fMS_002dDOS"></a>
<a class="index-entry-id" id="index-ls-emulation"></a>

<p>Dired normally uses the external program <code class="code">ls</code>
to produce the directory listing displayed in Dired
buffers (see <a class="pxref" href="Dired.html">Dired, the Directory Editor</a>).  However, MS-Windows and MS-DOS systems don&rsquo;t
come with such a program, although several ports of <small class="sc">GNU</small> <code class="code">ls</code>
are available.  Therefore, Emacs on those systems <em class="emph">emulates</em>
<code class="code">ls</code> in Lisp, by using the <samp class="file">ls-lisp.el</samp> package.  While
<samp class="file">ls-lisp.el</samp> provides a reasonably full emulation of <code class="code">ls</code>,
there are some options and features peculiar to that emulation;
they are described in this section.
</p>
<p>The <code class="code">ls</code> emulation supports many of the <code class="code">ls</code> switches, but
it doesn&rsquo;t support all of them.  Here&rsquo;s the list of the switches it
does support: <samp class="option">-A</samp>, <samp class="option">-a</samp>, <samp class="option">-B</samp>, <samp class="option">-C</samp>,
<samp class="option">-c</samp>, <samp class="option">-G</samp>, <samp class="option">-g</samp>, <samp class="option">-h</samp>, <samp class="option">-i</samp>, <samp class="option">-n</samp>,
<samp class="option">-R</samp>, <samp class="option">-r</samp>, <samp class="option">-S</samp>, <samp class="option">-s</samp>, <samp class="option">-t</samp>, <samp class="option">-U</samp>,
<samp class="option">-u</samp>, <samp class="option">-v</samp>, and <samp class="option">-X</samp>.  The <samp class="option">-F</samp> switch is
partially supported (it appends the character that classifies the
file, but does not prevent symlink following).
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002duse_002dinsert_002ddirectory_002dprogram"></a>
<p>On MS-Windows and MS-DOS, <samp class="file">ls-lisp.el</samp> is preloaded when Emacs
is built, so the Lisp emulation of <code class="code">ls</code> is always used on those
platforms.  If you have a ported <code class="code">ls</code>, setting
<code class="code">ls-lisp-use-insert-directory-program</code> to a non-<code class="code">nil</code> value
will revert to using an external program named by the variable
<code class="code">insert-directory-program</code>.
</p>
<a class="index-entry-id" id="index-Dired-sorting-order_002c-on-MS_002dWindows_002fMS_002dDOS"></a>
<p>The order in which <samp class="file">ls-lisp.el</samp> sorts files depends on several
customizable options described below.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002duse_002dstring_002dcollate"></a>
<p>The default sorting order follows locale-specific rules derived from
your system locale.  You can make the order locale-independent by
customizing <code class="code">ls-lisp-use-string-collate</code> to a <code class="code">nil</code> value.
</p>
<a class="index-entry-id" id="index-Unicode-Collation-Algorithm-_0028UCA_0029_002c-and-ls_002dlisp_002eel"></a>
<a class="index-entry-id" id="index-ls_002dlisp_002dUCA_002dlike_002dcollation"></a>
<p>On GNU and Unix systems, when the locale&rsquo;s encoding is UTF-8, the
collation order follows the Unicode Collation Algorithm
(<abbr class="acronym">UCA</abbr>).  To have a similar effect on MS-Windows, the variable
<code class="code">ls-lisp-UCA-like-collation</code> should have a non-<code class="code">nil</code> value
(this is the default).  The resulting sorting order ignores
punctuation, symbol characters, and whitespace characters, so
<samp class="file">.foobar</samp>, <samp class="file">foobar</samp> and <samp class="file">foo&nbsp;bar</samp><!-- /@w --> will appear
together rather than far apart.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002dignore_002dcase"></a>
<p>By default, <samp class="file">ls-lisp.el</samp> uses a case-sensitive sort order for
the directory listing it produces; this is so the listing looks the
same as on other platforms.  If you wish that the files be sorted in
case-insensitive order, set the variable <code class="code">ls-lisp-ignore-case</code> to
a non-<code class="code">nil</code> value.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002ddirs_002dfirst"></a>
<p>By default, files and subdirectories are sorted together, to emulate
the behavior of <code class="code">ls</code>.  However, native MS-Windows/MS-DOS file
managers list the directories before the files; if you want that
behavior, customize the option <code class="code">ls-lisp-dirs-first</code> to a
non-<code class="code">nil</code> value.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002dverbosity"></a>
<p>The variable <code class="code">ls-lisp-verbosity</code> controls the file attributes
that <samp class="file">ls-lisp.el</samp> displays.  The value should be either
<code class="code">nil</code> or a list that contains one or more of the symbols
<code class="code">links</code>, <code class="code">uid</code>, and <code class="code">gid</code>.  <code class="code">links</code> means display
the count of different file names that are associated with (a.k.a.
<em class="dfn">links to</em>) the file&rsquo;s data; this is only useful on NTFS volumes.
<code class="code">uid</code> means display the numerical identifier of the user who owns
the file.  <code class="code">gid</code> means display the numerical identifier of the
file owner&rsquo;s group.  The default value is <code class="code">(links uid gid)</code> i.e.,
all the 3 optional attributes are displayed.  The value <code class="code">nil</code>
means not to display any of these attributes.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002demulation"></a>
<p>The variable <code class="code">ls-lisp-emulation</code> controls the flavor of the
<code class="code">ls</code> emulation by setting the defaults for the 3 options
described above: <code class="code">ls-lisp-ignore-case</code>,
<code class="code">ls-lisp-dirs-first</code>, and <code class="code">ls-lisp-verbosity</code>.  The value of
this option can be one of the following symbols:
</p>
<dl class="table">
<dt><code class="code">GNU</code></dt>
<dt><code class="code">nil</code></dt>
<dd><p>Emulate <small class="sc">GNU</small> systems; this is the default.  This sets
<code class="code">ls-lisp-ignore-case</code> and <code class="code">ls-lisp-dirs-first</code> to
<code class="code">nil</code>, and <code class="code">ls-lisp-verbosity</code> to <code class="code">(links uid gid)</code>.
</p></dd>
<dt><code class="code">UNIX</code></dt>
<dd><p>Emulate Unix systems.  Like <code class="code">GNU</code>, but sets
<code class="code">ls-lisp-verbosity</code> to <code class="code">(links uid)</code>.
</p></dd>
<dt><code class="code">MacOS</code></dt>
<dd><p>Emulate macOS.  Sets <code class="code">ls-lisp-ignore-case</code> to <code class="code">t</code>, and
<code class="code">ls-lisp-dirs-first</code> and <code class="code">ls-lisp-verbosity</code> to <code class="code">nil</code>.
</p></dd>
<dt><code class="code">MS-Windows</code></dt>
<dd><p>Emulate MS-Windows.  Sets <code class="code">ls-lisp-ignore-case</code> and
<code class="code">ls-lisp-dirs-first</code> to <code class="code">t</code>, and <code class="code">ls-lisp-verbosity</code> to
<code class="code">nil</code> on Windows 9X and to <code class="code">t</code> on modern versions of
Windows.  Note that the default emulation is <em class="emph">not</em>
<code class="code">MS-Windows</code>, even on Windows, since many users of Emacs on those
platforms prefer the <small class="sc">GNU</small> defaults.
</p></dd>
</dl>

<p>Any other value of <code class="code">ls-lisp-emulation</code> means the same as <code class="code">GNU</code>.
Customizing this option calls the function <code class="code">ls-lisp-set-options</code> to
update the 3 dependent options as needed.  If you change the value of
this variable without using customize after <samp class="file">ls-lisp.el</samp> is loaded
(note that it is preloaded on MS-Windows and MS-DOS), you can call that
function manually for the same result.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002dsupport_002dshell_002dwildcards"></a>
<p>The variable <code class="code">ls-lisp-support-shell-wildcards</code> controls how
file-name patterns are supported: if it is non-<code class="code">nil</code> (the
default), they are treated as shell-style wildcards; otherwise they
are treated as Emacs regular expressions.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002dformat_002dtime_002dlist"></a>
<p>The variable <code class="code">ls-lisp-format-time-list</code> defines how to format
the date and time of files.  <em class="emph">The value of this variable is
ignored</em>, unless Emacs cannot determine the current locale.  (However,
if the value of <code class="code">ls-lisp-use-localized-time-format</code> is
non-<code class="code">nil</code>, Emacs obeys <code class="code">ls-lisp-format-time-list</code> even if
the current locale is available; see below.)
</p>
<p>The value of <code class="code">ls-lisp-format-time-list</code> is a list of 2 strings.
The first string is used if the file was modified within the current
year, while the second string is used for older files.  In each of
these two strings you can use &lsquo;<samp class="samp">%</samp>&rsquo;-sequences to substitute parts
of the time.  For example:
</p><div class="example lisp">
<pre class="lisp-preformatted">(&quot;%b %e %H:%M&quot; &quot;%b %e  %Y&quot;)
</pre></div>

<p>Note that the strings substituted for these &lsquo;<samp class="samp">%</samp>&rsquo;-sequences depend
on the current locale.  See <a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Time-Parsing.html#Time-Parsing">Time Parsing</a> in <cite class="cite">The Emacs Lisp
Reference Manual</cite>, for more about format time specs.
</p>
<a class="index-entry-id" id="index-ls_002dlisp_002duse_002dlocalized_002dtime_002dformat"></a>
<p>Normally, Emacs formats the file time stamps in either traditional
or ISO-style time format.  However, if the value of the variable
<code class="code">ls-lisp-use-localized-time-format</code> is non-<code class="code">nil</code>, Emacs
formats file time stamps according to what
<code class="code">ls-lisp-format-time-list</code> specifies.  The &lsquo;<samp class="samp">%</samp>&rsquo;-sequences in
<code class="code">ls-lisp-format-time-list</code> produce locale-dependent month and day
names, which might cause misalignment of columns in Dired display.
The default value of <code class="code">ls-lisp-use-localized-time-format</code> is
<code class="code">nil</code>.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Windows-HOME.html">HOME and Startup Directories on MS-Windows</a>, Previous: <a href="Windows-Files.html">File Names on MS-Windows</a>, Up: <a href="Microsoft-Windows.html">Emacs and Microsoft Windows/MS-DOS</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
