<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Grep Searching (GNU Emacs Manual)</title>

<meta name="description" content="Grep Searching (GNU Emacs Manual)">
<meta name="keywords" content="Grep Searching (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Building.html" rel="up" title="Building">
<link href="Flymake.html" rel="next" title="Flymake">
<link href="Compilation-Shell.html" rel="prev" title="Compilation Shell">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="Grep-Searching">
<div class="nav-panel">
<p>
Next: <a href="Flymake.html" accesskey="n" rel="next">Finding Syntax Errors On The Fly</a>, Previous: <a href="Compilation-Shell.html" accesskey="p" rel="prev">Subshells for Compilation</a>, Up: <a href="Building.html" accesskey="u" rel="up">Compiling and Testing Programs</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Searching-with-Grep-under-Emacs"><span>28.4 Searching with Grep under Emacs<a class="copiable-link" href="#Searching-with-Grep-under-Emacs"> &para;</a></span></h3>

<p>Just as you can run a compiler from Emacs and then visit the lines
with compilation errors, you can also run <code class="command">grep</code> and then
visit the lines on which matches were found.  This works by treating
the matches reported by <code class="command">grep</code> as if they were errors.
The output buffer uses Grep mode, which is a variant of Compilation
mode (see <a class="pxref" href="Compilation-Mode.html">Compilation Mode</a>).
</p>
<dl class="table">
<dt><kbd class="kbd">M-x grep</kbd></dt>
<dt><kbd class="kbd">M-x lgrep</kbd></dt>
<dd><p>Run <code class="command">grep</code> asynchronously under Emacs, listing matching lines in
the buffer named <samp class="file">*grep*</samp>.
</p></dd>
<dt><kbd class="kbd">M-x grep-find</kbd></dt>
<dt><kbd class="kbd">M-x find-grep</kbd></dt>
<dt><kbd class="kbd">M-x rgrep</kbd></dt>
<dd><p>Run <code class="command">grep</code> via <code class="code">find</code>, and collect output in the
<samp class="file">*grep*</samp> buffer.
</p></dd>
<dt><kbd class="kbd">M-x zrgrep</kbd></dt>
<dd><p>Run <code class="code">zgrep</code> and collect output in the <samp class="file">*grep*</samp> buffer.
</p></dd>
<dt><kbd class="kbd">M-x kill-grep</kbd></dt>
<dd><p>Kill the running <code class="command">grep</code> subprocess.
</p></dd>
</dl>

<a class="index-entry-id" id="index-grep"></a>
<p>To run <code class="command">grep</code>, type <kbd class="kbd">M-x grep</kbd>, then enter a command line
that specifies how to run <code class="command">grep</code>.  Use the same arguments you
would give <code class="command">grep</code> when running it normally: a <code class="command">grep</code>-style
regexp (usually in single-quotes to quote the shell&rsquo;s special
characters) followed by file names, which may use wildcards.  If you
specify a prefix argument for <kbd class="kbd">M-x grep</kbd>, it finds the identifier
(see <a class="pxref" href="Xref.html">Find Identifier References</a>) in the buffer around point, and puts that into the
default <code class="command">grep</code> command.
</p>
<p>Your command need not simply run <code class="command">grep</code>; you can use any shell
command that produces output in the same format.  For instance, you
can chain <code class="command">grep</code> commands, like this:
</p>
<div class="example">
<pre class="example-preformatted">grep -nH -e foo *.el | grep bar | grep toto
</pre></div>

<p>The output from <code class="command">grep</code> goes in the <samp class="file">*grep*</samp> buffer.  You
can find the corresponding lines in the original files using <kbd class="kbd">M-g&nbsp;M-n</kbd><!-- /@w -->, <kbd class="key">RET</kbd>, and so forth, just like compilation errors.
See <a class="xref" href="Compilation-Mode.html">Compilation Mode</a>, for detailed description of commands and key
bindings available in the <samp class="file">*grep*</samp> buffer.
</p>
<a class="index-entry-id" id="index-grep_002dmatch_002dregexp"></a>
<p>Some grep programs accept a &lsquo;<samp class="samp">--color</samp>&rsquo; option to output special
markers around matches for the purpose of highlighting.  You can make
use of this feature by setting <code class="code">grep-highlight-matches</code> to
<code class="code">t</code>.  When displaying a match in the source buffer, the exact
match will be highlighted, instead of the entire source line.
Highlighting is provided via matching the <abbr class="acronym">ANSI</abbr> escape
sequences emitted by <code class="command">grep</code>.  The matching of the sequences is
controlled by <code class="code">grep-match-regexp</code>, which can be customized to
accommodate different <code class="command">grep</code> programs.
</p>
<p>As with compilation commands (see <a class="pxref" href="Compilation.html">Running Compilations under Emacs</a>), while the grep
command runs, the mode line shows the running number of matches found
and highlighted so far.
</p>
<p>The <code class="command">grep</code> commands will offer to save buffers before
running.  This is controlled by the <code class="code">grep-save-buffers</code> variable.
The possible values are either <code class="code">nil</code> (don&rsquo;t save), <code class="code">ask</code>
(ask before saving), or a function which will be used as a predicate
(and is called with the file name as the parameter and should return
non-<code class="code">nil</code> if the buffer is to be saved).  Any other
non-<code class="code">nil</code> value means that all buffers should be saved without
asking.  The default is <code class="code">ask</code>.
</p>
<a class="index-entry-id" id="index-grep_002dfind"></a>
<a class="index-entry-id" id="index-find_002dgrep"></a>
<p>The command <kbd class="kbd">M-x grep-find</kbd> (also available as <kbd class="kbd">M-x
find-grep</kbd>) is similar to <kbd class="kbd">M-x grep</kbd>, but it supplies a different
initial default for the command&mdash;one that runs both <code class="code">find</code> and
<code class="command">grep</code>, so as to search every file in a directory tree.  See also
the <code class="code">find-grep-dired</code> command, in <a class="ref" href="Dired-and-Find.html">Dired and <code class="code">find</code></a>.
</p>
<a class="index-entry-id" id="index-lgrep"></a>
<a class="index-entry-id" id="index-rgrep"></a>
<a class="index-entry-id" id="index-zrgrep"></a>
<p>The commands <kbd class="kbd">M-x lgrep</kbd> (local grep) and <kbd class="kbd">M-x rgrep</kbd>
(recursive grep) are more user-friendly versions of <code class="command">grep</code> and
<code class="code">grep-find</code>, which prompt separately for the regular expression
to match, the files to search, and the base directory for the search.
Case sensitivity of the search is controlled by the current value of
<code class="code">case-fold-search</code>.  The command <kbd class="kbd">M-x zrgrep</kbd> is similar to
<kbd class="kbd">M-x rgrep</kbd>, but it calls <code class="command">zgrep</code> instead of
<code class="command">grep</code> to search the contents of gzipped files.
</p>
<p>These commands build the shell commands based on the variables
<code class="code">grep-template</code> (for <code class="code">lgrep</code>) and <code class="code">grep-find-template</code>
(for <code class="code">rgrep</code>).  The files to search can use aliases defined in
the variable <code class="code">grep-files-aliases</code>.
</p>
<a class="index-entry-id" id="index-grep_002dfind_002dignored_002ddirectories"></a>
<p>Directories listed in the variable
<code class="code">grep-find-ignored-directories</code> are automatically skipped by
<kbd class="kbd">M-x rgrep</kbd>.  The default value includes the data directories used
by various version control systems.
</p>
<a class="index-entry-id" id="index-grep_002dfind_002dabbreviate"></a>
<a class="index-entry-id" id="index-grep_002dfind_002dtoggle_002dabbreviation"></a>
<p>By default, the shell commands constructed for <code class="code">lgrep</code>,
<code class="code">rgrep</code>, and <code class="code">zgrep</code> are abbreviated for display by
concealing the part that contains a long list of files and directories
to ignore.  You can reveal the concealed part by clicking on the
button with ellipsis, which represents them.  You can also
interactively toggle viewing the concealed part by typing <kbd class="kbd">M-x
grep-find-toggle-abbreviation</kbd>.  To disable this abbreviation of the
shell commands, customize the option <code class="code">grep-find-abbreviate</code> to a
<code class="code">nil</code> value.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Flymake.html">Finding Syntax Errors On The Fly</a>, Previous: <a href="Compilation-Shell.html">Subshells for Compilation</a>, Up: <a href="Building.html">Compiling and Testing Programs</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
