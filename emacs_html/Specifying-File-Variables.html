<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Specifying File Variables (GNU Emacs Manual)</title>

<meta name="description" content="Specifying File Variables (GNU Emacs Manual)">
<meta name="keywords" content="Specifying File Variables (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="File-Variables.html" rel="up" title="File Variables">
<link href="Safe-File-Variables.html" rel="next" title="Safe File Variables">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
ul.mark-bullet {list-style-type: disc}
-->
</style>


</head>

<body lang="zh_CN">
<div class="subsubsection-level-extent" id="Specifying-File-Variables">
<div class="nav-panel">
<p>
Next: <a href="Safe-File-Variables.html" accesskey="n" rel="next">Safety of File Variables</a>, Up: <a href="File-Variables.html" accesskey="u" rel="up">Local Variables in Files</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h4 class="subsubsection" id="Specifying-File-Variables-1"><span>37.2.4.1 Specifying File Variables<a class="copiable-link" href="#Specifying-File-Variables-1"> &para;</a></span></h4>

<p>There are two ways to specify file local variable values: in the first
line, or with a local variables list.  Here&rsquo;s how to specify them in the
first line:
</p>
<div class="example">
<pre class="example-preformatted">-*- mode: <var class="var">modename</var>; <var class="var">var</var>: <var class="var">value</var>; ... -*-
</pre></div>

<p>You can specify any number of variable/value pairs in this way, each
pair with a colon and semicolon.  The special variable/value pair
<code class="code">mode: <var class="var">modename</var>;</code>, if present, specifies a major mode
(without the &ldquo;-mode&rdquo; suffix).  The <var class="var">value</var>s are used literally,
and not evaluated.
</p>
<a class="index-entry-id" id="index-add_002dfile_002dlocal_002dvariable_002dprop_002dline"></a>
<a class="index-entry-id" id="index-delete_002dfile_002dlocal_002dvariable_002dprop_002dline"></a>
<a class="index-entry-id" id="index-copy_002ddir_002dlocals_002dto_002dfile_002dlocals_002dprop_002dline"></a>
<p>You can use <kbd class="kbd">M-x add-file-local-variable-prop-line</kbd> instead of
adding entries by hand.  This command prompts for a variable and
value, and adds them to the first line in the appropriate way.
<kbd class="kbd">M-x delete-file-local-variable-prop-line</kbd> prompts for a variable,
and deletes its entry from the line.  The command <kbd class="kbd">M-x
copy-dir-locals-to-file-locals-prop-line</kbd> copies the current
directory-local variables to the first line (see <a class="pxref" href="Directory-Variables.html">Per-Directory Local Variables</a>).
</p>
<p>Here is an example first line that specifies Lisp mode and sets two
variables with numeric values:
</p>
<div class="example smallexample">
<pre class="example-preformatted">;; -*- mode: Lisp; fill-column: 75; comment-column: 50; -*-
</pre></div>

<p>Aside from <code class="code">mode</code>, other keywords that have special meanings as
file variables are <code class="code">coding</code>, <code class="code">unibyte</code>, and <code class="code">eval</code>.
These are described below.
</p>
<a class="index-entry-id" id="index-shell-scripts_002c-and-local-file-variables"></a>
<a class="index-entry-id" id="index-man-pages_002c-and-local-file-variables"></a>
<p>In shell scripts, the first line is used to identify the script
interpreter, so you cannot put any local variables there.  To
accommodate this, Emacs looks for local variable specifications in the
<em class="emph">second</em> line if the first line specifies an interpreter.  The
same is true for man pages which start with the magic string
&lsquo;<samp class="samp">'\&quot;</samp>&rsquo; to specify a list of troff preprocessors (not all do,
however).
</p>
<p>Apart from using a &lsquo;<samp class="samp">-*-</samp>&rsquo; line, you can define file local
variables using a <em class="dfn">local variables list</em> near the end of the file.
The start of the local variables list should be no more than 3000
characters from the end of the file, and must be on the last page if
the file is divided into pages.
</p>
<p>If a file has both a local variables list and a &lsquo;<samp class="samp">-*-</samp>&rsquo; line,
Emacs processes <em class="emph">everything</em> in the &lsquo;<samp class="samp">-*-</samp>&rsquo; line first, and
<em class="emph">everything</em> in the local variables list afterward.  The exception
to this is a major mode specification.  Emacs applies this first,
wherever it appears, since most major modes kill all local variables as
part of their initialization.
</p>
<p>A local variables list starts with a line containing the string
&lsquo;<samp class="samp">Local Variables:</samp>&rsquo;, and ends with a line containing the string
&lsquo;<samp class="samp">End:</samp>&rsquo;.  In between come the variable names and values, one set
per line, like this:
</p>
<div class="example">
<pre class="example-preformatted">/* Local Variables:  */
/* mode: c           */
/* comment-column: 0 */
/* End:              */
</pre></div>

<p>In this example, each line starts with the prefix &lsquo;<samp class="samp">/*</samp>&rsquo; and ends
with the suffix &lsquo;<samp class="samp">*/</samp>&rsquo;.  Emacs recognizes the prefix and suffix by
finding them surrounding the magic string &lsquo;<samp class="samp">Local Variables:</samp>&rsquo;, on
the first line of the list; it then automatically discards them from
the other lines of the list.  The usual reason for using a prefix
and/or suffix is to embed the local variables list in a comment, so it
won&rsquo;t confuse other programs that the file is intended for.  The
example above is for the C programming language, where comments start
with &lsquo;<samp class="samp">/*</samp>&rsquo; and end with &lsquo;<samp class="samp">*/</samp>&rsquo;.
</p>
<p>If some unrelated text might look to Emacs as a local variables list,
you can countermand that by inserting a form-feed character (a page
delimiter, see <a class="pxref" href="Pages.html">Pages</a>) after that text.  Emacs only looks for
file-local variables in the last page of a file, after the last page
delimiter.
</p>
<a class="index-entry-id" id="index-add_002dfile_002dlocal_002dvariable"></a>
<a class="index-entry-id" id="index-delete_002dfile_002dlocal_002dvariable"></a>
<a class="index-entry-id" id="index-copy_002ddir_002dlocals_002dto_002dfile_002dlocals"></a>
<p>Instead of typing in the local variables list directly, you can use
the command <kbd class="kbd">M-x add-file-local-variable</kbd>.  This prompts for a
variable and value, and adds them to the list, adding the &lsquo;<samp class="samp">Local
Variables:</samp>&rsquo; string and start and end markers as necessary.  The
command <kbd class="kbd">M-x delete-file-local-variable</kbd> deletes a variable from
the list.  <kbd class="kbd">M-x copy-dir-locals-to-file-locals</kbd> copies
directory-local variables to the list (see <a class="pxref" href="Directory-Variables.html">Per-Directory Local Variables</a>).
</p>
<p>As with the &lsquo;<samp class="samp">-*-</samp>&rsquo; line, the variables in a local variables list
are used literally, and are not evaluated first.  If you want to split
a long string value across multiple lines of the file, you can use
backslash-newline, which is ignored in Lisp string constants; you
should put the prefix and suffix on each line, even lines that start
or end within the string, as they will be stripped off when processing
the list.  Here is an example:
</p>
<div class="example">
<pre class="example-preformatted"># Local Variables:
# compile-command: &quot;cc foo.c -Dfoo=bar -Dhack=whatever \
#   -Dmumble=blaah&quot;
# End:
</pre></div>

<p>Some names have special meanings in a local variables
list:
</p>
<ul class="itemize mark-bullet">
<li><code class="code">mode</code> enables the specified major mode.

</li><li><code class="code">eval</code> evaluates the specified Lisp expression (the value
returned by that expression is ignored).

</li><li><code class="code">coding</code> specifies the coding system for character code
conversion of this file.  See <a class="xref" href="Coding-Systems.html">Coding Systems</a>.

</li><li><code class="code">unibyte</code> says to load or compile a file of Emacs Lisp in unibyte
mode, if the value is <code class="code">t</code>.  See <a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Disabling-Multibyte.html#Disabling-Multibyte">Disabling Multibyte Characters</a> in <cite class="cite">GNU Emacs Lisp Reference
Manual</cite>.

</li></ul>

<p>These four keywords are not really variables; setting them in any
other context has no special meaning.
</p>
<a class="index-entry-id" id="index-fallback-modes"></a>
<p>If you&rsquo;re editing a file across Emacs versions, and a new mode has
been introduced to handle a file in a newer Emacs version, you can use
several <code class="code">mode</code> entries to use the new mode (called
<code class="code">my-new-mode</code>) in the new Emacs, and fall back to the old mode
(called <code class="code">my-old-mode</code>) in older Emacs versions.  If you&rsquo;re
enabling the modes in the first line of the file, can say:
</p>
<div class="example">
<pre class="example-preformatted">-*- mode: my-old; mode: my-new -*-
</pre></div>

<p>Emacs will use the final defined mode it finds, so in older Emacs
versions it will ignore <code class="code">my-new-mode</code>, while in Emacs versions
where <code class="code">my-new-mode</code> is defined, it&rsquo;ll ignore <code class="code">my-old-mode</code>.
Similarly, in a local variable block at the end of the file:
</p>
<div class="example">
<pre class="example-preformatted">Local variables:
mode: my-old
mode: my-new
</pre></div>

<p>Do not use the <code class="code">mode</code> keyword for minor modes.  To enable or
disable a minor mode in a local variables list, use the <code class="code">eval</code>
keyword with a Lisp expression that runs the mode command
(see <a class="pxref" href="Minor-Modes.html">Minor Modes</a>).  For example, the following local variables
list enables ElDoc mode (see <a class="pxref" href="Programming-Language-Doc.html">Programming Language Documentation Lookup</a>) by calling
<code class="code">eldoc-mode</code> with no argument (calling it with an argument of 1
would do the same), and disables Font Lock mode (see <a class="pxref" href="Font-Lock.html">Font Lock mode</a>) by
calling <code class="code">font-lock-mode</code> with an argument of &minus;1.
</p>
<div class="example">
<pre class="example-preformatted">;; Local Variables:
;; eval: (eldoc-mode)
;; eval: (font-lock-mode -1)
;; End:
</pre></div>

<p>Note, however, that it is often a mistake to specify minor modes this
way.  Minor modes represent individual user preferences, and it may be
inappropriate to impose your preferences on another user who might
edit the file.  If you wish to automatically enable or disable a minor
mode in a situation-dependent way, it is often better to do it in a
major mode hook (see <a class="pxref" href="Hooks.html">Hooks</a>).
</p>
<p>Use the command <kbd class="kbd">M-x normal-mode</kbd> to reset the local variables
and major mode of a buffer according to the file name and contents,
including the local variables list if any.  See <a class="xref" href="Choosing-Modes.html">Choosing File Modes</a>.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Safe-File-Variables.html">Safety of File Variables</a>, Up: <a href="File-Variables.html">Local Variables in Files</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
