<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Windows Startup (GNU Emacs Manual)</title>

<meta name="description" content="Windows Startup (GNU Emacs Manual)">
<meta name="keywords" content="Windows Startup (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Microsoft-Windows.html" rel="up" title="Microsoft Windows">
<link href="Text-and-Binary.html" rel="next" title="Text and Binary">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="Windows-Startup">
<div class="nav-panel">
<p>
Next: <a href="Text-and-Binary.html" accesskey="n" rel="next">Text Files and Binary Files</a>, Up: <a href="Microsoft-Windows.html" accesskey="u" rel="up">Emacs and Microsoft Windows/MS-DOS</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="How-to-Start-Emacs-on-MS_002dWindows"><span>I.1 How to Start Emacs on MS-Windows<a class="copiable-link" href="#How-to-Start-Emacs-on-MS_002dWindows"> &para;</a></span></h3>
<a class="index-entry-id" id="index-starting-Emacs-on-MS_002dWindows"></a>

<p>There are several ways of starting Emacs on MS-Windows:
</p>
<ol class="enumerate">
<li> <a class="index-entry-id" id="index-runemacs_002eexe"></a>
<a class="index-entry-id" id="index-desktop-shortcut_002c-MS_002dWindows"></a>
<a class="index-entry-id" id="index-start-directory_002c-MS_002dWindows"></a>
<a class="index-entry-id" id="index-directory-where-Emacs-starts-on-MS_002dWindows"></a>
From the desktop shortcut icon: either double-click the left mouse
button on the icon, or click once, then press <kbd class="key">RET</kbd>.  The desktop
shortcut should specify as its &ldquo;Target&rdquo; (in the &ldquo;Properties&rdquo; of
the shortcut) the full absolute file name of <samp class="file">runemacs.exe</samp>,
<em class="emph">not</em> of <samp class="file">emacs.exe</samp>.  This is because <samp class="file">runemacs.exe</samp>
hides the console window that would have been created if the target of
the shortcut were <samp class="file">emacs.exe</samp> (which is a console program, as far
as Windows is concerned).  If you use this method, Emacs starts in the
directory specified by the shortcut.  To control where that is,
right-click on the shortcut, select &ldquo;Properties&rdquo;, and in the
&ldquo;Shortcut&rdquo; tab modify the &ldquo;Start in&rdquo; field to your liking.

</li><li> <a class="index-entry-id" id="index-pinning-Emacs-to-Windows-task-bar"></a>
From a task-bar shortcut icon, by clicking once the left mouse button.
Windows versions since Vista allow you to create such shortcuts by
<em class="dfn">pinning</em> the icon of a running program that appears in the task
bar.  You can do that with Emacs, but afterwards you will have to
change the properties of the pinned shortcut to run
<samp class="file">runemacs.exe</samp>, <em class="emph">not</em> of <samp class="file">emacs.exe</samp>.  You can also pin
Emacs to the task bar by clicking the right mouse button on its icon
in the Start menu, then selecting &lsquo;<samp class="samp">Pin to taskbar</samp>&rsquo;.  Once again,
be sure to specify <samp class="file">runemacs.exe</samp> as the program to run.  You can
control where Emacs starts by setting the &ldquo;Start in&rdquo; field of the
shortcut&rsquo;s Properties.

</li><li> From the Command Prompt window, by typing <kbd class="kbd">emacs <kbd class="key">RET</kbd></kbd> at the
prompt.  The Command Prompt window where you did that will not be
available for invoking other commands until Emacs exits.  In this
case, Emacs will start in the current directory of the Windows shell.

</li><li> From the Command Prompt window, by typing <kbd class="kbd">runemacs <kbd class="key">RET</kbd></kbd> at
the prompt.  The Command Prompt window where you did that will be
immediately available for invoking other commands.  In this case,
Emacs will start in the current directory of the Windows shell.

</li><li> From the Windows <code class="code">Run</code> dialog (normally reached by clicking the
<code class="code">Start</code> button).  Typing <kbd class="kbd">runemacs <kbd class="key">RET</kbd></kbd> into the dialog
will start Emacs in the parent directory of the Windows equivalent of
your user&rsquo;s <code class="code">HOME</code> directory, see <a class="ref" href="Windows-HOME.html">HOME and Startup Directories on MS-Windows</a>.

</li><li> <a class="index-entry-id" id="index-invoking-Emacs-from-Windows-Explorer"></a>
<a class="index-entry-id" id="index-emacsclient_002eexe"></a>
<a class="index-entry-id" id="index-emacsclientw_002eexe"></a>
Via <samp class="file">emacsclient.exe</samp> or <samp class="file">emacsclientw.exe</samp>, which allow you
to invoke Emacs from other programs, and to reuse a running Emacs
process for serving editing jobs required by other programs.
See <a class="xref" href="Emacs-Server.html">Using Emacs as a Server</a>.  The difference between <samp class="file">emacsclient.exe</samp>
and <samp class="file">emacsclientw.exe</samp> is that the former is a console program,
while the latter is a Windows GUI program.  Both programs wait for
Emacs to signal that the editing job is finished, before they exit and
return control to the program that invoked them.  Which one of them to
use in each case depends on the expectations of the program that needs
editing services.  If that program is itself a console (text-mode)
program, you should use <samp class="file">emacsclient.exe</samp>, so that any of its
messages and prompts appear in the same command window as those of the
invoking program.  By contrast, if the invoking program is a GUI
program, you will be better off using <samp class="file">emacsclientw.exe</samp>, because
<samp class="file">emacsclient.exe</samp> will pop up a command window if it is invoked
from a GUI program.  A notable situation where you would want
<samp class="file">emacsclientw.exe</samp> is when you right-click on a file in the
Windows Explorer and select &ldquo;Open With&rdquo; from the pop-up menu.  Use
the &lsquo;<samp class="samp">--alternate-editor=</samp>&rsquo; or &lsquo;<samp class="samp">-a</samp>&rsquo; options if Emacs might not
be running (or not running as a server) when <code class="command">emacsclient</code> is
invoked&mdash;that will always give you an editor.  When invoked via
<code class="command">emacsclient</code>, Emacs will start in the current directory of
the program that invoked <code class="command">emacsclient</code>.
</li></ol>

<a class="index-entry-id" id="index-emacsclient_002c-on-MS_002dWindows"></a>
<p>Note that, due to limitations of MS-Windows, Emacs cannot have both
GUI and text-mode frames in the same session.  It also cannot open
text-mode frames on more than a single <em class="dfn">Command Prompt</em> window,
because each Windows program can have only one console at any given
time.  For these reasons, if you invoke <code class="command">emacsclient</code> with the
<samp class="option">-c</samp> option, and the Emacs server runs in a text-mode session,
Emacs will always create a new text-mode frame in the same
<em class="dfn">Command Prompt</em> window where it was started; a GUI frame will be
created only if the server runs in a GUI session.  Similarly, if you
invoke <code class="command">emacsclient</code> with the <samp class="option">-t</samp> option, Emacs will
create a GUI frame if the server runs in a GUI session, or a text-mode
frame when the session runs in text mode in a <em class="dfn">Command Prompt</em>
window.  See <a class="xref" href="emacsclient-Options.html"><code class="code">emacsclient</code> Options</a>.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Text-and-Binary.html">Text Files and Binary Files</a>, Up: <a href="Microsoft-Windows.html">Emacs and Microsoft Windows/MS-DOS</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
