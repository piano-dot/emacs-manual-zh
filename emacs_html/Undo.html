<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Undo (GNU Emacs Manual)</title>

<meta name="description" content="Undo (GNU Emacs Manual)">
<meta name="keywords" content="Undo (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Fixit.html" rel="up" title="Fixit">
<link href="Transpose.html" rel="next" title="Transpose">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="Undo">
<div class="nav-panel">
<p>
Next: <a href="Transpose.html" accesskey="n" rel="next">Transposing Text</a>, Up: <a href="Fixit.html" accesskey="u" rel="up">Commands for Fixing Typos</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Undo-1"><span>17.1 Undo<a class="copiable-link" href="#Undo-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-undo"></a>
<a class="index-entry-id" id="index-changes_002c-undoing"></a>

<p>The <em class="dfn">undo</em> command reverses recent changes in the buffer&rsquo;s text.
Each buffer records changes individually, and the undo command always
applies to the current buffer.  You can undo all the changes in a
buffer for as far back as the buffer&rsquo;s records go.  Usually, each editing
command makes a separate entry in the undo records, but some commands
such as <code class="code">query-replace</code> divide their changes into multiple
entries for flexibility in undoing.  Consecutive character insertion
commands are usually grouped together into a single undo record, to
make undoing less tedious.
</p>
<dl class="table">
<dt><kbd class="kbd">C-/</kbd></dt>
<dt><kbd class="kbd">C-x u</kbd></dt>
<dt><kbd class="kbd">C-_</kbd></dt>
<dd><p>Undo one entry in the current buffer&rsquo;s undo records (<code class="code">undo</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-C_002dx-u"></a>
<a class="index-entry-id" id="index-C_002d_005f"></a>
<a class="index-entry-id" id="index-C_002d_002f"></a>
<a class="index-entry-id" id="index-undo-1"></a>
<p>To begin to undo, type <kbd class="kbd">C-/</kbd> (or its aliases, <kbd class="kbd">C-_</kbd> or
<kbd class="kbd">C-x u</kbd>)<a class="footnote" id="DOCF5" href="#FOOT5"><sup>5</sup></a>.  This undoes the most recent change in the buffer,
and moves point back to where it was before that change.
  Consecutive repetitions of <kbd class="kbd">C-/</kbd> (or its aliases) undo earlier
and earlier changes in the current buffer.  If all the recorded
changes have already been undone, the undo command signals an error.
</p>
<a class="index-entry-id" id="index-redo"></a>
<a class="index-entry-id" id="index-undo_002donly"></a>
<a class="index-entry-id" id="index-undo_002dredo"></a>
<p>Any command other than an undo command breaks the sequence of undo
commands.  Starting from that moment, the entire sequence of undo
commands that you have just performed are themselves placed into the
undo record.  Therefore, to re-apply changes you have undone, type
<kbd class="kbd">C-f</kbd> or any other command that harmlessly breaks the sequence of
undoing; then type <kbd class="kbd">C-/</kbd> one or more times to undo some of the
undo commands.
</p>
<p>Alternatively, if you want to resume undoing, without redoing
previous undo commands, use <kbd class="kbd">M-x undo-only</kbd>.  This is like
<code class="code">undo</code>, but will not redo changes you have just undone.  To
complement it, <kbd class="kbd">M-x undo-redo</kbd> will undo previous undo commands
(and will not record itself as an undoable command).
</p>
<p>If you notice that a buffer has been modified accidentally, the
easiest way to recover is to type <kbd class="kbd">C-/</kbd> repeatedly until the stars
disappear from the front of the mode line (see <a class="pxref" href="Mode-Line.html">The Mode Line</a>).
Whenever an undo command makes the stars disappear from the mode line,
it means that the buffer contents are the same as they were when the
file was last read in or saved.  If you do not remember whether you
changed the buffer deliberately, type <kbd class="kbd">C-/</kbd> once.  When you see
the last change you made undone, you will see whether it was an
intentional change.  If it was an accident, leave it undone.  If it
was deliberate, redo the change as described above.
</p>
<p>Alternatively, you can discard all the changes since the buffer was
last visited or saved with <kbd class="kbd">M-x revert-buffer</kbd>
(see <a class="pxref" href="Reverting.html">Reverting a Buffer</a>).
</p>
<a class="index-entry-id" id="index-selective-undo"></a>
<a class="index-entry-id" id="index-C_002du-C_002d_002f"></a>
<p>When there is an active region, any use of <code class="code">undo</code> performs
<em class="dfn">selective undo</em>: it undoes the most recent change within the
region, instead of the entire buffer.  However, when Transient Mark
mode is off (see <a class="pxref" href="Disabled-Transient-Mark.html">Disabling Transient Mark Mode</a>), <kbd class="kbd">C-/</kbd> always
operates on the entire buffer, ignoring the region.  In this case, you
can perform selective undo by supplying a prefix argument to the
<code class="code">undo</code> command: <kbd class="kbd">C-u C-/</kbd>.  To undo further changes in the
same region, repeat the <code class="code">undo</code> command (no prefix argument is
needed).
</p>
<p>Some specialized buffers do not make undo records.  Buffers whose
names start with spaces never do; these buffers are used internally by
Emacs to hold text that users don&rsquo;t normally look at or edit.
</p>
<a class="index-entry-id" id="index-undo_002dlimit"></a>
<a class="index-entry-id" id="index-undo_002dstrong_002dlimit"></a>
<a class="index-entry-id" id="index-undo_002douter_002dlimit"></a>
<a class="index-entry-id" id="index-undo-limit"></a>
<p>When the undo information for a buffer becomes too large, Emacs discards
the oldest records from time to time (during <em class="dfn">garbage
collection</em>).  You can specify how much undo information to keep by
setting the variables <code class="code">undo-limit</code>, <code class="code">undo-strong-limit</code>, and
<code class="code">undo-outer-limit</code>.  Their values are expressed in bytes.
</p>
<p>The variable <code class="code">undo-limit</code> sets a soft limit: Emacs keeps undo
data for enough commands to reach this size, and perhaps exceed it,
but does not keep data for any earlier commands beyond that.  Its
default value is 160000.  The variable <code class="code">undo-strong-limit</code> sets a
stricter limit: any previous command (though not the most recent one)
that pushes the size past this amount is forgotten.  The default value
of <code class="code">undo-strong-limit</code> is 240000.
</p>
<p>Regardless of the values of those variables, the most recent change
is never discarded unless it gets bigger than <code class="code">undo-outer-limit</code>
(normally 24,000,000).  At that point, Emacs discards the undo data and
warns you about it.  This is the only situation in which you cannot
undo the last command.  If this happens, you can increase the value of
<code class="code">undo-outer-limit</code> to make it even less likely to happen in the
future.  But if you didn&rsquo;t expect the command to create such large
undo data, then it is probably a bug and you should report it.
See <a class="xref" href="Bugs.html">Reporting Bugs</a>.
</p>
</div>
<div class="footnotes-segment">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT5" href="#DOCF5">(5)</a></h5>
<p>Aside from <kbd class="kbd">C-/</kbd>, the <code class="code">undo</code> command is
also bound to <kbd class="kbd">C-x u</kbd> because that is more straightforward for
beginners to remember: &lsquo;<samp class="samp">u</samp>&rsquo; stands for &ldquo;undo&rdquo;.  It is also bound
to <kbd class="kbd">C-_</kbd> because typing <kbd class="kbd">C-/</kbd> on some text terminals actually
enters <kbd class="kbd">C-_</kbd>.</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Transpose.html">Transposing Text</a>, Up: <a href="Fixit.html">Commands for Fixing Typos</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
