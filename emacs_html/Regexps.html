<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Regexps (GNU Emacs Manual)</title>

<meta name="description" content="Regexps (GNU Emacs Manual)">
<meta name="keywords" content="Regexps (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Search.html" rel="up" title="Search">
<link href="Regexp-Backslash.html" rel="next" title="Regexp Backslash">
<link href="Regexp-Search.html" rel="prev" title="Regexp Search">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span.r {font-family: initial; font-weight: normal; font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="Regexps">
<div class="nav-panel">
<p>
Next: <a href="Regexp-Backslash.html" accesskey="n" rel="next">Backslash in Regular Expressions</a>, Previous: <a href="Regexp-Search.html" accesskey="p" rel="prev">Regular Expression Search</a>, Up: <a href="Search.html" accesskey="u" rel="up">Searching and Replacement</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Syntax-of-Regular-Expressions"><span>16.6 Syntax of Regular Expressions<a class="copiable-link" href="#Syntax-of-Regular-Expressions"> &para;</a></span></h3>
<a class="index-entry-id" id="index-syntax-of-regexps"></a>
<a class="index-entry-id" id="index-regular-expression"></a>
<a class="index-entry-id" id="index-regexp"></a>

<p>This section (and this manual in general) describes regular
expression features that users typically use.  See <a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Regular-Expressions.html#Regular-Expressions">Regular
Expressions</a> in <cite class="cite">The Emacs Lisp Reference Manual</cite>, for additional
features used mainly in Lisp programs.
</p>
<p>Regular expressions have a syntax in which a few characters are
<em class="dfn">special constructs</em> and the rest are <em class="dfn">ordinary</em>.  An ordinary
character matches that same character and nothing else.  The special
characters are &lsquo;<samp class="samp">$^.*+?[\</samp>&rsquo;.  The character &lsquo;<samp class="samp">]</samp>&rsquo; is special if
it ends a character alternative (see below).  The character &lsquo;<samp class="samp">-</samp>&rsquo;
is special inside a character alternative.  Any other character
appearing in a regular expression is ordinary, unless a &lsquo;<samp class="samp">\</samp>&rsquo;
precedes it.  (When you use regular expressions in a Lisp program,
each &lsquo;<samp class="samp">\</samp>&rsquo; must be doubled, see the example near the end of this
section.)
</p>
<p>For example, &lsquo;<samp class="samp">f</samp>&rsquo; is not a special character, so it is ordinary, and
therefore &lsquo;<samp class="samp">f</samp>&rsquo; is a regular expression that matches the string
&lsquo;<samp class="samp">f</samp>&rsquo; and no other string.  (It does <em class="emph">not</em> match the string
&lsquo;<samp class="samp">ff</samp>&rsquo;.)  Likewise, &lsquo;<samp class="samp">o</samp>&rsquo; is a regular expression that matches
only &lsquo;<samp class="samp">o</samp>&rsquo;.  (When case distinctions are being ignored, these regexps
also match &lsquo;<samp class="samp">F</samp>&rsquo; and &lsquo;<samp class="samp">O</samp>&rsquo;, but we consider this a generalization
of &ldquo;the same string&rdquo;, rather than an exception.)
</p>
<p>Any two regular expressions <var class="var">a</var> and <var class="var">b</var> can be concatenated.
The result is a regular expression which matches a string if <var class="var">a</var>
matches some amount of the beginning of that string and <var class="var">b</var>
matches the rest of the string.  As a trivial example, concatenating
the regular expressions &lsquo;<samp class="samp">f</samp>&rsquo; and &lsquo;<samp class="samp">o</samp>&rsquo; gives the regular
expression &lsquo;<samp class="samp">fo</samp>&rsquo;, which matches only the string &lsquo;<samp class="samp">fo</samp>&rsquo;.  To do
something less trivial, you need to use one of the special characters.
Here is a list of them.
</p>
<dl class="table">
<dt><kbd class="kbd">.</kbd> <span class="r">(Period)</span></dt>
<dd><p>is a special character that matches any single character except a
newline.  For example, the regular expressions &lsquo;<samp class="samp">a.b</samp>&rsquo; matches any
three-character string that begins with &lsquo;<samp class="samp">a</samp>&rsquo; and ends with
&lsquo;<samp class="samp">b</samp>&rsquo;.
</p>
</dd>
<dt><kbd class="kbd">*</kbd></dt>
<dd><p>is not a construct by itself; it is a postfix operator that means to
match the preceding regular expression repetitively any number of
times, as many times as possible.  Thus, &lsquo;<samp class="samp">o*</samp>&rsquo; matches any number
of &lsquo;<samp class="samp">o</samp>&rsquo;s, including no &lsquo;<samp class="samp">o</samp>&rsquo;s.
</p>
<p>&lsquo;<samp class="samp">*</samp>&rsquo; always applies to the <em class="emph">smallest</em> possible preceding
expression.  Thus, &lsquo;<samp class="samp">fo*</samp>&rsquo; has a repeating &lsquo;<samp class="samp">o</samp>&rsquo;, not a repeating
&lsquo;<samp class="samp">fo</samp>&rsquo;.  It matches &lsquo;<samp class="samp">f</samp>&rsquo;, &lsquo;<samp class="samp">fo</samp>&rsquo;, &lsquo;<samp class="samp">foo</samp>&rsquo;, and so on.
</p>
<p>The matcher processes a &lsquo;<samp class="samp">*</samp>&rsquo; construct by matching, immediately,
as many repetitions as can be found.  Then it continues with the rest
of the pattern.  If that fails, backtracking occurs, discarding some
of the matches of the &lsquo;<samp class="samp">*</samp>&rsquo;-modified construct in case that makes
it possible to match the rest of the pattern.  For example, in matching
&lsquo;<samp class="samp">ca*ar</samp>&rsquo; against the string &lsquo;<samp class="samp">caaar</samp>&rsquo;, the &lsquo;<samp class="samp">a*</samp>&rsquo; first
tries to match all three &lsquo;<samp class="samp">a</samp>&rsquo;s; but the rest of the pattern is
&lsquo;<samp class="samp">ar</samp>&rsquo; and there is only &lsquo;<samp class="samp">r</samp>&rsquo; left to match, so this try fails.
The next alternative is for &lsquo;<samp class="samp">a*</samp>&rsquo; to match only two &lsquo;<samp class="samp">a</samp>&rsquo;s.
With this choice, the rest of the regexp matches successfully.
</p>
</dd>
<dt><kbd class="kbd">+</kbd></dt>
<dd><p>is a postfix operator, similar to &lsquo;<samp class="samp">*</samp>&rsquo; except that it must match
the preceding expression at least once.  Thus, &lsquo;<samp class="samp">ca+r</samp>&rsquo; matches the
strings &lsquo;<samp class="samp">car</samp>&rsquo; and &lsquo;<samp class="samp">caaaar</samp>&rsquo; but not the string &lsquo;<samp class="samp">cr</samp>&rsquo;,
whereas &lsquo;<samp class="samp">ca*r</samp>&rsquo; matches all three strings.
</p>
</dd>
<dt><kbd class="kbd">?</kbd></dt>
<dd><p>is a postfix operator, similar to &lsquo;<samp class="samp">*</samp>&rsquo; except that it can match
the preceding expression either once or not at all.  Thus, &lsquo;<samp class="samp">ca?r</samp>&rsquo;
matches &lsquo;<samp class="samp">car</samp>&rsquo; or &lsquo;<samp class="samp">cr</samp>&rsquo;, and nothing else.
</p>
</dd>
<dt><a id="index-non_002dgreedy-regexp-matching"></a><span><kbd class="kbd">*?</kbd>, <kbd class="kbd">+?</kbd>, <kbd class="kbd">??</kbd><a class="copiable-link" href="#index-non_002dgreedy-regexp-matching"> &para;</a></span></dt>
<dd><p>are non-<em class="dfn">greedy</em> variants of the operators above.  The normal
operators &lsquo;<samp class="samp">*</samp>&rsquo;, &lsquo;<samp class="samp">+</samp>&rsquo;, &lsquo;<samp class="samp">?</samp>&rsquo; match as much as they can, as
long as the overall regexp can still match.  With a following
&lsquo;<samp class="samp">?</samp>&rsquo;, they will match as little as possible.
</p>
<p>Thus, both &lsquo;<samp class="samp">ab*</samp>&rsquo; and &lsquo;<samp class="samp">ab*?</samp>&rsquo; can match the string &lsquo;<samp class="samp">a</samp>&rsquo;
and the string &lsquo;<samp class="samp">abbbb</samp>&rsquo;; but if you try to match them both against
the text &lsquo;<samp class="samp">abbb</samp>&rsquo;, &lsquo;<samp class="samp">ab*</samp>&rsquo; will match it all (the longest valid
match), while &lsquo;<samp class="samp">ab*?</samp>&rsquo;  will match just &lsquo;<samp class="samp">a</samp>&rsquo; (the shortest
valid match).
</p>
<p>Non-greedy operators match the shortest possible string starting at a
given starting point; in a forward search, though, the earliest
possible starting point for match is always the one chosen.  Thus, if
you search for &lsquo;<samp class="samp">a.*?$</samp>&rsquo; against the text &lsquo;<samp class="samp">abbab</samp>&rsquo; followed by
a newline, it matches the whole string.  Since it <em class="emph">can</em> match
starting at the first &lsquo;<samp class="samp">a</samp>&rsquo;, it does.
</p>
</dd>
<dt><a class="index-entry-id" id="index-character-set_002c-in-regular-expressions"></a>
<a id="index-set-of-alternative-characters_002c-in-regular-expressions"></a><span><kbd class="kbd">[ &hellip; ]</kbd><a class="copiable-link" href="#index-set-of-alternative-characters_002c-in-regular-expressions"> &para;</a></span></dt>
<dd><p>is a <em class="dfn">set of alternative characters</em>, or a <em class="dfn">character set</em>,
beginning with &lsquo;<samp class="samp">[</samp>&rsquo; and terminated by &lsquo;<samp class="samp">]</samp>&rsquo;.
</p>
<p>In the simplest case, the characters between the two brackets are what
this set can match.  Thus, &lsquo;<samp class="samp">[ad]</samp>&rsquo; matches either one &lsquo;<samp class="samp">a</samp>&rsquo; or
one &lsquo;<samp class="samp">d</samp>&rsquo;, and &lsquo;<samp class="samp">[ad]*</samp>&rsquo; matches any string composed of just
&lsquo;<samp class="samp">a</samp>&rsquo;s and &lsquo;<samp class="samp">d</samp>&rsquo;s (including the empty string).  It follows that
&lsquo;<samp class="samp">c[ad]*r</samp>&rsquo; matches &lsquo;<samp class="samp">cr</samp>&rsquo;, &lsquo;<samp class="samp">car</samp>&rsquo;, &lsquo;<samp class="samp">cdr</samp>&rsquo;,
&lsquo;<samp class="samp">caddaar</samp>&rsquo;, etc.
</p>
<p>You can also include character ranges in a character set, by writing the
starting and ending characters with a &lsquo;<samp class="samp">-</samp>&rsquo; between them.  Thus,
&lsquo;<samp class="samp">[a-z]</samp>&rsquo; matches any lower-case <abbr class="acronym">ASCII</abbr> letter.  Ranges may be
intermixed freely with individual characters, as in &lsquo;<samp class="samp">[a-z$%.]</samp>&rsquo;,
which matches any lower-case <abbr class="acronym">ASCII</abbr> letter or &lsquo;<samp class="samp">$</samp>&rsquo;, &lsquo;<samp class="samp">%</samp>&rsquo; or
period.  As another example, &lsquo;<samp class="samp">[α-ωί]</samp>&rsquo; matches all lower-case
Greek letters.
</p>
<a class="index-entry-id" id="index-character-classes_002c-in-regular-expressions"></a>
<p>You can also include certain special <em class="dfn">character classes</em> in a
character set.  A &lsquo;<samp class="samp">[:</samp>&rsquo; and balancing &lsquo;<samp class="samp">:]</samp>&rsquo; enclose a
character class inside a set of alternative characters.  For instance,
&lsquo;<samp class="samp">[[:alnum:]]</samp>&rsquo; matches any letter or digit.  See <a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Char-Classes.html#Char-Classes">Char Classes</a> in <cite class="cite">The Emacs Lisp Reference Manual</cite>, for a list of character
classes.
</p>
<p>To include a &lsquo;<samp class="samp">]</samp>&rsquo; in a character set, you must make it the first character.
For example, &lsquo;<samp class="samp">[]a]</samp>&rsquo; matches &lsquo;<samp class="samp">]</samp>&rsquo; or &lsquo;<samp class="samp">a</samp>&rsquo;.  To include a &lsquo;<samp class="samp">-</samp>&rsquo;,
write &lsquo;<samp class="samp">-</samp>&rsquo; as the last character of the set, tho you can also put it first
or after a range.  Thus, &lsquo;<samp class="samp">[]-]</samp>&rsquo; matches both &lsquo;<samp class="samp">]</samp>&rsquo; and &lsquo;<samp class="samp">-</samp>&rsquo;.
</p>
<p>To include &lsquo;<samp class="samp">^</samp>&rsquo; in a set, put it anywhere but at the beginning of
the set.  (At the beginning, it complements the set&mdash;see below.)
</p>
<p>When you use a range in case-insensitive search, you should write both
ends of the range in upper case, or both in lower case, or both should
be non-letters.  The behavior of a mixed-case range such as &lsquo;<samp class="samp">A-z</samp>&rsquo;
is somewhat ill-defined, and it may change in future Emacs versions.
</p>
</dd>
<dt><kbd class="kbd">[^ &hellip; ]</kbd></dt>
<dd><p>&lsquo;<samp class="samp">[^</samp>&rsquo; begins a <em class="dfn">complemented character set</em>, which matches any
character except the ones specified.  Thus, &lsquo;<samp class="samp">[^a-z0-9A-Z]</samp>&rsquo; matches
all characters <em class="emph">except</em> <abbr class="acronym">ASCII</abbr> letters and digits.
</p>
<p>&lsquo;<samp class="samp">^</samp>&rsquo; is not special in a character set unless it is the first
character.  The character following the &lsquo;<samp class="samp">^</samp>&rsquo; is treated as if it
were first (in other words, &lsquo;<samp class="samp">-</samp>&rsquo; and &lsquo;<samp class="samp">]</samp>&rsquo; are not special there).
</p>
<p>A complemented character set can match a newline, unless newline is
mentioned as one of the characters not to match.  This is in contrast to
the handling of regexps in programs such as <code class="code">grep</code>.
</p>
</dd>
<dt><kbd class="kbd">^</kbd></dt>
<dd><p>is a special character that matches the empty string, but only at the
beginning of a line in the text being matched.  Otherwise it fails to
match anything.  Thus, &lsquo;<samp class="samp">^foo</samp>&rsquo; matches a &lsquo;<samp class="samp">foo</samp>&rsquo; that occurs at
the beginning of a line.
</p>
<p>For historical compatibility reasons, &lsquo;<samp class="samp">^</samp>&rsquo; can be used with this
meaning only at the beginning of the regular expression, or after
&lsquo;<samp class="samp">\(</samp>&rsquo; or &lsquo;<samp class="samp">\|</samp>&rsquo;.
</p>
</dd>
<dt><kbd class="kbd">$</kbd></dt>
<dd><p>is similar to &lsquo;<samp class="samp">^</samp>&rsquo; but matches only at the end of a line.  Thus,
&lsquo;<samp class="samp">x+$</samp>&rsquo; matches a string of one &lsquo;<samp class="samp">x</samp>&rsquo; or more at the end of a line.
</p>
<p>For historical compatibility reasons, &lsquo;<samp class="samp">$</samp>&rsquo; can be used with this
meaning only at the end of the regular expression, or before &lsquo;<samp class="samp">\)</samp>&rsquo;
or &lsquo;<samp class="samp">\|</samp>&rsquo;.
</p>
</dd>
<dt><kbd class="kbd">\</kbd></dt>
<dd><p>has two functions: it quotes the special characters (including
&lsquo;<samp class="samp">\</samp>&rsquo;), and it introduces additional special constructs.
</p>
<p>Because &lsquo;<samp class="samp">\</samp>&rsquo; quotes special characters, &lsquo;<samp class="samp">\$</samp>&rsquo; is a regular
expression that matches only &lsquo;<samp class="samp">$</samp>&rsquo;, and &lsquo;<samp class="samp">\[</samp>&rsquo; is a regular
expression that matches only &lsquo;<samp class="samp">[</samp>&rsquo;, and so on.
</p>
<p>See the following section for the special constructs that begin
with &lsquo;<samp class="samp">\</samp>&rsquo;.
</p></dd>
</dl>

<p>Note: for historical compatibility, special characters are treated as
ordinary ones if they are in contexts where their special meanings make no
sense.  For example, &lsquo;<samp class="samp">*foo</samp>&rsquo; treats &lsquo;<samp class="samp">*</samp>&rsquo; as ordinary since there is
no preceding expression on which the &lsquo;<samp class="samp">*</samp>&rsquo; can act.  It is poor practice
to depend on this behavior; it is better to quote the special character anyway,
regardless of where it appears.
</p>
<p>As a &lsquo;<samp class="samp">\</samp>&rsquo; is not special inside a set of alternative characters, it can
never remove the special meaning of &lsquo;<samp class="samp">-</samp>&rsquo;, &lsquo;<samp class="samp">^</samp>&rsquo; or &lsquo;<samp class="samp">]</samp>&rsquo;.
You should not quote these characters when they have no special
meaning.  This would not clarify anything, since backslashes
can legitimately precede these characters where they <em class="emph">have</em>
special meaning, as in &lsquo;<samp class="samp">[^\]</samp>&rsquo; (<code class="code">&quot;[^\\]&quot;</code> for Lisp string
syntax), which matches any single character except a backslash.
</p>
</div>
<hr>
<div class="nav-panel">
<p>
Next: <a href="Regexp-Backslash.html">Backslash in Regular Expressions</a>, Previous: <a href="Regexp-Search.html">Regular Expression Search</a>, Up: <a href="Search.html">Searching and Replacement</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
