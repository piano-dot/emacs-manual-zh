<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>Bug Reference (GNU Emacs Manual)</title>

<meta name="description" content="Bug Reference (GNU Emacs Manual)">
<meta name="keywords" content="Bug Reference (GNU Emacs Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Maintaining.html" rel="up" title="Maintaining">
<link href="Emerge.html" rel="prev" title="Emerge">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
ul.mark-bullet {list-style-type: disc}
-->
</style>


</head>

<body lang="zh_CN">
<div class="section-level-extent" id="Bug-Reference">
<div class="nav-panel">
<p>
Previous: <a href="Emerge.html" accesskey="p" rel="prev">Merging Files with Emerge</a>, Up: <a href="Maintaining.html" accesskey="u" rel="up">Maintaining Large Programs</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="Bug-Reference-1"><span>29.7 Bug Reference<a class="copiable-link" href="#Bug-Reference-1"> &para;</a></span></h3>
<a class="index-entry-id" id="index-bug-reference"></a>

<p>Most projects with a certain amount of users track bug reports in some
issue tracking software which assigns each report a unique and short
number or identifier.  Those are used to reference a given bug, e.g.,
in a source code comment above the code fixing some bug, in
documentation files, or in discussions on some mailing list or IRC
channel.
</p>
<a class="index-entry-id" id="index-bug_002dreference_002dmode"></a>
<a class="index-entry-id" id="index-bug_002dreference_002dprog_002dmode"></a>
<p>The minor modes <code class="code">bug-reference-mode</code> and
<code class="code">bug-reference-prog-mode</code> highlight such bug references and make
it possible to follow them to the corresponding bug report on the
project&rsquo;s issue tracker.  <code class="code">bug-reference-prog-mode</code> is a variant
of <code class="code">bug-reference-mode</code> which highlights bug references only
inside source code comments and strings.
</p>
<a class="index-entry-id" id="index-bug_002dreference_002dbug_002dregexp"></a>
<a class="index-entry-id" id="index-bug_002dreference_002durl_002dformat"></a>
<p>For its working, bug reference mode needs to know the syntax of bug
references (<code class="code">bug-reference-bug-regexp</code>), and the URL of the
tracker where bug reports can be looked up
(<code class="code">bug-reference-url-format</code>).  Since those are typically
different from project to project, it makes sense to specify them in
see <a class="pxref" href="Directory-Variables.html">Per-Directory Local Variables</a> or see <a class="pxref" href="File-Variables.html">Local Variables in Files</a>.
</p>
<p>For example, let&rsquo;s assume in our project, we usually write references
to bug reports as bug#1234, or Bug-1234 and that this bug&rsquo;s page on
the issue tracker is <a class="url" href="https://project.org/issues/1234">https://project.org/issues/1234</a>, then
these local variables section would do.
</p>
<div class="example smallexample">
<pre class="example-preformatted">;; Local Variables:
;; bug-reference-bug-regexp: &quot;\\([Bb]ug[#-]\\([0-9]+\\)\\)&quot;
;; bug-reference-url-format: &quot;https://project.org/issues/%s&quot;
;; End:
</pre></div>

<p>The string captured by the first regexp group defines the bounds of
the overlay bug-reference creates, i.e., the part which is highlighted
and made clickable.
</p>
<p>The string captured by the second regexp group in
<code class="code">bug-reference-bug-regexp</code> is used to replace the <code class="code">%s</code>
template in the <code class="code">bug-reference-url-format</code>.
</p>
<p>Note that <code class="code">bug-reference-url-format</code> may also be a function in
order to cater for more complex scenarios, e.g., when different parts
of the bug reference have to be used to distinguish between issues and
merge requests resulting in different URLs.
</p>

<h3 class="heading" id="Automatic-Setup"><span>Automatic Setup<a class="copiable-link" href="#Automatic-Setup"> &para;</a></span></h3>

<a class="index-entry-id" id="index-bug_002dreference_002dauto_002dsetup_002dfunctions"></a>
<p>If <code class="code">bug-reference-mode</code> is activated,
<code class="code">bug-reference-mode-hook</code> has been run and still
<code class="code">bug-reference-bug-regexp</code>, and <code class="code">bug-reference-url-format</code>
aren&rsquo;t both set, it&rsquo;ll try to setup suitable values for these two
variables itself by calling the functions in
<code class="code">bug-reference-auto-setup-functions</code> one after the other until
one is able to set the variables.
</p>
<a class="index-entry-id" id="index-bug_002dreference_002dsetup_002dfrom_002dvc_002dalist"></a>
<a class="index-entry-id" id="index-bug_002dreference_002dforge_002dalist"></a>
<a class="index-entry-id" id="index-bug_002dreference_002dsetup_002dfrom_002dmail_002dalist"></a>
<a class="index-entry-id" id="index-bug_002dreference_002dsetup_002dfrom_002dirc_002dalist"></a>
<p>Right now, there are three types of setup functions.
</p><ol class="enumerate">
<li> Setup for version-controlled files configurable by the variables
<code class="code">bug-reference-forge-alist</code>, and
<code class="code">bug-reference-setup-from-vc-alist</code>.  The defaults are able to
setup GNU projects where <a class="url" href="https://debbugs.gnu.org">https://debbugs.gnu.org</a> is used as
issue tracker and issues are usually referenced as <code class="code">bug#13</code> (but
many different notations are considered, too), and several kinds of
modern software forges such as GitLab, Gitea, SourceHut, or GitHub.
If you deploy a self-hosted instance of such a forge, the easiest way
to tell bug-reference about it is through
<code class="code">bug-reference-forge-alist</code>.

</li><li> Setup for email guessing from mail folder/mbox names, and mail header
values configurable by the variable
<code class="code">bug-reference-setup-from-mail-alist</code>.  The built-in news- and
mailreader <a class="ref" href="Gnus.html">Email and Usenet News with Gnus</a> and <a class="ref" href="Rmail.html">Reading Mail with Rmail</a> are supported.

</li><li> Setup for IRC channels configurable by the variable
<code class="code">bug-reference-setup-from-irc-alist</code>.  The built-in IRC clients
Rcirc, See <a data-manual="rcirc" href="https://www.gnu.org/software/emacs/manual/html_node/rcirc/index.html#Top">Rcirc</a> in <cite class="cite">The Rcirc Manual</cite>, and ERC,
See <a data-manual="erc" href="https://www.gnu.org/software/emacs/manual/html_node/erc/index.html#Top">ERC</a> in <cite class="cite">The ERC Manual</cite>, are supported.
</li></ol>

<p>For almost all of those modes, it&rsquo;s enough to simply enable
<code class="code">bug-reference-mode</code>, only Rmail requires a slightly different
setup.
</p>
<div class="example smallexample">
<pre class="example-preformatted">;; Use VC-based setup if file is under version control.
(add-hook 'prog-mode-hook #'bug-reference-prog-mode)

;; Gnus (summary &amp; article buffers)
(add-hook 'gnus-mode-hook #'bug-reference-mode)

;; Rmail
(add-hook 'rmail-show-message-hook #'bug-reference-mode-force-auto-setup)

;; Rcirc
(add-hook 'rcirc-mode-hook #'bug-reference-mode)

;; ERC
(add-hook 'erc-mode-hook #'bug-reference-mode)
</pre></div>

<p>In the Rmail case, instead of the mode hook, the
<code class="code">rmail-show-message-hook</code> has to be used in combination with the
function <code class="code">bug-reference-mode-force-auto-setup</code> which activates
<code class="code">bug-reference-mode</code> and forces auto-setup.  The reason is that
with Rmail all messages reside in the same buffer but the setup needs
to be performed whenever another messages is displayed.
</p>

<h3 class="heading" id="Adding-support-for-third_002dparty-packages"><span>Adding support for third-party packages<a class="copiable-link" href="#Adding-support-for-third_002dparty-packages"> &para;</a></span></h3>

<a class="index-entry-id" id="index-bug_002dreference_002dauto_002dsetup_002dfunctions-1"></a>
<p>Adding support for bug-reference&rsquo; auto-setup is usually quite
straight-forward: write a setup function of zero arguments which
gathers the required information (e.g., List-Id/To/From/Cc mail header
values in the case of a MUA), and then calls one of the following
helper functions:
</p><ul class="itemize mark-bullet">
<li><code class="code">bug-reference-maybe-setup-from-vc</code> which does the setup
according to <code class="code">bug-reference-setup-from-vc-alist</code>,

</li><li><code class="code">bug-reference-maybe-setup-from-mail</code> which does the setup
according to <code class="code">bug-reference-setup-from-mail-alist</code>,

</li><li>and <code class="code">bug-reference-maybe-setup-from-irc</code> which does the setup
according to <code class="code">bug-reference-setup-from-irc-alist</code>.
</li></ul>
<p>A setup function should return non-<code class="code">nil</code> if it could setup bug-reference
mode which is the case if the last thing the function does is calling
one of the helper functions above.
</p>
<p>Finally, the setup function has to be added to
<code class="code">bug-reference-auto-setup-functions</code>.
</p>
<p>Note that these auto-setup functions should check as a first step if
they are applicable, e.g., by checking the <code class="code">major-mode</code> value.
</p>

<h3 class="heading" id="Integration-with-the-debbugs-package"><span>Integration with the debbugs package<a class="copiable-link" href="#Integration-with-the-debbugs-package"> &para;</a></span></h3>

<a class="index-entry-id" id="index-debbugs_002dbrowse_002dmode"></a>
<p>If your project&rsquo;s issues are tracked on the server
<a class="url" href="https://debbugs.gnu.org">https://debbugs.gnu.org</a>, you can browse and reply to reports
directly in Emacs using the <code class="code">debbugs</code> package, which can be
downloaded via the Package Menu (see <a class="pxref" href="Packages.html">Emacs Lisp Packages</a>).  This package adds
the minor mode <code class="code">debbugs-browse-mode</code>, which can be activated on
top of <code class="code">bug-reference-mode</code> and <code class="code">bug-reference-prog-mode</code> as
follows:
</p>
<div class="example smallexample">
<pre class="example-preformatted">(add-hook 'bug-reference-mode-hook 'debbugs-browse-mode)
(add-hook 'bug-reference-prog-mode-hook 'debbugs-browse-mode)
</pre></div>
</div>
<hr>
<div class="nav-panel">
<p>
Previous: <a href="Emerge.html">Merging Files with Emerge</a>, Up: <a href="Maintaining.html">Maintaining Large Programs</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
