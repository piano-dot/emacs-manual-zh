<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>34 Reading Mail with Rmail (GNU Emacs Manual)</title>

<meta name="description" content="34 Reading Mail with Rmail (GNU Emacs Manual)"/>
<meta name="keywords" content="34 Reading Mail with Rmail (GNU Emacs Manual)"/>
<meta name="resource-type" content="document"/>
<meta name="distribution" content="global"/>
<meta name="Generator" content="texi2any"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<link href="emacs.xhtml" rel="start" title="Emacs 编辑器"/>
<link href="Key-Index.xhtml" rel="index" title="Key (Character) Index"/>
<link href="emacs.xhtml#SEC_Contents" rel="contents" title="Table of Contents"/>
<link href="emacs.xhtml" rel="up" title="Emacs 编辑器"/>
<link href="Gnus.xhtml#Gnus" rel="next" title="35 Email and Usenet News with Gnus"/>
<link href="Sending-Mail.xhtml#Sending-Mail" rel="prev" title="33 Sending Mail"/>
<style type="text/css">
<!--
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
-->
</style>


</head>

<body lang="zh_CN">
<div class="chapter-level-extent" id="Rmail">

<h2 class="chapter" id="Reading-Mail-with-Rmail">34 Reading Mail with Rmail</h2>
<a class="index-entry-id" id="index-Rmail"></a>
<a class="index-entry-id" id="index-reading-mail"></a>
<a class="index-entry-id" id="index-rmail"></a>
<a class="index-entry-id" id="index-rmail_002dmode"></a>
<a class="index-entry-id" id="index-rmail_002dmode_002dhook"></a>

<p>Rmail is an Emacs subsystem for reading and disposing of mail that
you receive.  Rmail stores mail messages in files called Rmail files.
Reading the messages in an Rmail file is done in a special major mode,
Rmail mode, which redefines most letters to run commands for managing mail.
</p>
<p>Emacs also comes with a much more sophisticated and flexible
subsystem for reading mail, called Gnus.  Gnus is a very large
package, and is therefore described in its own manual, see <cite class="cite"><a href="https://www.gnu.org/software/emacs/manual/html_node/gnus/index.html#Top">The Gnus Newsreader</a></cite>.
</p>

<div class="section-level-extent" id="Rmail-Basics">
<h3 class="section" id="Basic-Concepts-of-Rmail">34.1 Basic Concepts of Rmail</h3>

<a class="index-entry-id" id="index-primary-Rmail-file"></a>
<a class="index-entry-id" id="index-rmail_002dfile_002dname"></a>
<p>Using Rmail in the simplest fashion, you have one Rmail file
<samp class="file">~/RMAIL</samp> in which all of your mail is saved.  It is called your
<em class="dfn">primary Rmail file</em>.  The command <kbd class="kbd">M-x rmail</kbd> reads your primary
Rmail file, merges new mail in from your inboxes, displays the first
message you haven&#8217;t read yet, and lets you begin reading.  The variable
<code class="code">rmail-file-name</code> specifies the name of the primary Rmail file.
</p>
<a class="index-entry-id" id="index-current-message-_0028Rmail_0029"></a>
<p>Rmail displays only one message in the Rmail file at a time.
The message that is shown is called the <em class="dfn">current message</em>.  Rmail
mode&#8217;s special commands can do such things as delete the current
message, copy it into another file, send a reply, or move to another
message.  You can also create multiple Rmail files (see <a class="pxref" href="Files.xhtml#Files">File Handling</a>) and
use Rmail to move messages between them (see <a class="pxref" href="#Rmail-Output">Copying Messages Out to Files</a>).
</p>
<a class="index-entry-id" id="index-message-number-_0028Rmail_0029"></a>
<p>Within the Rmail file, messages are normally arranged sequentially in
order of receipt; you can specify other ways to sort them (see <a class="pxref" href="#Rmail-Sorting">Sorting the Rmail File</a>).  Messages are identified by consecutive integers which are
their <em class="dfn">message numbers</em>.  The number of the current message is
displayed in Rmail&#8217;s mode line, followed by the total number of messages
in the file.  You can move to a message by specifying its message number
with the <kbd class="kbd">j</kbd> key (see <a class="pxref" href="#Rmail-Motion">Moving Among Messages</a>).
</p>
<a class="index-entry-id" id="index-s-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dexpunge_002dand_002dsave"></a>
<p>Following the usual conventions of Emacs, changes in an Rmail file
become permanent only when you save the file.  You can save it with
<kbd class="kbd">s</kbd> (<code class="code">rmail-expunge-and-save</code>), which also expunges deleted
messages from the file first (see <a class="pxref" href="#Rmail-Deletion">Deleting Messages</a>).  To save the
file without expunging, use <kbd class="kbd">C-x C-s</kbd>.  Rmail automatically saves
the Rmail file after merging new mail from an inbox file (see <a class="pxref" href="#Rmail-Inbox">Rmail Files and Inboxes</a>).
</p>
<a class="index-entry-id" id="index-q-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dquit"></a>
<a class="index-entry-id" id="index-b-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dbury"></a>
<p>You can exit Rmail with <kbd class="kbd">q</kbd> (<code class="code">rmail-quit</code>); this expunges
and saves the Rmail file, then buries the Rmail buffer as well as its
summary buffer, if present (see <a class="pxref" href="#Rmail-Summary">Summaries</a>).  But there is no
need to exit formally.  If you switch from Rmail to editing in
other buffers, and never switch back, you have exited.  Just make sure
to save the Rmail file eventually (like any other file you have
changed).  <kbd class="kbd">C-x s</kbd> is a suitable way to do this (see <a class="pxref" href="Files.xhtml#Save-Commands">Commands for Saving Files</a>).  The Rmail command <kbd class="kbd">b</kbd>, <code class="code">rmail-bury</code>, buries the
Rmail buffer and its summary without expunging and saving the Rmail file.
</p>
</div>
<div class="section-level-extent" id="Rmail-Scrolling">
<h3 class="section" id="Scrolling-Within-a-Message">34.2 Scrolling Within a Message</h3>

<p>When Rmail displays a message that does not fit on the screen, you
must scroll through it to read the rest.  You could do this with the
usual scrolling commands: <kbd class="kbd">C-v</kbd>, <kbd class="kbd">M-v</kbd> and <kbd class="kbd">M-&lt;</kbd>
(see <a class="pxref" href="Display.xhtml#Scrolling">Scrolling</a>), but in Rmail scrolling is so frequent that it
deserves to be easier.
</p>
<dl class="table">
<dt><kbd class="kbd"><kbd class="key">SPC</kbd></kbd></dt>
<dd><p>Scroll forward (<code class="code">scroll-up-command</code>).
</p></dd>
<dt><kbd class="kbd"><kbd class="key">DEL</kbd></kbd></dt>
<dt><kbd class="kbd">S-<kbd class="key">SPC</kbd></kbd></dt>
<dd><p>Scroll backward (<code class="code">scroll-down-command</code>).
</p></dd>
<dt><kbd class="kbd">.</kbd></dt>
<dd><p>Scroll to start of message (<code class="code">rmail-beginning-of-message</code>).
</p></dd>
<dt><kbd class="kbd">/</kbd></dt>
<dd><p>Scroll to end of message (<code class="code">rmail-end-of-message</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-SPC-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-DEL-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-S_002dSPC-_0028Rmail_0029"></a>
<p>Since the most common thing to do while reading a message is to
scroll through it by screenfuls, Rmail makes <kbd class="key">SPC</kbd> and <kbd class="key">DEL</kbd>
(or <kbd class="kbd">S-<kbd class="key">SPC</kbd></kbd>) do the same as <kbd class="kbd">C-v</kbd> (<code class="code">scroll-up-command</code>)
and <kbd class="kbd">M-v</kbd> (<code class="code">scroll-down-command</code>) respectively.
</p>
<a class="index-entry-id" id="index-_002e-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-_002f-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dbeginning_002dof_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dend_002dof_002dmessage"></a>
<p>The command <kbd class="kbd">.</kbd> (<code class="code">rmail-beginning-of-message</code>) scrolls back to the
beginning of the selected message.  This is not quite the same as <kbd class="kbd">M-&lt;</kbd>:
for one thing, it does not set the mark; for another, it resets the buffer
boundaries of the current message if you have changed them (e.g., by
editing, see <a class="pxref" href="#Rmail-Editing">Editing Within a Message</a>).  Similarly, the command <kbd class="kbd">/</kbd>
(<code class="code">rmail-end-of-message</code>) scrolls forward to the end of the
selected message.
</p>
</div>
<div class="section-level-extent" id="Rmail-Motion">
<h3 class="section" id="Moving-Among-Messages">34.3 Moving Among Messages</h3>

<p>The most basic thing to do with a message is to read it.  The way to
do this in Rmail is to make the message current.  The usual practice is
to move sequentially through the file, since this is the order of
receipt of messages.  When you enter Rmail, you are positioned at the
first message that you have not yet made current (that is, the first one
that has the &#8216;<samp class="samp">unseen</samp>&#8217; attribute; see <a class="pxref" href="#Rmail-Attributes">Rmail Attributes</a>).  Move
forward to see the other new messages; move backward to re-examine old
messages.
</p>
<dl class="table">
<dt><kbd class="kbd">n</kbd></dt>
<dd><p>Move to the next nondeleted message, skipping any intervening deleted
messages (<code class="code">rmail-next-undeleted-message</code>).
</p></dd>
<dt><kbd class="kbd">p</kbd></dt>
<dd><p>Move to the previous nondeleted message
(<code class="code">rmail-previous-undeleted-message</code>).
</p></dd>
<dt><kbd class="kbd">M-n</kbd></dt>
<dd><p>Move to the next message, including deleted messages
(<code class="code">rmail-next-message</code>).
</p></dd>
<dt><kbd class="kbd">M-p</kbd></dt>
<dd><p>Move to the previous message, including deleted messages
(<code class="code">rmail-previous-message</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-n</kbd></dt>
<dd><p>Move to the next message with the same subject as the current one
(<code class="code">rmail-next-same-subject</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-p</kbd></dt>
<dd><p>Move to the previous message with the same subject as the current one
(<code class="code">rmail-previous-same-subject</code>).
</p></dd>
<dt><kbd class="kbd">j</kbd></dt>
<dd><p>Move to the first message.  With argument <var class="var">n</var>, move to
message number <var class="var">n</var> (<code class="code">rmail-show-message</code>).
</p></dd>
<dt><kbd class="kbd">&gt;</kbd></dt>
<dd><p>Move to the last message (<code class="code">rmail-last-message</code>).
</p></dd>
<dt><kbd class="kbd">&lt;</kbd></dt>
<dd><p>Move to the first message (<code class="code">rmail-first-message</code>).
</p></dd>
<dt><kbd class="kbd">M-s <var class="var">regexp</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the next message containing a match for <var class="var">regexp</var>
(<code class="code">rmail-search</code>).
</p></dd>
<dt><kbd class="kbd">- M-s <var class="var">regexp</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the previous message containing a match for <var class="var">regexp</var>.
(This is <kbd class="kbd">M-s</kbd> with a negative argument.)
</p></dd>
</dl>

<a class="index-entry-id" id="index-n-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-p-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-M_002dn-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-M_002dp-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dnext_002dundeleted_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dprevious_002dundeleted_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dnext_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dprevious_002dmessage"></a>
<p><kbd class="kbd">n</kbd> and <kbd class="kbd">p</kbd> are the usual way of moving among messages in
Rmail.  They move through the messages sequentially, but skip over
deleted messages, which is usually what you want to do.  Their command
definitions are named <code class="code">rmail-next-undeleted-message</code> and
<code class="code">rmail-previous-undeleted-message</code>.  If you do not want to skip
deleted messages&#8212;for example, if you want to move to a message to
undelete it&#8212;use the variants <kbd class="kbd">M-n</kbd> and <kbd class="kbd">M-p</kbd>
(<code class="code">rmail-next-message</code> and <code class="code">rmail-previous-message</code>).  A
numeric argument to any of these commands serves as a repeat
count.
</p>
<p>In Rmail, you can specify a numeric argument by typing just the
digits.  You don&#8217;t need to type <kbd class="kbd">C-u</kbd> first.  You can also specify
a negative argument by typing just <kbd class="kbd">-</kbd>.
</p>
<a class="index-entry-id" id="index-M_002ds-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsearch"></a>
<a class="index-entry-id" id="index-searching-in-Rmail"></a>
<p>The <kbd class="kbd">M-s</kbd> (<code class="code">rmail-search</code>) command is Rmail&#8217;s version of
search.  The usual incremental search command <kbd class="kbd">C-s</kbd> works in Rmail,
but it searches only within the current message.  The purpose of
<kbd class="kbd">M-s</kbd> is to search for another message.  It reads a regular
expression (see <a class="pxref" href="Search.xhtml#Regexps">Syntax of Regular Expressions</a>) nonincrementally, then searches starting at
the beginning of the following message for a match.  It then selects
that message.  If <var class="var">regexp</var> is empty, <kbd class="kbd">M-s</kbd> reuses the regexp
used the previous time.
</p>
<p>To search backward in the file for another message, give <kbd class="kbd">M-s</kbd> a
negative argument.  In Rmail you can do this with <kbd class="kbd">- M-s</kbd>.  This
begins searching from the end of the previous message.
</p>
<p>It is also possible to search for a message based on labels.
See <a class="xref" href="#Rmail-Labels">Labels</a>.
</p>
<a class="index-entry-id" id="index-C_002dc-C_002dn-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-C_002dc-C_002dp-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dnext_002dsame_002dsubject"></a>
<a class="index-entry-id" id="index-rmail_002dprevious_002dsame_002dsubject"></a>
<p>The <kbd class="kbd">C-c C-n</kbd> (<code class="code">rmail-next-same-subject</code>) command moves to
the next message with the same subject as the current one.  A prefix
argument serves as a repeat count.  With a negative argument, this
command moves backward, acting like <kbd class="kbd">C-c C-p</kbd>
(<code class="code">rmail-previous-same-subject</code>).  When comparing subjects, these
commands ignore the prefixes typically added to the subjects of
replies.  These commands are useful for reading all of the messages
pertaining to the same subject, a.k.a. <em class="dfn">thread</em>.
</p>
<a class="index-entry-id" id="index-j-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-_003e-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-_003c-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dshow_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dlast_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dfirst_002dmessage"></a>
<p>To move to a message specified by absolute message number, use <kbd class="kbd">j</kbd>
(<code class="code">rmail-show-message</code>) with the message number as argument.  With
no argument, <kbd class="kbd">j</kbd> selects the first message.  <kbd class="kbd">&lt;</kbd>
(<code class="code">rmail-first-message</code>) also selects the first message.  <kbd class="kbd">&gt;</kbd>
(<code class="code">rmail-last-message</code>) selects the last message.
</p>
</div>
<div class="section-level-extent" id="Rmail-Deletion">
<h3 class="section" id="Deleting-Messages">34.4 Deleting Messages</h3>

<a class="index-entry-id" id="index-deletion-_0028Rmail_0029"></a>
<p>When you no longer need to keep a message, you can <em class="dfn">delete</em> it.  This
flags it as ignorable, and some Rmail commands pretend it is no longer
present; but it still has its place in the Rmail file, and still has its
message number.
</p>
<a class="index-entry-id" id="index-expunging-_0028Rmail_0029"></a>
<p><em class="dfn">Expunging</em> the Rmail file actually removes the deleted messages.
The remaining messages are renumbered consecutively.
</p>
<dl class="table">
<dt><kbd class="kbd">d</kbd></dt>
<dd><p>Delete the current message, and move to the next nondeleted message
(<code class="code">rmail-delete-forward</code>).
</p></dd>
<dt><kbd class="kbd">C-d</kbd></dt>
<dd><p>Delete the current message, and move to the previous nondeleted
message (<code class="code">rmail-delete-backward</code>).
</p></dd>
<dt><kbd class="kbd">u</kbd></dt>
<dd><p>Undelete the current message, or move back to the previous deleted
message and undelete it (<code class="code">rmail-undelete-previous-message</code>).
</p></dd>
<dt><kbd class="kbd">x</kbd></dt>
<dd><p>Expunge the Rmail file (<code class="code">rmail-expunge</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-d-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-C_002dd-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002ddelete_002dforward"></a>
<a class="index-entry-id" id="index-rmail_002ddelete_002dbackward"></a>
<p>There are two Rmail commands for deleting messages.  Both delete the
current message and select another.  <kbd class="kbd">d</kbd>
(<code class="code">rmail-delete-forward</code>) moves to the following message, skipping
messages already deleted, while <kbd class="kbd">C-d</kbd> (<code class="code">rmail-delete-backward</code>)
moves to the previous nondeleted message.  If there is no nondeleted
message to move to in the specified direction, the message that was just
deleted remains current.  A numeric prefix argument serves as a repeat
count, to allow deletion of several messages in a single command.  A
negative argument reverses the meaning of <kbd class="kbd">d</kbd> and <kbd class="kbd">C-d</kbd>.
</p>
<a class="index-entry-id" id="index-rmail_002ddelete_002dmessage_002dhook"></a>
<p>Whenever Rmail deletes a message, it runs the hook
<code class="code">rmail-delete-message-hook</code>.  When the hook functions are invoked,
the message has been marked deleted, but it is still the current message
in the Rmail buffer.
</p>
<a class="index-entry-id" id="index-undeletion-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-x-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dexpunge"></a>
<a class="index-entry-id" id="index-u-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dundelete_002dprevious_002dmessage"></a>
<p>To make all the deleted messages finally vanish from the Rmail file,
type <kbd class="kbd">x</kbd> (<code class="code">rmail-expunge</code>).  Until you do this, you can still
<em class="dfn">undelete</em> the deleted messages.  The undeletion command, <kbd class="kbd">u</kbd>
(<code class="code">rmail-undelete-previous-message</code>), is designed to cancel the
effect of a <kbd class="kbd">d</kbd> command in most cases.  It undeletes the current
message if the current message is deleted.  Otherwise it moves backward
to previous messages until a deleted message is found, and undeletes
that message.  A numeric prefix argument serves as a repeat count, to
allow undeletion of several messages in a single command.
</p>
<p>You can usually undo a <kbd class="kbd">d</kbd> with a <kbd class="kbd">u</kbd> because the <kbd class="kbd">u</kbd>
moves back to and undeletes the message that the <kbd class="kbd">d</kbd> deleted.  But
this does not work when the <kbd class="kbd">d</kbd> skips a few already-deleted messages
that follow the message being deleted; then the <kbd class="kbd">u</kbd> command
undeletes the last of the messages that were skipped.  There is no clean
way to avoid this problem.  However, by repeating the <kbd class="kbd">u</kbd> command,
you can eventually get back to the message that you intend to
undelete.  You can also select a particular deleted message with
the <kbd class="kbd">M-p</kbd> command, then type <kbd class="kbd">u</kbd> to undelete it.
</p>
<p>A deleted message has the &#8216;<samp class="samp">deleted</samp>&#8217; attribute, and as a result
&#8216;<samp class="samp">deleted</samp>&#8217; appears in the mode line when the current message is
deleted.  In fact, deleting or undeleting a message is nothing more than
adding or removing this attribute.  See <a class="xref" href="#Rmail-Attributes">Rmail Attributes</a>.
</p>
</div>
<div class="section-level-extent" id="Rmail-Inbox">
<h3 class="section" id="Rmail-Files-and-Inboxes">34.5 Rmail Files and Inboxes</h3>
<a class="index-entry-id" id="index-inbox-file"></a>

<p>When you receive mail locally, the operating system places incoming
mail for you in a file that we call your <em class="dfn">inbox</em>.  When you start
up Rmail, it runs a C program called <code class="command">movemail</code> to copy the new
messages from your inbox into your primary Rmail file, which
also contains other messages saved from previous Rmail sessions.  It
is in this file that you actually read the mail with Rmail.  This
operation is called <em class="dfn">getting new mail</em>.  You can get new mail at
any time in Rmail by typing <kbd class="kbd">g</kbd>.
</p>
<a class="index-entry-id" id="index-rmail_002dprimary_002dinbox_002dlist"></a>
<a class="index-entry-id" id="index-MAIL-environment-variable"></a>
<p>The variable <code class="code">rmail-primary-inbox-list</code> contains a list of the
files that are inboxes for your primary Rmail file.  If you don&#8217;t set
this variable explicitly, Rmail uses the <code class="env">MAIL</code> environment
variable, or, as a last resort, a default inbox based on
<code class="code">rmail-spool-directory</code>.  The default inbox file depends on your
operating system; often it is <samp class="file">/var/mail/<var class="var">username</var></samp>,
<samp class="file">/var/spool/mail/<var class="var">username</var></samp>, or
<samp class="file">/usr/spool/mail/<var class="var">username</var></samp>.
</p>
<p>You can specify the inbox file(s) for any Rmail file for the current
session with the command <code class="code">set-rmail-inbox-list</code>; see <a class="ref" href="#Rmail-Files">Multiple Rmail Files</a>.
</p>
<p>There are two reasons for having separate Rmail files and inboxes.
</p>
<ol class="enumerate">
<li> The inbox file format varies between operating systems and according to
the other mail software in use.  Only one part of Rmail needs to know
about the alternatives, and it need only understand how to convert all
of them to Rmail&#8217;s own format.

</li><li> It is very cumbersome to access an inbox file without danger of losing
mail, because it is necessary to interlock with mail delivery.
Moreover, different operating systems use different interlocking
techniques.  The strategy of moving mail out of the inbox once and for
all into a separate Rmail file avoids the need for interlocking in all
the rest of Rmail, since only Rmail operates on the Rmail file.
</li></ol>

<a class="index-entry-id" id="index-mbox-files"></a>
<a class="index-entry-id" id="index-rmail_002dmbox_002dformat"></a>
<p>Rmail uses the standard &#8216;<samp class="samp">mbox</samp>&#8217; format, introduced by Unix and
GNU systems for inbox files, as its internal format of Rmail files.
(In fact, there are a few slightly different mbox formats.  The
differences are not very important, but you can set the variable
<code class="code">rmail-mbox-format</code> to tell Rmail which form your system uses.
See that variable&#8217;s documentation for more details.)
</p>
<a class="index-entry-id" id="index-rmail_002dpreserve_002dinbox"></a>
<p>When getting new mail, Rmail first copies the new mail from the
inbox file to the Rmail file; then it saves the Rmail file; then it
clears out the inbox file.  This way, a system crash may cause
duplication of mail between the inbox and the Rmail file, but cannot
lose mail.  If <code class="code">rmail-preserve-inbox</code> is non-<code class="code">nil</code>, then
Rmail does not clear out the inbox file when it gets new mail.  You
may wish to set this, for example, on a portable computer you use to
check your mail via POP while traveling, so that your mail will remain
on the server and you can save it later on your main desktop
workstation.
</p>
<p>In some cases, Rmail copies the new mail from the inbox file
indirectly.  First it runs the <code class="command">movemail</code> program to move the mail
from the inbox to an intermediate file called
<samp class="file">.newmail-<var class="var">inboxname</var></samp>, in the same directory as the Rmail
file.  Then Rmail merges the new mail from that file, saves the Rmail
file, and only then deletes the intermediate file.  If there is a crash
at the wrong time, this file continues to exist, and Rmail will use it
again the next time it gets new mail from that inbox.
</p>
<p>If Rmail is unable to convert the data in
<samp class="file">.newmail-<var class="var">inboxname</var></samp> into mbox format, it renames the file to
<samp class="file">RMAILOSE.<var class="var">n</var></samp> (<var class="var">n</var> is an integer chosen to make the name
unique) so that Rmail will not have trouble with the data again.  You
should look at the file, find whatever message confuses Rmail (probably
one that includes the control-underscore character, octal code 037), and
delete it.  Then you can use <kbd class="kbd">1 g</kbd> to get new mail from the
corrected file.
</p>
</div>
<div class="section-level-extent" id="Rmail-Files">
<h3 class="section" id="Multiple-Rmail-Files">34.6 Multiple Rmail Files</h3>

<p>Rmail operates by default on your <em class="dfn">primary Rmail file</em>, which is named
<samp class="file">~/RMAIL</samp> and receives your incoming mail from your system inbox file.
But you can also have other Rmail files and edit them with Rmail.  These
files can receive mail through their own inboxes, or you can move messages
into them with explicit Rmail commands (see <a class="pxref" href="#Rmail-Output">Copying Messages Out to Files</a>).
</p>
<dl class="table">
<dt><kbd class="kbd">i <var class="var">file</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Read <var class="var">file</var> into Emacs and run Rmail on it (<code class="code">rmail-input</code>).
</p></dd>
<dt><kbd class="kbd">g</kbd></dt>
<dd><p>Merge new mail from current Rmail file&#8217;s inboxes
(<code class="code">rmail-get-new-mail</code>).
</p></dd>
<dt><kbd class="kbd">C-u g <var class="var">file</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Merge new mail from inbox file <var class="var">file</var>.
</p></dd>
</dl>

<a class="index-entry-id" id="index-i-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dinput"></a>
<p>To run Rmail on a file other than your primary Rmail file, you can use
the <kbd class="kbd">i</kbd> (<code class="code">rmail-input</code>) command in Rmail.  This visits the file
in Rmail mode.  You can use <kbd class="kbd">M-x rmail-input</kbd> even when not in
Rmail, but it is easier to type <kbd class="kbd">C-u M-x rmail</kbd>, which does the
same thing.
</p>
<p>The file you read with <kbd class="kbd">i</kbd> should normally be a valid mbox file.
If it is not, Rmail tries to convert its text to mbox format, and
visits the converted text in the buffer.  If you save the buffer, that
converts the file.
</p>
<p>If you specify a file name that doesn&#8217;t exist, <kbd class="kbd">i</kbd> initializes a
new buffer for creating a new Rmail file.
</p>
<a class="index-entry-id" id="index-rmail_002dsecondary_002dfile_002ddirectory"></a>
<a class="index-entry-id" id="index-rmail_002dsecondary_002dfile_002dregexp"></a>
<p>You can also select an Rmail file from a menu.  In the Classify menu,
choose the Input Rmail File item; then choose the Rmail file you want.
The variables <code class="code">rmail-secondary-file-directory</code> and
<code class="code">rmail-secondary-file-regexp</code> specify which files to offer in the
menu: the first variable says which directory to find them in; the
second says which files in that directory to offer (all those that match
the regular expression).  If no files match, you cannot select this menu
item.  These variables also apply to choosing a file for output
(see <a class="pxref" href="#Rmail-Output">Copying Messages Out to Files</a>).
</p>

<a class="index-entry-id" id="index-rmail_002dinbox_002dlist"></a>
<p>The inbox files to use are specified by the variable
<code class="code">rmail-inbox-list</code>, which is buffer-local in Rmail mode.  As a
special exception, if you have specified no inbox files for your primary
Rmail file, it uses the <code class="env">MAIL</code> environment variable, or your
standard system inbox.
</p>
<a class="index-entry-id" id="index-g-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dget_002dnew_002dmail"></a>
<p>The <kbd class="kbd">g</kbd> command (<code class="code">rmail-get-new-mail</code>) merges mail into the
current Rmail file from its inboxes.  If the Rmail file has no
inboxes, <kbd class="kbd">g</kbd> does nothing.  The command <kbd class="kbd">M-x rmail</kbd> also
merges new mail into your primary Rmail file.
</p>
<a class="index-entry-id" id="index-merge-mail-from-file-_0028Rmail_0029"></a>
<p>To merge mail from a file that is not the usual inbox, give the
<kbd class="kbd">g</kbd> key a numeric argument, as in <kbd class="kbd">C-u g</kbd>.  Then it reads a file
name and merges mail from that file.  The inbox file is not deleted or
changed in any way when <kbd class="kbd">g</kbd> with an argument is used.  This is,
therefore, a general way of merging one file of messages into another.
</p>
</div>
<div class="section-level-extent" id="Rmail-Output">
<h3 class="section" id="Copying-Messages-Out-to-Files">34.7 Copying Messages Out to Files</h3>

<p>These commands copy messages from an Rmail file into another file.
</p>
<dl class="table">
<dt><kbd class="kbd">o <var class="var">file</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Append a full copy of the current message to the file <var class="var">file</var>
(<code class="code">rmail-output</code>).
</p>
</dd>
<dt><kbd class="kbd">C-o <var class="var">file</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Append a copy of the current message, as displayed, to the file
<var class="var">file</var> (<code class="code">rmail-output-as-seen</code>).
</p>
</dd>
<dt><kbd class="kbd">w <var class="var">file</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Output just the message body to the file <var class="var">file</var>, taking the default
file name from the message &#8216;<samp class="samp">Subject</samp>&#8217; header.
</p></dd>
</dl>

<a class="index-entry-id" id="index-o-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002doutput"></a>
<a class="index-entry-id" id="index-C_002do-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002doutput_002das_002dseen"></a>
<p>The commands <kbd class="kbd">o</kbd> and <kbd class="kbd">C-o</kbd> copy the current message into a
specified file, adding it at the end.  A positive prefix argument
serves as a repeat count: that many consecutive messages will be
copied to the specified file, starting with the current one and
ignoring deleted messages.
</p>
<p>The two commands differ mainly in how much to copy: <kbd class="kbd">o</kbd> copies the
full message headers, even if they are not all visible, while
<kbd class="kbd">C-o</kbd> copies exactly the headers currently displayed and no more.
See <a class="xref" href="#Rmail-Display">Display of Messages</a>.  In addition, <kbd class="kbd">o</kbd> converts the message to
Babyl format (used by Rmail in Emacs version 22 and before) if the
file is in Babyl format; <kbd class="kbd">C-o</kbd> cannot output to Babyl files at
all.
</p>
<p>If the output file is currently visited in an Emacs buffer, the
output commands append the message to that buffer.  It is up to you to
save the buffer eventually in its file.
</p>
<a class="index-entry-id" id="index-w-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002doutput_002dbody_002dto_002dfile"></a>
<p>Sometimes you may receive a message whose body holds the contents of a
file.  You can save the body to a file (excluding the message header)
with the <kbd class="kbd">w</kbd> command (<code class="code">rmail-output-body-to-file</code>).  Often
these messages contain the intended file name in the &#8216;<samp class="samp">Subject</samp>&#8217;
field, so the <kbd class="kbd">w</kbd> command uses the &#8216;<samp class="samp">Subject</samp>&#8217; field as the
default for the output file name (after replacing some characters that
cannot be portably used in file names).  However, the file name is
read using the minibuffer, so you can specify a different name if you
wish.
</p>
<p>You can also output a message to an Rmail file chosen with a menu.
In the Classify menu, choose the Output Rmail File menu item; then
choose the Rmail file you want.  This outputs the current message to
that file, like the <kbd class="kbd">o</kbd> command.  The variables
<code class="code">rmail-secondary-file-directory</code> and
<code class="code">rmail-secondary-file-regexp</code> specify which files to offer in the
menu: the first variable says which directory to find them in; the
second says which files in that directory to offer (all those that
match the regular expression).  If no files match, you cannot select
this menu item.
</p>
<p>Copying a message with <kbd class="kbd">o</kbd> or <kbd class="kbd">C-o</kbd> gives the original copy
of the message the &#8216;<samp class="samp">filed</samp>&#8217; attribute, so that &#8216;<samp class="samp">filed</samp>&#8217;
appears in the mode line when such a message is current.
</p>
<a class="index-entry-id" id="index-rmail_002ddelete_002dafter_002doutput"></a>
<p>If you like to keep just a single copy of every mail message, set
the variable <code class="code">rmail-delete-after-output</code> to <code class="code">t</code>; then the
<kbd class="kbd">o</kbd>, <kbd class="kbd">C-o</kbd> and <kbd class="kbd">w</kbd> commands delete the original message
after copying it.  (You can undelete it afterward if you wish, see
<a class="ref" href="#Rmail-Deletion">Deleting Messages</a>.)
</p>
<a class="index-entry-id" id="index-rmail_002doutput_002dreset_002ddeleted_002dflag"></a>
<p>By default, <kbd class="kbd">o</kbd> will leave the deleted status of a message it
outputs as it was on the original message; thus, a message deleted
before it was output will appear as deleted in the output file.
Setting the variable <code class="code">rmail-output-reset-deleted-flag</code> to a
non-<code class="code">nil</code> value countermands that: the copy of the message will
have its deleted status reset, so the message will appear as undeleted
in the output file.  In addition, when this variable is
non-<code class="code">nil</code>, specifying a positive argument to <kbd class="kbd">o</kbd> will not
ignore deleted messages when looking for consecutive messages to
output.
</p>
<a class="index-entry-id" id="index-rmail_002doutput_002dfile_002dalist"></a>
<p>The variable <code class="code">rmail-output-file-alist</code> lets you specify
intelligent defaults for the output file, based on the contents of the
current message.  The value should be a list whose elements have this
form:
</p>
<div class="example">
<pre class="example-preformatted">(<var class="var">regexp</var> . <var class="var">name-exp</var>)
</pre></div>

<p>If there&#8217;s a match for <var class="var">regexp</var> in the current message, then the
default file name for output is <var class="var">name-exp</var>.  If multiple elements
match the message, the first matching element decides the default file
name.  The subexpression <var class="var">name-exp</var> may be a string constant giving
the file name to use, or more generally it may be any Lisp expression
that yields a file name as a string.  <code class="code">rmail-output-file-alist</code>
applies to both <kbd class="kbd">o</kbd> and <kbd class="kbd">C-o</kbd>.
</p>
<a class="index-entry-id" id="index-rmail_002dautomatic_002dfolder_002ddirectives"></a>
<p>Rmail can automatically save messages from your primary Rmail file
(the one that <code class="code">rmail-file-name</code> specifies) to other files, based
on the value of the variable <code class="code">rmail-automatic-folder-directives</code>.
This variable is a list of elements (&#8216;<samp class="samp">directives</samp>&#8217;) that say which
messages to save where.  Each directive is a list consisting of an
output file, followed by one or more pairs of a header name and a regular
expression.  If a message has a header matching the specified regular
expression, that message is saved to the given file.  If the directive
has more than one header entry, all must match.  Rmail checks directives
when it shows a message from the file <code class="code">rmail-file-name</code>, and
applies the first that matches (if any).  If the output file is
<code class="code">nil</code>, the message is deleted, not saved.  For example, you can use
this feature to save messages from a particular address, or with a
particular subject, to a dedicated file.
</p>
</div>
<div class="section-level-extent" id="Rmail-Labels">
<h3 class="section" id="Labels">34.8 Labels</h3>
<a class="index-entry-id" id="index-label-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-attribute-_0028Rmail_0029"></a>

<p>Each message can have various <em class="dfn">labels</em> assigned to it as a means
of classification.  Each label has a name; different names are different
labels.  Any given label is either present or absent on a particular
message.  A few label names have standard meanings and are given to
messages automatically by Rmail when appropriate; these special labels
are called <em class="dfn">attributes</em>.
(See <a class="xref" href="#Rmail-Attributes">Rmail Attributes</a>.)
All other labels are assigned only by users.
</p>
<dl class="table">
<dt><kbd class="kbd">a <var class="var">label</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Assign the label <var class="var">label</var> to the current message (<code class="code">rmail-add-label</code>).
</p></dd>
<dt><kbd class="kbd">k <var class="var">label</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Remove the label <var class="var">label</var> from the current message (<code class="code">rmail-kill-label</code>).
</p></dd>
<dt><kbd class="kbd">C-M-n <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the next message that has one of the labels <var class="var">labels</var>
(<code class="code">rmail-next-labeled-message</code>).
</p></dd>
<dt><kbd class="kbd">C-M-p <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the previous message that has one of the labels <var class="var">labels</var>
(<code class="code">rmail-previous-labeled-message</code>).
</p></dd>
<dt><kbd class="kbd">l <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dt><kbd class="kbd">C-M-l <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Make a summary of all messages containing any of the labels <var class="var">labels</var>
(<code class="code">rmail-summary-by-labels</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-a-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-k-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dadd_002dlabel"></a>
<a class="index-entry-id" id="index-rmail_002dkill_002dlabel"></a>
<p>The <kbd class="kbd">a</kbd> (<code class="code">rmail-add-label</code>) and <kbd class="kbd">k</kbd>
(<code class="code">rmail-kill-label</code>) commands allow you to assign or remove any
label on the current message.  If the <var class="var">label</var> argument is empty, it
means to assign or remove the label most recently assigned or removed.
</p>
<p>Once you have given messages labels to classify them as you wish, there
are three ways to use the labels: in moving, in summaries, and in sorting.
</p>
<a class="index-entry-id" id="index-C_002dM_002dn-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-C_002dM_002dp-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dnext_002dlabeled_002dmessage"></a>
<a class="index-entry-id" id="index-rmail_002dprevious_002dlabeled_002dmessage"></a>
<p><kbd class="kbd">C-M-n <var class="var">labels</var> <kbd class="key">RET</kbd></kbd>
(<code class="code">rmail-next-labeled-message</code>) moves to the next message that has
one of the labels <var class="var">labels</var>.  The argument <var class="var">labels</var> specifies
one or more label names, separated by commas.  <kbd class="kbd">C-M-p</kbd>
(<code class="code">rmail-previous-labeled-message</code>) is similar, but moves
backwards to previous messages.  A numeric argument to either command
serves as a repeat count.
</p>
<p>The command <kbd class="kbd">C-M-l <var class="var">labels</var> <kbd class="key">RET</kbd></kbd>
(<code class="code">rmail-summary-by-labels</code>) displays a summary containing only the
messages that have at least one of a specified set of labels.  The
argument <var class="var">labels</var> is one or more label names, separated by commas.
See <a class="xref" href="#Rmail-Summary">Summaries</a>, for information on summaries.
</p>
<p>If the <var class="var">labels</var> argument to <kbd class="kbd">C-M-n</kbd>, <kbd class="kbd">C-M-p</kbd> or
<kbd class="kbd">C-M-l</kbd> is empty, it means to use the last set of labels specified
for any of these commands.
</p>
<p>See <a class="xref" href="#Rmail-Sorting">Sorting the Rmail File</a>, for information on sorting messages with labels.
</p>
</div>
<div class="section-level-extent" id="Rmail-Attributes">
<h3 class="section" id="Rmail-Attributes-1">34.9 Rmail Attributes</h3>

<p>Some labels such as &#8216;<samp class="samp">deleted</samp>&#8217; and &#8216;<samp class="samp">filed</samp>&#8217; have built-in
meanings, and Rmail assigns them to messages automatically at
appropriate times; these labels are called <em class="dfn">attributes</em>.  Here is
a list of Rmail attributes:
</p>
<dl class="table">
<dt>&#8216;<samp class="samp">unseen</samp>&#8217;</dt>
<dd><p>Means the message has never been current.  Assigned to messages when
they come from an inbox file, and removed when a message is made
current.  When you start Rmail, it initially shows the first message
that has this attribute.
</p></dd>
<dt>&#8216;<samp class="samp">deleted</samp>&#8217;</dt>
<dd><p>Means the message is deleted.  Assigned by deletion commands and
removed by undeletion commands (see <a class="pxref" href="#Rmail-Deletion">Deleting Messages</a>).
</p></dd>
<dt>&#8216;<samp class="samp">filed</samp>&#8217;</dt>
<dd><p>Means the message has been copied to some other file.  Assigned by the
<kbd class="kbd">o</kbd> and <kbd class="kbd">C-o</kbd> file output commands (see <a class="pxref" href="#Rmail-Output">Copying Messages Out to Files</a>).
</p></dd>
<dt>&#8216;<samp class="samp">answered</samp>&#8217;</dt>
<dd><p>Means you have mailed an answer to the message.  Assigned by the <kbd class="kbd">r</kbd>
command (<code class="code">rmail-reply</code>).  See <a class="xref" href="#Rmail-Reply">Sending Replies</a>.
</p></dd>
<dt>&#8216;<samp class="samp">forwarded</samp>&#8217;</dt>
<dd><p>Means you have forwarded the message.  Assigned by the <kbd class="kbd">f</kbd> command
(<code class="code">rmail-forward</code>).  See <a class="xref" href="#Rmail-Reply">Sending Replies</a>.
</p></dd>
<dt>&#8216;<samp class="samp">edited</samp>&#8217;</dt>
<dd><p>Means you have edited the text of the message within Rmail.
See <a class="xref" href="#Rmail-Editing">Editing Within a Message</a>.
</p></dd>
<dt>&#8216;<samp class="samp">resent</samp>&#8217;</dt>
<dd><p>Means you have resent the message.  Assigned by the command <kbd class="kbd">M-x
rmail-resend</kbd>.  See <a class="xref" href="#Rmail-Reply">Sending Replies</a>.
</p></dd>
<dt>&#8216;<samp class="samp">retried</samp>&#8217;</dt>
<dd><p>Means you have retried a failed outgoing message.  Assigned by the
command <kbd class="kbd">M-x rmail-retry-failure</kbd>.  See <a class="xref" href="#Rmail-Reply">Sending Replies</a>.
</p></dd>
</dl>

<p>All other labels are assigned or removed only by users, and have no
standard meaning.
</p>
</div>
<div class="section-level-extent" id="Rmail-Reply">
<h3 class="section" id="Sending-Replies">34.10 Sending Replies</h3>

<p>Rmail has several commands to send outgoing mail.  See <a class="xref" href="Sending-Mail.xhtml#Sending-Mail">Sending Mail</a>, for information on using Message mode, including certain
features meant to work with Rmail.  What this section documents are
the special commands of Rmail for entering the mail buffer used to
compose the outgoing message.  Note that the usual keys for sending
mail&#8212;<kbd class="kbd">C-x m</kbd>, <kbd class="kbd">C-x 4 m</kbd>, and <kbd class="kbd">C-x 5 m</kbd>&#8212;also work
normally in Rmail mode.
</p>
<dl class="table">
<dt><kbd class="kbd">m</kbd></dt>
<dd><p>Send a message (<code class="code">rmail-mail</code>).
</p></dd>
<dt><kbd class="kbd">c</kbd></dt>
<dd><p>Continue editing the already started outgoing message (<code class="code">rmail-continue</code>).
</p></dd>
<dt><kbd class="kbd">r</kbd></dt>
<dd><p>Send a reply to the current Rmail message (<code class="code">rmail-reply</code>).
</p></dd>
<dt><kbd class="kbd">f</kbd></dt>
<dd><p>Forward the current message to other users (<code class="code">rmail-forward</code>).
</p></dd>
<dt><kbd class="kbd">C-u f</kbd></dt>
<dd><p>Resend the current message to other users (<code class="code">rmail-resend</code>).
</p></dd>
<dt><kbd class="kbd">M-m</kbd></dt>
<dd><p>Try sending a bounced message a second time (<code class="code">rmail-retry-failure</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-r-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dreply"></a>
<a class="index-entry-id" id="index-reply-to-a-message"></a>
<p>The most common reason to send a message while in Rmail is to reply
to the message you are reading.  To do this, type <kbd class="kbd">r</kbd>
(<code class="code">rmail-reply</code>).  This displays a mail composition buffer in
another window, much like <kbd class="kbd">C-x 4 m</kbd>, but preinitializes the
&#8216;<samp class="samp">Subject</samp>&#8217;, &#8216;<samp class="samp">To</samp>&#8217;, &#8216;<samp class="samp">CC</samp>&#8217;, &#8216;<samp class="samp">In-Reply-To</samp>&#8217; and
&#8216;<samp class="samp">References</samp>&#8217; header fields based on the message you are replying
to.  The &#8216;<samp class="samp">To</samp>&#8217; field starts out as the address of the person who
sent the message you received, and the &#8216;<samp class="samp">CC</samp>&#8217; field starts out with
all the other recipients of that message.
</p>
<a class="index-entry-id" id="index-mail_002ddont_002dreply_002dto_002dnames"></a>
<p>You can exclude certain recipients from being included automatically
in replies, using the variable <code class="code">mail-dont-reply-to-names</code>.  Its
value should be a regular expression; any recipients that match are
excluded from the &#8216;<samp class="samp">CC</samp>&#8217; field.  They are also excluded from the
&#8216;<samp class="samp">To</samp>&#8217; field, unless this would leave the field empty.  If this
variable is <code class="code">nil</code>, then the first time you compose a reply it is
initialized to a default value that matches your own address.
</p>
<p>To reply only to the sender of the original message, enter
the reply command with a numeric argument: <kbd class="kbd">C-u r</kbd> or <kbd class="kbd">1 r</kbd>.
This omits the &#8216;<samp class="samp">CC</samp>&#8217; field completely for a particular reply.
</p>
<p>Once the mail composition buffer has been initialized, editing and
sending the mail goes as usual (see <a class="pxref" href="Sending-Mail.xhtml#Sending-Mail">Sending Mail</a>).  You can edit
the presupplied header fields if they are not what you want.  You can
also use commands such as <kbd class="kbd">C-c C-y</kbd>, which yanks in the message
that you are replying to (see <a class="pxref" href="Sending-Mail.xhtml#Mail-Commands">Mail Commands</a>).  You can also switch
to the Rmail buffer, select a different message there, switch back,
and yank the new current message.
</p>
<a class="index-entry-id" id="index-M_002dm-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dretry_002dfailure"></a>
<a class="index-entry-id" id="index-retrying-a-failed-message"></a>
<a class="index-entry-id" id="index-rmail_002dretry_002dignored_002dheaders"></a>
<p>Sometimes a message does not reach its destination.  Mailers usually
send the failed message back to you, enclosed in a <em class="dfn">failure
message</em>.  The Rmail command <kbd class="kbd">M-m</kbd> (<code class="code">rmail-retry-failure</code>)
prepares to send the same message a second time: it sets up a
mail composition buffer with the same text and header fields as before.  If
you type <kbd class="kbd">C-c C-c</kbd> right away, you send the message again exactly
the same as the first time.  Alternatively, you can edit the text or
headers and then send it.  The variable
<code class="code">rmail-retry-ignored-headers</code>, in the same format as
<code class="code">rmail-ignored-headers</code> (see <a class="pxref" href="#Rmail-Display">Display of Messages</a>), controls which
headers are stripped from the failed message when retrying it.
</p>
<a class="index-entry-id" id="index-f-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dforward"></a>
<a class="index-entry-id" id="index-forwarding-a-message"></a>
<p>Another frequent reason to send mail in Rmail is to <em class="dfn">forward</em> the
current message to other users.  <kbd class="kbd">f</kbd> (<code class="code">rmail-forward</code>) makes
this easy by preinitializing the mail composition buffer with the current
message as the text, and a subject of the form <code class="code">[<var class="var">from</var>:
<var class="var">subject</var>]</code>, where <var class="var">from</var> and <var class="var">subject</var> are the sender and
subject of the original message.  All you have to do is fill in the
recipients and send.  When you forward a message, recipients get a
message which is from you, and which has the original message in
its contents.
</p>
<a class="index-entry-id" id="index-rmail_002denable_002dmime_002dcomposing"></a>
<a class="index-entry-id" id="index-unforward_002drmail_002dmessage"></a>
<p>Rmail offers two formats for forwarded messages.  The default is to
use the MIME format (see <a class="pxref" href="#Rmail-Display">Display of Messages</a>).  This includes the original
message as a separate part.  You can use a simpler format if you
prefer, by setting the variable <code class="code">rmail-enable-mime-composing</code> to
<code class="code">nil</code>.  In this case, Rmail just includes the original message
enclosed between two delimiter lines.  It also modifies every line
that starts with a dash, by inserting &#8216;<samp class="samp">-&#160;</samp>&#8217;<!-- /@w --> at the start of
the line.  When you receive a forwarded message in this format, if it
contains something besides ordinary text&#8212;for example, program source
code&#8212;you might find it useful to undo that transformation.  You can
do this by selecting the forwarded message and typing <kbd class="kbd">M-x
unforward-rmail-message</kbd>.  This command extracts the original
forwarded message, deleting the inserted &#8216;<samp class="samp">-&#160;</samp>&#8217;<!-- /@w --> strings, and
inserts it into the Rmail file as a separate message immediately
following the current one.
</p>
<a class="index-entry-id" id="index-rmail_002dresend"></a>
<p><em class="dfn">Resending</em> is an alternative similar to forwarding; the
difference is that resending sends a message that is from the
original sender, just as it reached you&#8212;with a few added header fields
(&#8216;<samp class="samp">Resent-From</samp>&#8217; and &#8216;<samp class="samp">Resent-To</samp>&#8217;) to indicate that it came via
you.  To resend a message in Rmail, use <kbd class="kbd">C-u f</kbd>.  (<kbd class="kbd">f</kbd> runs
<code class="code">rmail-forward</code>, which invokes <code class="code">rmail-resend</code> if you provide a
numeric argument.)
</p>
<a class="index-entry-id" id="index-m-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dmail"></a>
<p>Use the <kbd class="kbd">m</kbd> (<code class="code">rmail-mail</code>) command to start editing an
outgoing message that is not a reply.  It leaves the header fields empty.
Its only difference from <kbd class="kbd">C-x 4 m</kbd> is that it makes the Rmail buffer
accessible for <kbd class="kbd">C-c C-y</kbd>, just as <kbd class="kbd">r</kbd> does.
</p>
<a class="index-entry-id" id="index-c-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dcontinue"></a>
<p>The <kbd class="kbd">c</kbd> (<code class="code">rmail-continue</code>) command resumes editing the
mail composition buffer, to finish editing an outgoing message you were
already composing, or to alter a message you have sent.
</p>
<a class="index-entry-id" id="index-rmail_002dmail_002dnew_002dframe"></a>
<p>If you set the variable <code class="code">rmail-mail-new-frame</code> to a
non-<code class="code">nil</code> value, then all the Rmail commands to start sending a
message create a new frame to edit it in.  This frame is deleted when
you send the message.
</p>
<p>All the Rmail commands to send a message use the mail-composition
method that you have chosen (see <a class="pxref" href="Sending-Mail.xhtml#Mail-Methods">Mail-Composition Methods</a>).
</p>
</div>
<div class="section-level-extent" id="Rmail-Summary">
<h3 class="section" id="Summaries">34.11 Summaries</h3>
<a class="index-entry-id" id="index-summary-_0028Rmail_0029"></a>

<p>A <em class="dfn">summary</em> is a buffer containing one line per message to give
you an overview of the mail in an Rmail file.  Each line shows the
message number and date, the sender, the line count, the labels, and
the subject.  Moving point in the summary buffer selects messages as
you move to their summary lines.  Almost all Rmail commands are valid
in the summary buffer also; when used there, they apply to the message
described by the current line of the summary.
</p>
<p>A summary buffer applies to a single Rmail file only; if you are
editing multiple Rmail files, each one can have its own summary buffer.
The summary buffer name is made by appending &#8216;<samp class="samp">-summary</samp>&#8217; to the
Rmail buffer&#8217;s name.  Normally only one summary buffer is displayed at a
time.
</p>

<div class="subsection-level-extent" id="Rmail-Make-Summary">
<h4 class="subsection" id="Making-Summaries">34.11.1 Making Summaries</h4>

<p>Here are the commands to create a summary for the current Rmail
buffer.  Once the Rmail buffer has a summary, changes in the Rmail
buffer (such as deleting or expunging messages, and getting new mail)
automatically update the summary.
</p>
<dl class="table">
<dt><kbd class="kbd">h</kbd></dt>
<dt><kbd class="kbd">C-M-h</kbd></dt>
<dd><p>Summarize all messages (<code class="code">rmail-summary</code>).
</p></dd>
<dt><kbd class="kbd">l <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dt><kbd class="kbd">C-M-l <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Summarize messages that have one or more of the specified labels
(<code class="code">rmail-summary-by-labels</code>).
</p></dd>
<dt><kbd class="kbd">C-M-r <var class="var">rcpts</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Summarize messages that match the specified recipients
(<code class="code">rmail-summary-by-recipients</code>).
</p></dd>
<dt><kbd class="kbd">C-M-t <var class="var">topic</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Summarize messages that have a match for the specified regexp
<var class="var">topic</var> in their subjects (<code class="code">rmail-summary-by-topic</code>).
</p></dd>
<dt><kbd class="kbd">C-M-s <var class="var">regexp</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Summarize messages whose headers match the specified regular expression
<var class="var">regexp</var> (<code class="code">rmail-summary-by-regexp</code>).
</p></dd>
<dt><kbd class="kbd">C-M-f <var class="var">senders</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Summarize messages that match the specified senders.
(<code class="code">rmail-summary-by-senders</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-h-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary"></a>
<p>The <kbd class="kbd">h</kbd> or <kbd class="kbd">C-M-h</kbd> (<code class="code">rmail-summary</code>) command fills the summary buffer
for the current Rmail buffer with a summary of all the messages in the buffer.
It then displays and selects the summary buffer in another window.
</p>
<a class="index-entry-id" id="index-l-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-C_002dM_002dl-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dby_002dlabels"></a>
<p><kbd class="kbd">C-M-l <var class="var">labels</var> <kbd class="key">RET</kbd></kbd> (<code class="code">rmail-summary-by-labels</code>) makes
a partial summary mentioning only the messages that have one or more of the
labels <var class="var">labels</var>.  <var class="var">labels</var> should contain label names separated by
commas.
</p>
<a class="index-entry-id" id="index-C_002dM_002dr-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dby_002drecipients"></a>
<p><kbd class="kbd">C-M-r <var class="var">rcpts</var> <kbd class="key">RET</kbd></kbd> (<code class="code">rmail-summary-by-recipients</code>)
makes a partial summary mentioning only the messages that have one or
more recipients matching the regular expression <var class="var">rcpts</var>.  This is matched
against the &#8216;<samp class="samp">To</samp>&#8217;, &#8216;<samp class="samp">From</samp>&#8217;, and &#8216;<samp class="samp">CC</samp>&#8217; headers (supply a prefix
argument to exclude the &#8216;<samp class="samp">CC</samp>&#8217; header).
</p>
<a class="index-entry-id" id="index-C_002dM_002dt-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dby_002dtopic"></a>
<p><kbd class="kbd">C-M-t <var class="var">topic</var> <kbd class="key">RET</kbd></kbd> (<code class="code">rmail-summary-by-topic</code>)
makes a partial summary mentioning only the messages whose subjects have
a match for the regular expression <var class="var">topic</var>.  With a prefix argument,
the match is against the whole message, not just the subject.
</p>
<a class="index-entry-id" id="index-C_002dM_002ds-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dby_002dregexp"></a>
<p><kbd class="kbd">C-M-s <var class="var">regexp</var> <kbd class="key">RET</kbd></kbd> (<code class="code">rmail-summary-by-regexp</code>)
makes a partial summary that mentions only the messages whose headers
(including the date and the subject lines) match the regular
expression <var class="var">regexp</var>.
</p>
<a class="index-entry-id" id="index-C_002dM_002df-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dby_002dsenders"></a>
<p><kbd class="kbd">C-M-f <var class="var">senders</var> <kbd class="key">RET</kbd></kbd> (<code class="code">rmail-summary-by-senders</code>)
makes a partial summary that mentions only the messages whose &#8216;<samp class="samp">From</samp>&#8217;
fields match the regular expression <var class="var">senders</var>.
</p>
<p>Note that there is only one summary buffer for any Rmail buffer;
making any kind of summary discards any previous summary.
</p>
<a class="index-entry-id" id="index-rmail_002dsummary_002dwindow_002dsize"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dline_002dcount_002dflag"></a>
<p>The variable <code class="code">rmail-summary-window-size</code> says how many lines to
use for the summary window.  The variable
<code class="code">rmail-summary-line-count-flag</code> controls whether the summary line
for a message should include the line count of the message.  Setting
this option to <code class="code">nil</code> might speed up the generation of summaries.
</p>
</div>
<div class="subsection-level-extent" id="Rmail-Summary-Edit">
<h4 class="subsection" id="Editing-in-Summaries">34.11.2 Editing in Summaries</h4>

<p>You can use the Rmail summary buffer to do almost anything you can do
in the Rmail buffer itself.  In fact, once you have a summary buffer,
there&#8217;s no need to switch back to the Rmail buffer.
</p>
<p>You can select and display various messages in the Rmail buffer, from
the summary buffer, just by moving point in the summary buffer to
different lines.  It doesn&#8217;t matter what Emacs command you use to move
point; whichever line point is on at the end of the command, that
message is selected in the Rmail buffer.
</p>
<a class="index-entry-id" id="index-rmail_002dsummary_002dscroll_002dbetween_002dmessages"></a>
<p>Almost all Rmail commands work in the summary buffer as well as in
the Rmail buffer.  Thus, <kbd class="kbd">d</kbd> in the summary buffer deletes the
current message, <kbd class="kbd">u</kbd> undeletes, and <kbd class="kbd">x</kbd> expunges.  (However,
in the summary buffer, if there are no more undeleted messages in the
relevant direction, the delete commands go to the first or last
message, rather than staying on the current message.)  <kbd class="kbd">o</kbd> and
<kbd class="kbd">C-o</kbd> output the current message to a FILE; <kbd class="kbd">r</kbd> starts a reply
to it; etc.  You can scroll the current message while remaining in the
summary buffer using <kbd class="key">SPC</kbd> and <kbd class="key">DEL</kbd>.  However, in the summary
buffer scrolling past the end or the beginning of a message with
<kbd class="key">SPC</kbd> or <kbd class="key">DEL</kbd> goes, respectively, to the next or previous
undeleted message.  Customize the
<code class="code">rmail-summary-scroll-between-messages</code> option to <code class="code">nil</code> to
disable scrolling to next/previous messages.
</p>
<a class="index-entry-id" id="index-rmail_002dsummary_002dundelete_002dmany"></a>
<p><kbd class="kbd">M-u</kbd> (<code class="code">rmail-summary-undelete-many</code>) undeletes all deleted
messages in the summary.  A prefix argument means to undelete that many
of the previous deleted messages.
</p>
<p>The Rmail commands to move between messages also work in the summary
buffer, but with a twist: they move through the set of messages included
in the summary.  They also ensure the Rmail buffer appears on the screen
(unlike cursor motion commands, which update the contents of the Rmail
buffer but don&#8217;t display it in a window unless it already appears).
Here is a list of these commands:
</p>
<dl class="table">
<dt><kbd class="kbd">n</kbd></dt>
<dd><p>Move to next line, skipping lines saying &#8220;deleted&#8221;, and select its
message (<code class="code">rmail-summary-next-msg</code>).
</p></dd>
<dt><kbd class="kbd">p</kbd></dt>
<dd><p>Move to previous line, skipping lines saying &#8220;deleted&#8221;, and select
its message (<code class="code">rmail-summary-previous-msg</code>).
</p></dd>
<dt><kbd class="kbd">M-n</kbd></dt>
<dd><p>Move to next line and select its message (<code class="code">rmail-summary-next-all</code>).
</p></dd>
<dt><kbd class="kbd">M-p</kbd></dt>
<dd><p>Move to previous line and select its message
(<code class="code">rmail-summary-previous-all</code>).
</p></dd>
<dt><kbd class="kbd">&gt;</kbd></dt>
<dd><p>Move to the last line, and select its message
(<code class="code">rmail-summary-last-message</code>).
</p></dd>
<dt><kbd class="kbd">&lt;</kbd></dt>
<dd><p>Move to the first line, and select its message
(<code class="code">rmail-summary-first-message</code>).
</p></dd>
<dt><kbd class="kbd">j</kbd></dt>
<dt><kbd class="kbd"><kbd class="key">RET</kbd></kbd></dt>
<dd><p>Select the message on the current line (ensuring that the Rmail buffer
appears on the screen; <code class="code">rmail-summary-goto-msg</code>).  With argument
<var class="var">n</var>, select message number <var class="var">n</var> and move to its line in the
summary buffer; this signals an error if the message is not listed in
the summary buffer.
</p></dd>
<dt><kbd class="kbd">M-s <var class="var">pattern</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Search through messages for <var class="var">pattern</var> starting with the current
message; select the message found, and move point in the summary buffer
to that message&#8217;s line (<code class="code">rmail-summary-search</code>).  A prefix argument
acts as a repeat count; a negative argument means search backward
(equivalent to <code class="code">rmail-summary-search-backward</code>.)
</p></dd>
<dt><kbd class="kbd">C-M-n <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the next message with at least one of the specified labels
(<code class="code">rmail-summary-next-labeled-message</code>).  <var class="var">labels</var> is a
comma-separated list of labels.  A prefix argument acts as a repeat
count.
</p></dd>
<dt><kbd class="kbd">C-M-p <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the previous message with at least one of the specified labels
(<code class="code">rmail-summary-previous-labeled-message</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-n <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the next message with the same subject as the current message
(<code class="code">rmail-summary-next-same-subject</code>).  A prefix argument acts as a
repeat count.
</p></dd>
<dt><kbd class="kbd">C-c C-p <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Move to the previous message with the same subject as the current message
(<code class="code">rmail-summary-previous-same-subject</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-rmail_002dredisplay_002dsummary"></a>
<p>Deletion, undeletion, and getting new mail, and even selection of a
different message all update the summary buffer when you do them in the
Rmail buffer.  If the variable <code class="code">rmail-redisplay-summary</code> is
non-<code class="code">nil</code>, these actions also bring the summary buffer back onto
the screen.
</p>
<a class="index-entry-id" id="index-Q-_0028Rmail-summary_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dwipe"></a>
<a class="index-entry-id" id="index-q-_0028Rmail-summary_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dquit"></a>
<a class="index-entry-id" id="index-b-_0028Rmail-summary_0029"></a>
<a class="index-entry-id" id="index-rmail_002dsummary_002dbury"></a>
<p>When you are finished using the summary, type <kbd class="kbd">Q</kbd>
(<code class="code">rmail-summary-wipe</code>) to delete the summary buffer&#8217;s window.  You
can also exit Rmail while in the summary: <kbd class="kbd">q</kbd>
(<code class="code">rmail-summary-quit</code>) deletes the summary window, then exits from
Rmail by saving the Rmail file and switching to another buffer.
Alternatively, <kbd class="kbd">b</kbd> (<code class="code">rmail-summary-bury</code>) simply buries the
Rmail summary and buffer.
</p>
</div>
</div>
<div class="section-level-extent" id="Rmail-Sorting">
<h3 class="section" id="Sorting-the-Rmail-File">34.12 Sorting the Rmail File</h3>
<a class="index-entry-id" id="index-sorting-Rmail-file"></a>
<a class="index-entry-id" id="index-Rmail-file-sorting"></a>

<dl class="table">
<dt><a id="index-rmail_002dsort_002dby_002ddate"></a><kbd class="kbd">C-c C-s C-d</kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-date</kbd></dt>
<dd><p>Sort messages of current Rmail buffer by date.
</p>
</dd>
<dt><a id="index-rmail_002dsort_002dby_002dsubject"></a><kbd class="kbd">C-c C-s C-s</kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-subject</kbd></dt>
<dd><p>Sort messages of current Rmail buffer by subject.
</p>
</dd>
<dt><a id="index-rmail_002dsort_002dby_002dauthor"></a><kbd class="kbd">C-c C-s C-a</kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-author</kbd></dt>
<dd><p>Sort messages of current Rmail buffer by author&#8217;s name.
</p>
</dd>
<dt><a id="index-rmail_002dsort_002dby_002drecipient"></a><kbd class="kbd">C-c C-s C-r</kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-recipient</kbd></dt>
<dd><p>Sort messages of current Rmail buffer by recipient&#8217;s name.
</p>
</dd>
<dt><a id="index-rmail_002dsort_002dby_002dcorrespondent"></a><kbd class="kbd">C-c C-s C-c</kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-correspondent</kbd></dt>
<dd><p>Sort messages of current Rmail buffer by the name of the other
correspondent.
</p>
</dd>
<dt><a id="index-rmail_002dsort_002dby_002dlines"></a><kbd class="kbd">C-c C-s C-l</kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-lines</kbd></dt>
<dd><p>Sort messages of current Rmail buffer by number of lines.
</p>
</dd>
<dt><a id="index-rmail_002dsort_002dby_002dlabels"></a><kbd class="kbd">C-c C-s C-k <kbd class="key">RET</kbd> <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dt><kbd class="kbd">M-x rmail-sort-by-labels <kbd class="key">RET</kbd> <var class="var">labels</var> <kbd class="key">RET</kbd></kbd></dt>
<dd><p>Sort messages of current Rmail buffer by labels.  The argument
<var class="var">labels</var> should be a comma-separated list of labels.  The order of
these labels specifies the order of messages; messages with the first
label come first, messages with the second label come second, and so on.
Messages that have none of these labels come last.
</p></dd>
</dl>

<p>The Rmail sort commands perform a <em class="emph">stable sort</em>: if there is no
reason to prefer either one of two messages, their order remains
unchanged.  You can use this to sort by more than one criterion.  For
example, if you use <code class="code">rmail-sort-by-date</code> and then
<code class="code">rmail-sort-by-author</code>, messages from the same author appear in
order by date.
</p>
<p>With a prefix argument, all these commands reverse the order of
comparison.  This means they sort messages from newest to oldest, from
biggest to smallest, or in reverse alphabetical order.
</p>
<p>The same keys in the summary buffer run similar functions; for
example, <kbd class="kbd">C-c C-s C-l</kbd> runs <code class="code">rmail-summary-sort-by-lines</code>.
These commands always sort the whole Rmail buffer, even if the summary
is only showing a subset of messages.
</p>
<p>Note that you cannot undo a sort, so you may wish to save the Rmail
buffer before sorting it.
</p>
</div>
<div class="section-level-extent" id="Rmail-Display">
<h3 class="section" id="Display-of-Messages">34.13 Display of Messages</h3>

<p>This section describes how Rmail displays mail headers,
<abbr class="acronym">MIME</abbr> sections and attachments, URLs, and encrypted messages.
</p>
<dl class="table">
<dt><kbd class="kbd">t</kbd></dt>
<dd><p>Toggle display of complete header (<code class="code">rmail-toggle-header</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-t-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dtoggle_002dheader"></a>
<p>Before displaying each message for the first time, Rmail reformats
its header, hiding uninteresting header fields to reduce clutter.  The
<kbd class="kbd">t</kbd> (<code class="code">rmail-toggle-header</code>) command toggles this, switching
between showing the reformatted header fields and showing the
complete, original header.  With a positive prefix argument, the
command shows the reformatted header; with a zero or negative prefix
argument, it shows the full header.  Selecting the message again also
reformats it if necessary.
</p>
<a class="index-entry-id" id="index-rmail_002dignored_002dheaders"></a>
<a class="index-entry-id" id="index-rmail_002ddisplayed_002dheaders"></a>
<a class="index-entry-id" id="index-rmail_002dnonignored_002dheaders"></a>
<p>The variable <code class="code">rmail-ignored-headers</code> holds a regular expression
specifying the header fields to hide; any matching header line will be
hidden.  The variable <code class="code">rmail-nonignored-headers</code> overrides this:
any header field matching that regular expression is shown even if it
matches <code class="code">rmail-ignored-headers</code> too.  The variable
<code class="code">rmail-displayed-headers</code> is an alternative to these two
variables; if non-<code class="code">nil</code>, this should be a regular expression
specifying which headers to display (the default is <code class="code">nil</code>).
</p>
<a class="index-entry-id" id="index-rmail_002dhighlighted_002dheaders"></a>
<p>Rmail highlights certain header fields that are especially
interesting&#8212;by default, the &#8216;<samp class="samp">From</samp>&#8217; and &#8216;<samp class="samp">Subject</samp>&#8217; fields.
This highlighting uses the <code class="code">rmail-highlight</code> face.  The variable
<code class="code">rmail-highlighted-headers</code> holds a regular expression specifying
the header fields to highlight; if it matches the beginning of a
header field, that whole field is highlighted.  To disable this
feature, set <code class="code">rmail-highlighted-headers</code> to <code class="code">nil</code>.
</p>
<a class="index-entry-id" id="index-MIME-messages-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002denable_002dmime"></a>
<p>If a message is in <abbr class="acronym">MIME</abbr> (Multipurpose Internet Mail
Extensions) format and contains multiple parts (<abbr class="acronym">MIME</abbr>
entities), Rmail displays each part with a <em class="dfn">tagline</em>.  The tagline
summarizes the part&#8217;s index, size, and content type.  Depending on the
content type, it may also contain one or more buttons; these perform
actions such as saving the part into a file.
</p>
<dl class="table">
<dt><a id="index-rmail_002dmime_002dtoggle_002dhidden"></a><kbd class="kbd"><kbd class="key">RET</kbd></kbd></dt>
<dd><p>Hide or show the <abbr class="acronym">MIME</abbr> part at point
(<code class="code">rmail-mime-toggle-hidden</code>).
</p>
</dd>
<dt><a id="index-rmail_002dmime_002dnext_002ditem"></a><kbd class="kbd"><kbd class="key">TAB</kbd></kbd></dt>
<dd><p>Move point to the next <abbr class="acronym">MIME</abbr> tagline button.
(<code class="code">rmail-mime-next-item</code>).
</p>
</dd>
<dt><a id="index-rmail_002dmime_002dprevious_002ditem"></a><kbd class="kbd">S-<kbd class="key">TAB</kbd></kbd></dt>
<dd><p>Move point to the previous <abbr class="acronym">MIME</abbr> part
(<code class="code">rmail-mime-previous-item</code>).
</p>
</dd>
<dt><a class="index-entry-id" id="index-rmail_002dmime"></a>
<a id="index-v-_0028Rmail_0029"></a><kbd class="kbd">v</kbd></dt>
<dd><p>Toggle between <abbr class="acronym">MIME</abbr> display and raw message
(<code class="code">rmail-mime</code>).
</p></dd>
</dl>

<p>Each plain-text <abbr class="acronym">MIME</abbr> part is initially displayed
immediately after its tagline, as part of the Rmail buffer (unless the
message has an <abbr class="acronym">HTML</abbr> part, see below), while <abbr class="acronym">MIME</abbr>
parts of other types are represented only by their taglines, with
their actual contents hidden.  In either case, you can toggle a
<abbr class="acronym">MIME</abbr> part between its displayed and hidden states by typing
<kbd class="key">RET</kbd> anywhere in the part&#8212;or anywhere in its tagline (except
for buttons for other actions, if there are any).  Type <kbd class="key">RET</kbd> (or
click with the mouse) to activate a tagline button, and <kbd class="key">TAB</kbd> to
cycle point between tagline buttons.
</p>
<p>The <kbd class="kbd">v</kbd> (<code class="code">rmail-mime</code>) command toggles between the default
<abbr class="acronym">MIME</abbr> display described above, and a raw display showing
the undecoded <abbr class="acronym">MIME</abbr> data.  With a prefix argument, this
command toggles the display of only an entity at point.
</p>
<a class="index-entry-id" id="index-rmail_002dmime_002dprefer_002dhtml"></a>
<p>If the message has an <abbr class="acronym">HTML</abbr> <abbr class="acronym">MIME</abbr> part, Rmail
displays it in preference to the plain-text part, if Emacs can render
<abbr class="acronym">HTML</abbr><a class="footnote" id="DOCF19" href="#FOOT19"><sup>19</sup></a>.  To prevent
that, and have the plain-text part displayed instead, customize the
variable <code class="code">rmail-mime-prefer-html</code> to a <code class="code">nil</code> value.
</p>
<p>To prevent Rmail from handling MIME decoded messages, change the
variable <code class="code">rmail-enable-mime</code> to <code class="code">nil</code>.  When this is the
case, the <kbd class="kbd">v</kbd> (<code class="code">rmail-mime</code>) command instead creates a
temporary buffer to display the current <abbr class="acronym">MIME</abbr> message.
</p>
<a class="index-entry-id" id="index-rmail_002depa_002ddecrypt"></a>
<a class="index-entry-id" id="index-encrypted-mails-_0028reading-in-Rmail_0029"></a>
<p>If the current message is an encrypted one, use the command
<kbd class="kbd">C-c C-d</kbd> (<code class="code">rmail-epa-decrypt</code>) to decrypt it, using the
EasyPG library (see <a href="https://www.gnu.org/software/emacs/manual/html_node/epa/index.html#Top">EasyPG</a> in <cite class="cite">EasyPG Assistant User&#8217;s Manual</cite>).
</p>
<p>You can highlight and activate URLs in the Rmail buffer using Goto
Address mode:
</p>
<div class="example">
<pre class="example-preformatted">(add-hook 'rmail-show-message-hook 'goto-address-mode)
</pre></div>

<p>Then you can browse these URLs by clicking on them with <kbd class="kbd">mouse-2</kbd>
(or <kbd class="kbd">mouse-1</kbd> quickly) or by moving to one and typing <kbd class="kbd">C-c
<kbd class="key">RET</kbd></kbd>.  See <a class="xref" href="Hyperlinking.xhtml#Goto-Address-mode">Activating URLs</a>.
</p>
</div>
<div class="section-level-extent" id="Rmail-Coding">
<h3 class="section" id="Rmail-and-Coding-Systems">34.14 Rmail and Coding Systems</h3>

<a class="index-entry-id" id="index-decoding-mail-messages-_0028Rmail_0029"></a>
<p>Rmail automatically decodes messages which contain non-<abbr class="acronym">ASCII</abbr>
characters, just as Emacs does with files you visit and with subprocess
output.  Rmail uses the standard &#8216;<samp class="samp">charset=<var class="var">charset</var></samp>&#8217; header in
the message, if any, to determine how the message was encoded by the
sender.  It maps <var class="var">charset</var> into the corresponding Emacs coding
system (see <a class="pxref" href="International.xhtml#Coding-Systems">Coding Systems</a>), and uses that coding system to decode
message text.  If the message header doesn&#8217;t have the &#8216;<samp class="samp">charset</samp>&#8217;
specification, or if <var class="var">charset</var> is not recognized,
Rmail chooses the coding system with the usual Emacs heuristics and
defaults (see <a class="pxref" href="International.xhtml#Recognize-Coding">Recognizing Coding Systems</a>).
</p>
<a class="index-entry-id" id="index-fixing-incorrectly-decoded-mail-messages"></a>
<p>Occasionally, a message is decoded incorrectly, either because Emacs
guessed the wrong coding system in the absence of the &#8216;<samp class="samp">charset</samp>&#8217;
specification, or because the specification was inaccurate.  For
example, a misconfigured mailer could send a message with a
&#8216;<samp class="samp">charset=iso-8859-1</samp>&#8217; header when the message is actually encoded
in <code class="code">koi8-r</code>.  When you see the message text garbled, or some of
its characters displayed as hex codes or empty boxes, this may have
happened.
</p>
<a class="index-entry-id" id="index-rmail_002dredecode_002dbody"></a>
<p>You can correct the problem by decoding the message again using the
right coding system, if you can figure out or guess which one is
right.  To do this, invoke the <kbd class="kbd">M-x rmail-redecode-body</kbd> command.
It reads the name of a coding system, and then redecodes the message
using the coding system you specified.  If you specified the right
coding system, the result should be readable.
</p>
<a class="index-entry-id" id="index-rmail_002dfile_002dcoding_002dsystem"></a>
<p>When you get new mail in Rmail, each message is translated
automatically from the coding system it is written in, as if it were a
separate file.  This uses the priority list of coding systems that you
have specified.  If a MIME message specifies a character set, Rmail
obeys that specification.  For reading and saving Rmail files
themselves, Emacs uses the coding system specified by the variable
<code class="code">rmail-file-coding-system</code>.  The default value is <code class="code">nil</code>,
which means that Rmail files are not translated (they are read and
written in the Emacs internal character code).
</p>
</div>
<div class="section-level-extent" id="Rmail-Editing">
<h3 class="section" id="Editing-Within-a-Message">34.15 Editing Within a Message</h3>

<p>Most of the usual Emacs key bindings are available in Rmail mode,
though a few, such as <kbd class="kbd">C-M-n</kbd> and <kbd class="kbd">C-M-h</kbd>, are redefined by
Rmail for other purposes.  However, the Rmail buffer is normally read
only, and most of the letters are redefined as Rmail commands.  If you
want to edit the text of a message, you must use the Rmail command
<kbd class="kbd">e</kbd>.
</p>
<dl class="table">
<dt><kbd class="kbd">e</kbd></dt>
<dd><p>Edit the current message as ordinary text.
</p></dd>
</dl>

<a class="index-entry-id" id="index-e-_0028Rmail_0029"></a>
<a class="index-entry-id" id="index-rmail_002dedit_002dcurrent_002dmessage"></a>
<p>The <kbd class="kbd">e</kbd> command (<code class="code">rmail-edit-current-message</code>) switches from
Rmail mode into Rmail Edit mode, another major mode which is nearly the
same as Text mode.  The mode line indicates this change.
</p>
<a class="index-entry-id" id="index-rmail_002dcease_002dedit"></a>
<a class="index-entry-id" id="index-rmail_002dabort_002dedit"></a>
<p>In Rmail Edit mode, letters insert themselves as usual and the Rmail
commands are not available.  You can edit the message body and header
fields.  When you are finished editing the message, type <kbd class="kbd">C-c C-c</kbd>
(<code class="code">rmail-cease-edit</code>) to switch back to Rmail mode.
Alternatively, you can return to Rmail mode but cancel any editing
that you have done, by typing <kbd class="kbd">C-c C-]</kbd> (<code class="code">rmail-abort-edit</code>).
</p>
<a class="index-entry-id" id="index-rmail_002dedit_002dmode_002dhook"></a>
<p>Entering Rmail Edit mode runs the hook <code class="code">text-mode-hook</code>; then
it runs the hook <code class="code">rmail-edit-mode-hook</code> (see <a class="pxref" href="Customization.xhtml#Hooks">Hooks</a>).
Returning to ordinary Rmail mode adds the attribute &#8216;<samp class="samp">edited</samp>&#8217; to
the message, if you have made any changes in it (see <a class="pxref" href="#Rmail-Attributes">Rmail Attributes</a>).
</p>
</div>
<div class="section-level-extent" id="Rmail-Digest">
<h3 class="section" id="Digest-Messages">34.16 Digest Messages</h3>
<a class="index-entry-id" id="index-digest-message"></a>
<a class="index-entry-id" id="index-undigestify"></a>

<p>A <em class="dfn">digest message</em> is a message which exists to contain and carry
several other messages.  Digests are used on some mailing
lists; all the messages that arrive for the list during a period of time
such as one day are put inside a single digest which is then sent to the
subscribers.  Transmitting the single digest uses less computer
time than transmitting the individual messages even though the total
size is the same, because of the per-message overhead in network mail
transmission.
</p>
<a class="index-entry-id" id="index-undigestify_002drmail_002dmessage"></a>
<p>When you receive a digest message, the most convenient way to read it is
to <em class="dfn">undigestify</em> it: to turn it back into many individual messages.
Then you can read and delete the individual messages as it suits you.
To do this, select the digest message and type the command <kbd class="kbd">M-x
undigestify-rmail-message</kbd>.  This extracts the submessages as separate
Rmail messages, and inserts them following the digest.  The digest
message itself is flagged as deleted.
</p>
</div>
<div class="section-level-extent" id="Rmail-Rot13">
<h3 class="section" id="Reading-Rot13-Messages">34.17 Reading Rot13 Messages</h3>
<a class="index-entry-id" id="index-rot13-code"></a>

<p>Mailing list messages that might offend or annoy some readers are sometimes
encoded in a simple code called <em class="dfn">rot13</em>&#8212;so named because it
rotates the alphabet by 13 letters.  This code is not for secrecy, as it
provides none; rather, it enables those who wish to avoid
seeing the real text of the message.  For example, a review of a film
might use rot13 to hide important plot points.
</p>
<a class="index-entry-id" id="index-rot13_002dother_002dwindow"></a>
<p>To view a buffer that uses the rot13 code, use the command <kbd class="kbd">M-x
rot13-other-window</kbd>.  This displays the current buffer in another window
which applies the code when displaying the text.
</p>
<a class="index-entry-id" id="index-rot13_002dregion"></a>
<p>If you are only interested in a region, the command <kbd class="kbd">M-x
rot13-region</kbd> might be preferable.  This will encrypt/decrypt the
active region in-place.  If the buffer is read-only, it will attempt
to display the plain text in the echo area.  If the text is too long
for the echo area, the command will pop up a temporary buffer with the
encrypted/decrypted text.
</p>
</div>
<div class="section-level-extent" id="Movemail">
<h3 class="section" id="movemail-program">34.18 <code class="command">movemail</code> program</h3>
<a class="index-entry-id" id="index-movemail-program"></a>

<p>Rmail uses the <code class="command">movemail</code> program to move mail from your inbox to
your Rmail file (see <a class="pxref" href="#Rmail-Inbox">Rmail Files and Inboxes</a>).  When loaded for the first time,
Rmail attempts to locate the <code class="command">movemail</code> program and determine its
version.  There are two versions of the <code class="command">movemail</code> program: the
GNU Mailutils version (see <a href="https://www.gnu.org/software/mailutils/manual/html_chapter/movemail.html#movemail">movemail</a> in <cite class="cite">GNU mailutils</cite>),
and an Emacs-specific version that is built and installed unless Emacs
was configured <samp class="option">--with-mailutils</samp> in effect.
The two <code class="command">movemail</code> versions support the same
command line syntax and the same basic subset of options.  However, the
Mailutils version offers additional features and is more secure.
</p>
<p>The Emacs version of <code class="command">movemail</code> can retrieve mail from the
usual Unix mailbox formats.  <strong class="strong">Warning</strong>: Although it can also use the POP3
protocol, this is not recommended because it does not support POP3 via
encrypted TLS channels.
</p>
<p>The Mailutils version is able to handle a wide set of mailbox
formats, such as plain Unix mailboxes, <code class="code">maildir</code> and <code class="code">MH</code>
mailboxes, etc.  It is able to access remote mailboxes using the POP3
or IMAP4 protocol, and can retrieve mail from them using a TLS
encrypted channel.  It also accepts mailbox arguments in <abbr class="acronym">URL</abbr>
form.  The detailed description of mailbox <abbr class="acronym">URL</abbr>s can be found
in <a href="https://www.gnu.org/software/mailutils/manual/html_chapter/URL.html#URL">URL</a> in <cite class="cite">Mailbox URL Formats</cite>.  In short, a
<abbr class="acronym">URL</abbr> is:
</p>
<div class="example smallexample">
<pre class="example-preformatted"><var class="var">proto</var>://[<var class="var">user</var>[:<var class="var">password</var>]@]<var class="var">host-or-file-name</var>[:<var class="var">port</var>]
</pre></div>

<p>where square brackets denote optional elements.
</p>
<dl class="table">
<dt><var class="var">proto</var></dt>
<dd><p>Specifies the <em class="dfn">mailbox protocol</em>, or <em class="dfn">format</em> to
use.  The exact semantics of the rest of <abbr class="acronym">URL</abbr> elements depends
on the actual value of <var class="var">proto</var> (see below).
</p>
</dd>
<dt><var class="var">user</var></dt>
<dd><p>User name to access the remote mailbox.
</p>
</dd>
<dt><var class="var">password</var></dt>
<dd><p>User password to access the remote mailbox.
</p>
</dd>
<dt><var class="var">host-or-file-name</var></dt>
<dd><p>Hostname of the remote server for remote mailboxes or file name of a
local mailbox.
</p>
</dd>
<dt><var class="var">port</var></dt>
<dd><p>Optional port number, if not the default for that protocol.
</p></dd>
</dl>

<p><var class="var">proto</var> can be one of:
</p>
<dl class="table">
<dt><code class="code">mbox</code></dt>
<dd><p>Usual Unix mailbox format.  In this case, <var class="var">user</var>, <var class="var">pass</var> and
<var class="var">port</var> are not used, and <var class="var">host-or-file-name</var> denotes the file
name of the mailbox file, e.g., <code class="code">mbox:///var/spool/mail/smith</code>.
</p>
</dd>
<dt><code class="code">mh</code></dt>
<dd><p>A local mailbox in the <abbr class="acronym">MH</abbr> format.  <var class="var">user</var>, <var class="var">pass</var>
and <var class="var">port</var> are not used.  <var class="var">host-or-file-name</var> denotes the name
of <abbr class="acronym">MH</abbr> folder, e.g., <code class="code">mh:///Mail/inbox</code>.
</p>
</dd>
<dt><code class="code">maildir</code></dt>
<dd><p>A local mailbox in the <abbr class="acronym">maildir</abbr> format.  <var class="var">user</var>,
<var class="var">pass</var> and <var class="var">port</var> are not used, and <var class="var">host-or-file-name</var>
denotes the name of <code class="code">maildir</code> mailbox, e.g.,
<code class="code">maildir:///mail/inbox</code>.
</p>
</dd>
<dt><code class="code">file</code></dt>
<dd><p>Any local file in mailbox format.  Its actual format is detected
automatically by <code class="command">movemail</code>.
</p>
</dd>
<dt><code class="code">pop</code></dt>
<dt><code class="code">pops</code></dt>
<dd><p>A remote mailbox to be accessed via POP3 protocol.  <var class="var">user</var>
specifies the remote user name to use, <var class="var">pass</var> may be used to
specify the user password, <var class="var">host-or-file-name</var> is the name or IP
address of the remote mail server to connect to, and <var class="var">port</var> is the
port number; e.g., <code class="code">pop://smith:guessme@remote.server.net:995</code>.
If the server supports it, <code class="command">movemail</code> tries to use an
encrypted connection&#8212;use the &#8216;<samp class="samp">pops</samp>&#8217; form to require one.
</p>
</dd>
<dt><code class="code">imap</code></dt>
<dt><code class="code">imaps</code></dt>
<dd><p>A remote mailbox to be accessed via IMAP4 protocol.  <var class="var">user</var>
specifies the remote user name to use, <var class="var">pass</var> may be used to
specify the user password, <var class="var">host-or-file-name</var> is the name or IP
address of the remote mail server to connect to, and <var class="var">port</var> is the
port number; e.g., <code class="code">imap://smith:guessme@remote.server.net:993</code>.
If the server supports it, <code class="command">movemail</code> tries to use an
encrypted connection&#8212;use the &#8216;<samp class="samp">imaps</samp>&#8217; form to require one.
</p></dd>
</dl>

<p>Alternatively, you can specify the file name of the mailbox to use.
This is equivalent to specifying the &#8216;<samp class="samp">file</samp>&#8217; protocol:
</p>
<div class="example smallexample">
<pre class="example-preformatted">/var/spool/mail/<var class="var">user</var> &#8801; file:///var/spool/mail/<var class="var">user</var>
</pre></div>

<a class="index-entry-id" id="index-rmail_002dmovemail_002dprogram"></a>
<a class="index-entry-id" id="index-rmail_002dmovemail_002dsearch_002dpath"></a>
<p>The variable <code class="code">rmail-movemail-program</code> controls which version of
<code class="command">movemail</code> to use.  If that is a string, it specifies the
absolute file name of the <code class="command">movemail</code> executable.  If it is
<code class="code">nil</code>, Rmail searches for <code class="command">movemail</code> in the directories
listed in <code class="code">rmail-movemail-search-path</code>, then in <code class="code">exec-path</code>
(see <a class="pxref" href="Shell.xhtml#Shell">Running Shell Commands from Emacs</a>), then in <code class="code">exec-directory</code>.
</p>
</div>
<div class="section-level-extent" id="Remote-Mailboxes">
<h3 class="section" id="Retrieving-Mail-from-Remote-Mailboxes">34.19 Retrieving Mail from Remote Mailboxes</h3>
<a class="index-entry-id" id="index-movemail"></a>

<p>Some sites use a method called POP3 for accessing users&#8217; inbox data
instead of storing the data in inbox files.  The Mailutils
<code class="command">movemail</code> by default supports POP3 with TLS encryption.
<strong class="strong">Warning:</strong> Although the <code class="command">Emacs movemail</code> supports POP3,
its use for this is not recommended since it does not support encrypted
connections&#8212;the Mailutils version does.
Both versions of <code class="command">movemail</code> work only with POP3, not with
older versions of POP.
</p>
<a class="index-entry-id" id="index-MAILHOST-environment-variable"></a>
<a class="index-entry-id" id="index-POP3-mailboxes"></a>
<p>You can specify
a POP3 inbox by using a POP3 <em class="dfn">URL</em> (see <a class="pxref" href="#Movemail"><code class="command">movemail</code> program</a>).  A POP3
<abbr class="acronym">URL</abbr> is of the form
&#8216;<samp class="samp">pop://<var class="var">username</var>@<var class="var">hostname</var>:<var class="var">port</var></samp>&#8217;, where
<var class="var">hostname</var> and <var class="var">port</var> are the host name (or IP address)
and port number of the remote mail
server and <var class="var">username</var> is the user name on that server.
Additionally, you may specify the password in the mailbox <abbr class="acronym">URL</abbr>:
&#8216;<samp class="samp">pop://<var class="var">username</var>:<var class="var">password</var>@<var class="var">hostname</var>:<var class="var">port</var></samp>&#8217;.  In this
case, <var class="var">password</var> takes preference over the one set by
<code class="code">rmail-remote-password</code> (see below).  This is especially useful
if you have several remote mailboxes with different passwords.
If using Mailutils <code class="command">movemail</code>, you may wish to use
&#8216;<samp class="samp">pops</samp>&#8217; in place of &#8216;<samp class="samp">pop</samp>&#8217;.
</p>
<p>For backward compatibility, Rmail also supports an alternative way of
specifying remote POP3 mailboxes.  Specifying an inbox name in the form
&#8216;<samp class="samp">po:<var class="var">username</var>:<var class="var">hostname</var>:<var class="var">port</var></samp>&#8217; is equivalent to
&#8216;<samp class="samp">pop://<var class="var">username</var>@<var class="var">hostname</var>:<var class="var">port</var></samp>&#8217;.  If you omit the
<var class="var">:hostname</var> part, the <code class="env">MAILHOST</code> environment variable specifies
the machine on which to look for the POP3 server.
</p>
<a class="index-entry-id" id="index-IMAP-mailboxes"></a>
<p>Another method for accessing remote mailboxes is IMAP.  This method is
supported only by the Mailutils <code class="command">movemail</code>.  To specify an IMAP
mailbox in the inbox list, use the following mailbox <abbr class="acronym">URL</abbr>:
&#8216;<samp class="samp">imap://<var class="var">username</var>[:<var class="var">password</var>]@<var class="var">hostname</var>:<var class="var">port</var></samp>&#8217;.  The
<var class="var">password</var> part is optional, as described above.  You may wish to
use &#8216;<samp class="samp">imaps</samp>&#8217; in place of &#8216;<samp class="samp">imap</samp>&#8217;.
</p>
<a class="index-entry-id" id="index-rmail_002dremote_002dpassword"></a>
<a class="index-entry-id" id="index-rmail_002dremote_002dpassword_002drequired"></a>
<p>Accessing a remote mailbox may require a password.  Rmail uses the
following algorithm to retrieve it:
</p>
<ol class="enumerate">
<li> If a <var class="var">password</var> is present in the mailbox URL (see above), it is
used.
</li><li> If the variable <code class="code">rmail-remote-password-required</code> is <code class="code">nil</code>,
Rmail assumes no password is required.
</li><li> If the variable <code class="code">rmail-remote-password</code> is non-<code class="code">nil</code>, its
value is used.
</li><li> Otherwise, Rmail will ask you for the password to use.
</li></ol>

<p>On some mail servers the usernames include domain information, which
can mean they contain the &#8216;<samp class="samp">@</samp>&#8217; character.  The inbox specifier
string uses &#8216;<samp class="samp">@</samp>&#8217; to signal the start of the mailserver name.
This creates confusion for movemail.  If your username contains
&#8216;<samp class="samp">@</samp>&#8217; and you&#8217;re using Mailutils <code class="command">movemail</code> then you can
fix this: Replace <code class="code">@</code> in the user name with its <abbr class="acronym">URL</abbr>
encoding &#8216;<samp class="samp">%40</samp>&#8217;.
</p>
<a class="index-entry-id" id="index-rmail_002dmovemail_002dflags"></a>
<p>If you need to pass additional command-line flags to <code class="command">movemail</code>,
set the variable <code class="code">rmail-movemail-flags</code> a list of the flags you
wish to use.  Do not use this variable to pass the &#8216;<samp class="samp">-p</samp>&#8217; flag to
preserve your inbox contents; use <code class="code">rmail-preserve-inbox</code> instead.
</p>
<a class="index-entry-id" id="index-Kerberos-POP3-authentication"></a>
<p>The <code class="command">movemail</code> program installed at your site may support
Kerberos authentication.  If it is supported, it is used by default
whenever you attempt to retrieve POP3 mail when
<code class="code">rmail-remote-password</code> and <code class="code">rmail-remote-password-required</code>
are unset.
</p>
<a class="index-entry-id" id="index-reverse-order-in-POP3-inboxes"></a>
<p>Some POP3 servers store messages in reverse order.  If your server does
this, and you would rather read your mail in the order in which it was
received, you can tell <code class="command">movemail</code> to reverse the order of
downloaded messages by adding the &#8216;<samp class="samp">-r</samp>&#8217; flag to
<code class="code">rmail-movemail-flags</code>.
</p>
<a class="index-entry-id" id="index-TLS-encryption-_0028Rmail_0029"></a>
<p>Mailutils <code class="command">movemail</code> supports TLS encryption.  If you wish to
use it, add the &#8216;<samp class="samp">--tls</samp>&#8217; flag to <code class="code">rmail-movemail-flags</code>.
</p>
</div>
<div class="section-level-extent" id="Other-Mailbox-Formats">
<h3 class="section" id="Retrieving-Mail-from-Local-Mailboxes-in-Various-Formats">34.20 Retrieving Mail from Local Mailboxes in Various Formats</h3>

<p>If your incoming mail is stored on a local machine in a format other
than Unix mailbox, you will need the Mailutils <code class="command">movemail</code> to
retrieve it.  See <a class="xref" href="#Movemail"><code class="command">movemail</code> program</a>, for the detailed description of
<code class="command">movemail</code> versions.  For example, to access mail from an inbox in
<code class="code">maildir</code> format located in <samp class="file">/var/spool/mail/in</samp>, you would
include the following in the Rmail inbox list:
</p>
<div class="example smallexample">
<pre class="example-preformatted">maildir:///var/spool/mail/in
</pre></div>


</div>
</div>
<div class="footnotes-segment">
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT19" href="#DOCF19">(19)</a></h5>
<p>This capability requires that Emacs be built with <samp class="file">libxml2</samp>
support or that you have the Lynx browser installed.</p>
</div>



</body>
</html>
