<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<!-- 这是 GNU Emacs 手册,
为 Emacs  29.2 更新

英文原版版权提示 - Original English version copyright note

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being "The GNU Manifesto," "Distribution" and
"GNU GENERAL PUBLIC LICENSE," with the Front-Cover Texts being "A GNU
Manual," and with the Back-Cover Texts as in (a) below.  A copy of the
license is included in the section entitled "GNU Free Documentation
License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."

中文翻译版版权提示 - Chinese translation revision copyright notice

版权所有 © 1985-2024 林羿轩(Ralph Lin).

您有在 Free Software Foundation发布的GNU Free Documentation License 第1.3版或之后版本的约束下对其进行再发布及修的权利。 恒定章节为 "The GNU Manifesto," "分发" "(中文版)GNU GENERAL PUBLIC LICENSE" 和
"GNU GENERAL PUBLIC LICENSE" , 前封面文字为 "A GNU
Manual,"后封面文字如下(a).  本书的FDL许可证可以在 "GNU Free Documentation
License."找到.

(a) FSF的后封面文字为: "You have the freedom to copy and
modify this GNU manual.  Buying copies from the FSF supports it in
developing GNU and promoting software freedom."
 -->
<title>33 Sending Mail (GNU Emacs Manual)</title>

<meta name="description" content="33 Sending Mail (GNU Emacs Manual)"/>
<meta name="keywords" content="33 Sending Mail (GNU Emacs Manual)"/>
<meta name="resource-type" content="document"/>
<meta name="distribution" content="global"/>
<meta name="Generator" content="texi2any"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<link href="emacs.xhtml" rel="start" title="Emacs 编辑器"/>
<link href="Key-Index.xhtml" rel="index" title="Key (Character) Index"/>
<link href="emacs.xhtml#SEC_Contents" rel="contents" title="Table of Contents"/>
<link href="emacs.xhtml" rel="up" title="Emacs 编辑器"/>
<link href="Rmail.xhtml#Rmail" rel="next" title="34 Reading Mail with Rmail"/>
<link href="Calendar_002fDiary.xhtml#Calendar_002fDiary" rel="prev" title="32 The Calendar and the Diary"/>
<style type="text/css">
<!--
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
-->
</style>


</head>

<body lang="zh_CN">
<div class="chapter-level-extent" id="Sending-Mail">

<h2 class="chapter" id="Sending-Mail-1">33 Sending Mail</h2>
<a class="index-entry-id" id="index-sending-mail"></a>
<a class="index-entry-id" id="index-mail"></a>
<a class="index-entry-id" id="index-email"></a>
<a class="index-entry-id" id="index-message"></a>

<a class="index-entry-id" id="index-C_002dx-m"></a>
<a class="index-entry-id" id="index-compose_002dmail"></a>
<p>To send an email message from Emacs, type <kbd class="kbd">C-x m</kbd>.  This
switches to a buffer named <samp class="file">*unsent mail*</samp>, where you can edit
the text and headers of the message.  When done, type <kbd class="kbd">C-c C-s</kbd> or
<kbd class="kbd">C-c C-c</kbd> to send it.
</p>
<dl class="table">
<dt><kbd class="kbd">C-x m</kbd></dt>
<dd><p>Begin composing mail (<code class="code">compose-mail</code>).
</p></dd>
<dt><kbd class="kbd">C-x 4 m</kbd></dt>
<dd><p>Likewise, in another window (<code class="code">compose-mail-other-window</code>).
</p></dd>
<dt><kbd class="kbd">C-x 5 m</kbd></dt>
<dd><p>Likewise, but in a new frame (<code class="code">compose-mail-other-frame</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-s</kbd></dt>
<dd><p>In the mail buffer, send the message (<code class="code">message-send</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-c</kbd></dt>
<dd><p>In the mail buffer, send the message and bury the buffer
(<code class="code">message-send-and-exit</code>).
</p></dd>
</dl>

<p>The mail buffer is an ordinary Emacs buffer, so you can switch to
other buffers while composing the mail.  If you want to send another
message before finishing the current one, type <kbd class="kbd">C-x m</kbd> again to
open a new mail buffer whose name has a different numeric suffix
(see <a class="pxref" href="Buffers.xhtml#Misc-Buffer">Miscellaneous Buffer Operations</a>).  (This only works if you use the default
Message mode to compose email; see <a class="ref" href="#Mail-Commands">Mail Commands</a>.)  If you know
that you&#8217;d like to continue composing the unsent message you were
editing, invoke this command with a prefix argument, <kbd class="kbd">C-u&#160;C-x&#160;m</kbd><!-- /@w -->, and Emacs will switch to the last mail buffer you used and let
you pick up editing the message where you left off.
</p>
<a class="index-entry-id" id="index-C_002dx-4-m"></a>
<a class="index-entry-id" id="index-compose_002dmail_002dother_002dwindow"></a>
<a class="index-entry-id" id="index-C_002dx-5-m"></a>
<a class="index-entry-id" id="index-compose_002dmail_002dother_002dframe"></a>
<p>The command <kbd class="kbd">C-x 4 m</kbd> (<code class="code">compose-mail-other-window</code>) does
the same as <kbd class="kbd">C-x m</kbd>, except it displays the mail buffer in a
different window.  The command <kbd class="kbd">C-x 5 m</kbd>
(<code class="code">compose-mail-other-frame</code>) does it in a new frame.
</p>
<p>When you type <kbd class="kbd">C-c C-c</kbd> or <kbd class="kbd">C-c C-s</kbd> to send the mail, Emacs
may ask you how it should deliver the mail&#8212;either directly via SMTP,
or using some other method.  See <a class="xref" href="#Mail-Sending">Mail Sending</a>, for details.
</p>

<div class="section-level-extent" id="Mail-Format">
<h3 class="section" id="The-Format-of-the-Mail-Buffer">33.1 The Format of the Mail Buffer</h3>

<p>Here is an example of the contents of a mail buffer:
</p>
<div class="example">
<pre class="example-preformatted">To: subotai@example.org
CC: mongol.soldier@example.net, rms@gnu.org
Subject: Re: What is best in life?
From: conan@example.org
--text follows this line--
To crush your enemies, see them driven before you, and to
hear the lamentation of their women.
</pre></div>

<p>At the top of the mail buffer is a set of <em class="dfn">header fields</em>, which
are used for specifying information about the email&#8217;s recipient(s),
subject, and so on.  The above buffer contains header fields for
&#8216;<samp class="samp">To</samp>&#8217;, &#8216;<samp class="samp">CC</samp>&#8217;, &#8216;<samp class="samp">Subject</samp>&#8217;, and &#8216;<samp class="samp">From</samp>&#8217;.  Some header
fields are automatically pre-initialized in the mail buffer, when
appropriate.
</p>
<p>The line that says &#8216;<samp class="samp">--text follows this line--</samp>&#8217; separates the
header fields from the <em class="dfn">body</em> (or <em class="dfn">text</em>) of the message.
Everything above that line is treated as part of the headers;
everything below it is treated as the body.  The delimiter line itself
does not appear in the message actually sent.
</p>
<p>You can insert and edit header fields using ordinary editing
commands.  See <a class="xref" href="#Header-Editing">Mail Header Editing</a>, for commands specific to editing
header fields.  Certain headers, such as &#8216;<samp class="samp">Date</samp>&#8217; and
&#8216;<samp class="samp">Message-Id</samp>&#8217;, are normally omitted from the mail buffer and are
created automatically when the message is sent.
</p>
</div>
<div class="section-level-extent" id="Mail-Headers">
<h3 class="section" id="Mail-Header-Fields">33.2 Mail Header Fields</h3>
<a class="index-entry-id" id="index-headers-_0028of-mail-message_0029"></a>

<p>A header field in the mail buffer starts with a field name at the
beginning of a line, terminated by a colon.  Upper and lower case are
equivalent in field names.  After the colon and optional whitespace
comes the contents of the field.
</p>
<p>You can use any name you like for a header field, but normally
people use only standard field names with accepted meanings.
</p>
<a class="index-entry-id" id="index-user_002dfull_002dname"></a>
<a class="index-entry-id" id="index-user_002dmail_002daddress"></a>
<p>The &#8216;<samp class="samp">From</samp>&#8217; header field identifies the person sending the email
(i.e., you).  This should be a valid mailing address, as replies are
normally sent there.  The default contents of this header field are
computed from the variables <code class="code">user-full-name</code> (which specifies
your full name) and <code class="code">user-mail-address</code> (your email address).  On
some operating systems, Emacs initializes these two variables using
environment variables (see <a class="pxref" href="Emacs-Invocation.xhtml#General-Variables">General Variables</a>).  If this
information is unavailable or wrong, you should customize the
variables yourself (see <a class="pxref" href="Customization.xhtml#Easy-Customization">Easy Customization Interface</a>).
</p>
<p>Apart from &#8216;<samp class="samp">From</samp>&#8217;, here is a table of commonly-used fields:
</p>
<dl class="table">
<dt>&#8216;<samp class="samp">To</samp>&#8217;</dt>
<dd><p>The mailing address(es) to which the message is addressed.  To list
more than one address, use commas to separate them.
</p>
</dd>
<dt>&#8216;<samp class="samp">Subject</samp>&#8217;</dt>
<dd><p>The subject of the message.
</p>
</dd>
<dt>&#8216;<samp class="samp">CC</samp>&#8217;</dt>
<dd><p>Additional mailing address(es) to send the message to.  This is like
&#8216;<samp class="samp">To</samp>&#8217;, except that these readers should not regard the message as
directed at them.
</p>
</dd>
<dt>&#8216;<samp class="samp">BCC</samp>&#8217;</dt>
<dd><p>Additional mailing address(es) to send the message to, which should
not appear in the header of the message actually sent.  &#8216;<samp class="samp">BCC</samp>&#8217; stands
for <em class="dfn">blind carbon copies</em>.
</p>
</dd>
<dt>&#8216;<samp class="samp">FCC</samp>&#8217;</dt>
<dd><p>The name of a file, to which a copy of the sent message should be
appended.  Emacs writes the message in mbox format, unless the file is
in Babyl format (used by Rmail before Emacs 23), in which case Emacs
writes in Babyl format.  If an Rmail buffer is visiting the file,
Emacs updates it accordingly.  To specify more than one file, use
several &#8216;<samp class="samp">FCC</samp>&#8217; fields, with one file name in each field.
</p>
</dd>
<dt>&#8216;<samp class="samp">Reply-To</samp>&#8217;</dt>
<dd><p>An address to which replies should be sent, instead of &#8216;<samp class="samp">From</samp>&#8217;.
This is used if, for some reason, your &#8216;<samp class="samp">From</samp>&#8217; address cannot
receive replies.
</p>
</dd>
<dt>&#8216;<samp class="samp">Mail-Reply-To</samp>&#8217;</dt>
<dd><p>This field takes precedence over &#8216;<samp class="samp">Reply-To</samp>&#8217;.  It is used because
some mailing lists set the &#8216;<samp class="samp">Reply-To</samp>&#8217; field for their own
purposes (a somewhat controversial practice).
</p>
</dd>
<dt>&#8216;<samp class="samp">Mail-Followup-To</samp>&#8217;</dt>
<dd><p>One of more address(es) to use as default recipient(s) for follow-up
messages.  This is typically used when you reply to a message from a
mailing list that you are subscribed to, and want replies to go to the
list without sending an extra copy to you.
</p>
</dd>
<dt>&#8216;<samp class="samp">In-Reply-To</samp>&#8217;</dt>
<dd><p>An identifier for the message you are replying to.  Most mail readers
use this information to group related messages together.  Normally,
this header is filled in automatically when you reply to a message in
any mail program built into Emacs.
</p>
</dd>
<dt>&#8216;<samp class="samp">References</samp>&#8217;</dt>
<dd><p>Identifiers for previous related messages.  Like &#8216;<samp class="samp">In-Reply-To</samp>&#8217;,
this is normally filled in automatically for you.
</p></dd>
</dl>

<p>The &#8216;<samp class="samp">To</samp>&#8217;, &#8216;<samp class="samp">CC</samp>&#8217;, and &#8216;<samp class="samp">BCC</samp>&#8217; fields can appear any number
of times, and each such header field can contain multiple addresses,
separated by commas.  This way, you can specify any number of places
to send the message.  These fields can also have continuation lines:
one or more lines starting with whitespace, following the starting
line of the field, are considered part of the field.  Here&#8217;s an
example of a &#8216;<samp class="samp">To</samp>&#8217; field with a continuation line:
</p>
<div class="example">
<div class="group"><pre class="example-preformatted">To: foo@example.net, this@example.net,
  bob@example.com
</pre></div></div>


<a class="index-entry-id" id="index-mail_002ddefault_002dheaders"></a>
<p>You can direct Emacs to insert certain default headers into the mail
buffer by setting the variable <code class="code">mail-default-headers</code> to a
string.  Then <kbd class="kbd">C-x m</kbd> inserts this string into the message
headers.  For example, here is how to add a &#8216;<samp class="samp">Reply-To</samp>&#8217; and
&#8216;<samp class="samp">FCC</samp>&#8217; header to each message:
</p>
<div class="example smallexample">
<pre class="example-preformatted">(setq mail-default-headers
      &quot;Reply-To: foo@example.com\nFCC: ~/Mail/sent&quot;)
</pre></div>

<p>If the default header fields are not appropriate for a
particular message, edit them as necessary before sending the message.
</p>
</div>
<div class="section-level-extent" id="Mail-Aliases">
<h3 class="section" id="Mail-Aliases-1">33.3 Mail Aliases</h3>
<a class="index-entry-id" id="index-mail-aliases"></a>
<a class="index-entry-id" id="index-_002emailrc-file"></a>
<a class="index-entry-id" id="index-mailrc-file"></a>
<a class="index-entry-id" id="index-mail_002dpersonal_002dalias_002dfile"></a>

<p>You can define <em class="dfn">mail aliases</em>, which are short mnemonic names
that stand for one or more mailing addresses.  By default, mail
aliases are defined in the file <samp class="file">~/.mailrc</samp>.  You can specify a
different file name to use, by setting the variable
<code class="code">mail-personal-alias-file</code>.
</p>
<p>To define an alias in <samp class="file">~/.mailrc</samp>, write a line like this:
</p>
<div class="example">
<pre class="example-preformatted">alias <var class="var">nick</var> <var class="var">fulladdresses</var>
</pre></div>

<p>This means that <var class="var">nick</var> should expand into <var class="var">fulladdresses</var>,
where <var class="var">fulladdresses</var> can be either a single address, or multiple
addresses separated with spaces.  For instance, to make <code class="code">maingnu</code>
stand for <code class="code">gnu@gnu.org</code> plus a local address of your own, put in
this line:
</p>
<div class="example">
<pre class="example-preformatted">alias maingnu gnu@gnu.org local-gnu
</pre></div>

<p>If an address contains a space, quote the whole address with a pair of
double quotes, like this:
</p>
<div class="example">
<pre class="example-preformatted">alias jsmith &quot;John Q. Smith &lt;none@example.com&gt;&quot;
</pre></div>

<p>Note that you need not include double quotes around individual parts
of the address, such as the person&#8217;s full name.  Emacs puts them in if
they are needed.  For instance, it inserts the above address as
&#8216;<samp class="samp">&quot;John Q. Smith&quot; &lt;none@example.com&gt;</samp>&#8217;.
</p>
<a class="index-entry-id" id="index-rebuild_002dmail_002dabbrevs"></a>
<a class="index-entry-id" id="index-merge_002dmail_002dabbrevs"></a>
<p>After editing the <samp class="file">~/.mailrc</samp> file, or if the file was modified
outside of Emacs, you can update the mail aliases used by a running
Emacs session with <kbd class="kbd">M-x&#160;rebuild-mail-abbrevs&#160;<kbd class="key">RET</kbd></kbd><!-- /@w -->.  This
prompts for the name of the file to use, the default being the value
of <code class="code">mail-personal-alias-file</code>.  A similar command
<code class="code">merge-mail-abbrevs</code> prompts for a file with mail aliases, then
merges the aliases in that file with the existing ones.
</p>
<a class="index-entry-id" id="index-define_002dmail_002dabbrev"></a>
<p>Alternatively, you can use Emacs commands to define mail aliases.
The command <code class="code">define-mail-abbrev</code> prompts for the alias and the
full address, and defines the alias to expand to the full address.
Emacs will save the added aliases whenever it offers to save all
files (for <kbd class="kbd">C-x s</kbd> or <kbd class="kbd">C-x C-c</kbd>), like it does with other
abbrevs (see <a class="pxref" href="Abbrevs.xhtml#Saving-Abbrevs">Saving Abbrevs</a>).
</p>
<p>Emacs also recognizes include commands in <samp class="file">~/.mailrc</samp>.  They
look like this:
</p>
<div class="example">
<pre class="example-preformatted">source <var class="var">filename</var>
</pre></div>

<p>The <samp class="file">~/.mailrc</samp> file is not unique to Emacs; many other
mail-reading programs use it for mail aliases, and it can contain
various other commands.  However, Emacs ignores everything except
alias definitions and include commands.
</p>
<a class="index-entry-id" id="index-mail_002dabbrev_002dinsert_002dalias"></a>
<p>Mail aliases expand as abbrevs&#8212;that is to say, as soon as you type
a word-separator character after an alias (see <a class="pxref" href="Abbrevs.xhtml#Abbrevs">Abbrevs</a>).  This
expansion takes place only within the &#8216;<samp class="samp">To</samp>&#8217;, &#8216;<samp class="samp">From</samp>&#8217;,
&#8216;<samp class="samp">CC</samp>&#8217;, &#8216;<samp class="samp">BCC</samp>&#8217;, and &#8216;<samp class="samp">Reply-To</samp>&#8217; header fields (plus their
&#8216;<samp class="samp">Resent-</samp>&#8217; variants); it does not take place in other header
fields, such as &#8216;<samp class="samp">Subject</samp>&#8217;.
</p>
<p>You can also insert an aliased address directly, using the command
<kbd class="kbd">M-x mail-abbrev-insert-alias</kbd>.  This reads an alias name, with
completion, and inserts its definition at point.
</p>
<a class="index-entry-id" id="index-mail_002dabbrev_002dcomplete_002dalias"></a>
<p>The command <code class="code">mail-abbrev-complete-alias</code> completes on the mail
alias preceding point.
</p>
</div>
<div class="section-level-extent" id="Mail-Commands">
<h3 class="section" id="Mail-Commands-1">33.4 Mail Commands</h3>
<a class="index-entry-id" id="index-Message-mode"></a>
<a class="index-entry-id" id="index-mode_002c-Message"></a>

<p>The default major mode for the <samp class="file">*mail*</samp> buffer is called
Message mode.  It behaves like Text mode in many ways, but provides
several additional commands on the <kbd class="kbd">C-c</kbd> prefix, which make
editing a message more convenient.
</p>
<p>In this section, we will describe some of the most commonly-used
commands available in Message mode.
Message mode also has its own manual, where its features are described
in greater detail.  See <a href="https://www.gnu.org/software/emacs/manual/html_node/message/index.html#Top">Message</a> in <cite class="cite">Message</cite>.
</p>

<div class="subsection-level-extent" id="Mail-Sending">
<h4 class="subsection" id="Mail-Sending-1">33.4.1 Mail Sending</h4>

<dl class="table">
<dt><kbd class="kbd">C-c C-c</kbd></dt>
<dd><p>Send the message, and bury the mail buffer (<code class="code">message-send-and-exit</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-s</kbd></dt>
<dd><p>Send the message, and leave the mail buffer selected (<code class="code">message-send</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-C_002dc-C_002ds-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-C_002dc-C_002dc-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dsend"></a>
<a class="index-entry-id" id="index-message_002dsend_002dand_002dexit"></a>
<a class="index-entry-id" id="index-message_002dkill_002dbuffer_002don_002dexit"></a>
<p>The usual command to send a message is <kbd class="kbd">C-c C-c</kbd>
(<code class="code">message-send-and-exit</code>).  This sends the message and then
buries the mail buffer, putting it at the lowest priority for
reselection.  If you want it to kill the mail buffer instead, change
the variable <code class="code">message-kill-buffer-on-exit</code> to <code class="code">t</code>.
</p>
<p>The command <kbd class="kbd">C-c C-s</kbd> (<code class="code">message-send</code>) sends the message
and leaves the buffer selected.  Use this command if you want to
modify the message (perhaps with new recipients) and send it again.
</p>
<a class="index-entry-id" id="index-message_002dsend_002dhook"></a>
<p>Sending a message runs the hook <code class="code">message-send-hook</code>.  It also
marks the mail buffer as unmodified, except if the mail buffer is also
a file-visiting buffer (in that case, only saving the file does that,
and you don&#8217;t get a warning if you try to send the same message
twice).
</p>
<a class="index-entry-id" id="index-SMTP"></a>
<a class="index-entry-id" id="index-Feedmail"></a>
<a class="index-entry-id" id="index-Sendmail"></a>
<a class="index-entry-id" id="index-Mailclient"></a>
<a class="index-entry-id" id="index-message_002dsend_002dmail_002dfunction"></a>
<a class="index-entry-id" id="index-send_002dmail_002dfunction"></a>
<p>The variable <code class="code">message-send-mail-function</code> controls how the
message is delivered (<code class="code">send-mail-function</code> is used for Mail mode).
The value of <code class="code">send-mail-function</code> should be one of the following
functions:
</p>
<dl class="table">
<dt><code class="code">sendmail-query-once</code></dt>
<dd><p>Query for a delivery method (one of the other entries in this list),
and use that method for this message; then save the method to
<code class="code">send-mail-function</code>, so that it is used for future deliveries.
This is the default, unless you have already set the variables for
sending mail via <code class="code">smtpmail-send-it</code> (see below).
</p>
</dd>
<dt><code class="code">smtpmail-send-it</code></dt>
<dd><p>Send mail through an external mail host, such as your
Internet service provider&#8217;s outgoing SMTP mail server.  If you have
not told Emacs how to contact the SMTP server, it prompts for this
information, which is saved in the <code class="code">smtpmail-smtp-server</code> variable
and the file <samp class="file">~/.authinfo</samp>.
See <a href="../smtpmail_epub3/index.html#Top">Emacs SMTP Library</a> in <cite class="cite">Sending mail via SMTP</cite>.
</p>
</dd>
<dt><code class="code">sendmail-send-it</code></dt>
<dd><p>Send mail using the system&#8217;s default <code class="command">sendmail</code> program, or
equivalent.  This requires the system to be set up for delivering mail
directly via SMTP.
</p>
</dd>
<dt><code class="code">mailclient-send-it</code></dt>
<dd><p>Pass the mail buffer on to the system&#8217;s designated mail client.  See
the commentary section in the file <samp class="file">mailclient.el</samp> for details.
</p>
</dd>
<dt><code class="code">feedmail-send-it</code></dt>
<dd><p>This is similar to <code class="code">sendmail-send-it</code>, but allows you to queue
messages for later sending.  See the commentary section in the file
<samp class="file">feedmail.el</samp> for details.
</p></dd>
</dl>

<p>When you send a message containing non-<abbr class="acronym">ASCII</abbr> characters,
they need to be encoded with a coding system (see <a class="pxref" href="International.xhtml#Coding-Systems">Coding Systems</a>).
Usually the coding system is specified automatically by your chosen
language environment (see <a class="pxref" href="International.xhtml#Language-Environments">Language Environments</a>).  You can
explicitly specify the coding system for outgoing mail by setting the
variable <code class="code">sendmail-coding-system</code> (see <a class="pxref" href="International.xhtml#Recognize-Coding">Recognizing Coding Systems</a>).  If
the coding system thus determined does not handle the characters in a
particular message, Emacs asks you to select the coding system to use,
showing a list of possible coding systems.  See <a class="xref" href="International.xhtml#Output-Coding">Choosing Coding Systems for Output</a>.
</p>
</div>
<div class="subsection-level-extent" id="Header-Editing">
<h4 class="subsection" id="Mail-Header-Editing">33.4.2 Mail Header Editing</h4>

<p>Message mode provides the following special commands to move to
particular header fields and to complete addresses in headers.
</p>
<dl class="table">
<dt><kbd class="kbd">C-c C-f C-t</kbd></dt>
<dd><p>Move to the &#8216;<samp class="samp">To</samp>&#8217; header (<code class="code">message-goto-to</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-f C-s</kbd></dt>
<dd><p>Move to the &#8216;<samp class="samp">Subject</samp>&#8217; header (<code class="code">message-goto-subject</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-f C-c</kbd></dt>
<dd><p>Move to the &#8216;<samp class="samp">CC</samp>&#8217; header (<code class="code">message-goto-cc</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-f C-b</kbd></dt>
<dd><p>Move to the &#8216;<samp class="samp">BCC</samp>&#8217; header (<code class="code">message-goto-bcc</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-f C-r</kbd></dt>
<dd><p>Move to the &#8216;<samp class="samp">Reply-To</samp>&#8217; header (<code class="code">message-goto-reply-to</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-f C-f</kbd></dt>
<dd><p>Move to the &#8216;<samp class="samp">Mail-Followup-To</samp>&#8217; header field
(<code class="code">message-goto-followup-to</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-f C-w</kbd></dt>
<dd><p>Add a new &#8216;<samp class="samp">FCC</samp>&#8217; header field, with file-name completion
(<code class="code">message-goto-fcc</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-b</kbd></dt>
<dd><p>Move to the start of the message body (<code class="code">message-goto-body</code>).
</p></dd>
<dt><kbd class="kbd"><kbd class="key">TAB</kbd></kbd></dt>
<dd><p>Complete a mailing address (<code class="code">message-tab</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-C_002dc-C_002df-C_002dt-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dgoto_002dto"></a>
<a class="index-entry-id" id="index-C_002dc-C_002df-C_002ds-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dgoto_002dsubject"></a>
<a class="index-entry-id" id="index-C_002dc-C_002df-C_002dc-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dgoto_002dcc"></a>
<a class="index-entry-id" id="index-C_002dc-C_002df-C_002db-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dgoto_002dbcc"></a>
<a class="index-entry-id" id="index-C_002dc-C_002df-C_002dr-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-goto_002dreply_002dto"></a>
<a class="index-entry-id" id="index-C_002dc-C_002df-C_002df-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-goto_002dfollowup_002dto"></a>
<a class="index-entry-id" id="index-C_002dc-C_002df-C_002dw-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dgoto_002dfcc"></a>
<p>The commands to move point to particular header fields are all based
on the prefix <kbd class="kbd">C-c C-f</kbd> (&#8216;<samp class="samp">C-f</samp>&#8217; is for &#8220;field&#8221;).  If the
field in question does not exist, the command creates one (the
exception is <code class="code">mail-fcc</code>, which creates a new field each time).
</p>
<a class="index-entry-id" id="index-C_002dc-C_002db-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-mail_002dtext"></a>
<p>The command <kbd class="kbd">C-c C-b</kbd> (<code class="code">message-goto-body</code>) moves point to
just after the header separator line&#8212;that is, to the beginning of
the body.
</p>
<a class="index-entry-id" id="index-message_002dtab"></a>
<a class="index-entry-id" id="index-TAB-_0028Message-mode_0029"></a>
<p>While editing a header field that contains addresses, such as
&#8216;<samp class="samp">To:</samp>&#8217;, &#8216;<samp class="samp">CC:</samp>&#8217; and &#8216;<samp class="samp">BCC:</samp>&#8217;, you can complete an address by
typing <kbd class="key">TAB</kbd> (<code class="code">message-tab</code>).  This attempts to insert the
full name corresponding to the address based on a couple of methods,
including EUDC, a library that recognizes a number of directory server
protocols (see <a href="https://www.gnu.org/software/emacs/manual/html_node/eudc/index.html#Top">EUDC</a> in <cite class="cite">The Emacs Unified Directory
Client</cite>).  Failing that, it attempts to expand the address as a mail
alias (see <a class="pxref" href="#Mail-Aliases">Mail Aliases</a>).  If point is on a header field that does
not take addresses, or if it is in the message body, then <kbd class="key">TAB</kbd>
just inserts a tab character.
</p>
</div>
<div class="subsection-level-extent" id="Citing-Mail">
<h4 class="subsection" id="Citing-Mail-1">33.4.3 Citing Mail</h4>
<a class="index-entry-id" id="index-citing-mail"></a>

<dl class="table">
<dt><kbd class="kbd">C-c C-y</kbd></dt>
<dd><p>Yank the selected message from the mail reader, as a citation
(<code class="code">message-yank-original</code>).
</p></dd>
<dt><kbd class="kbd">C-c C-q</kbd></dt>
<dd><p>Fill each paragraph cited from another message
(<code class="code">message-fill-yanked-message</code>).
</p></dd>
</dl>

<a class="index-entry-id" id="index-C_002dc-C_002dy-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dyank_002doriginal"></a>
<a class="index-entry-id" id="index-message_002dyank_002dprefix"></a>
<p>You can use the command <kbd class="kbd">C-c C-y</kbd> (<code class="code">message-yank-original</code>)
to <em class="dfn">cite</em> a message that you are replying to.  This inserts the
text of that message into the mail buffer.  This command works only if
the mail buffer is invoked from a mail reader running in Emacs, such
as Rmail.
</p>
<p>By default, Emacs inserts the string &#8216;<samp class="samp">&gt;</samp>&#8217; in front of each line
of the cited text; this prefix string is specified by the variable
<code class="code">message-yank-prefix</code>.  If you call <code class="code">message-yank-original</code>
with a prefix argument, the citation prefix is not inserted.
</p>
<a class="index-entry-id" id="index-C_002dc-C_002dq-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-mail_002dfill_002dyanked_002dmessage"></a>
<p>After using <kbd class="kbd">C-c C-y</kbd>, you can type <kbd class="kbd">C-c C-q</kbd>
(<code class="code">message-fill-yanked-message</code>) to fill the paragraphs of the
cited message.  One use of <kbd class="kbd">C-c C-q</kbd> fills all such paragraphs,
each one individually.  To fill a single paragraph of the quoted
message, use <kbd class="kbd">M-q</kbd>.  If filling does not automatically handle the
type of citation prefix you use, try setting the fill prefix
explicitly.  See <a class="xref" href="Text.xhtml#Filling">Filling Text</a>.
</p>
<a class="index-entry-id" id="index-mail_002dcitation_002dhook"></a>
<p>You can customize mail citation through the hook
<code class="code">mail-citation-hook</code>.  For example, you can use the Supercite
package, which provides more flexible citation
(see <a href="https://www.gnu.org/software/emacs/manual/html_node/sc/Introduction.html#Introduction">Introduction</a> in <cite class="cite">Supercite</cite>).
</p>
</div>
<div class="subsection-level-extent" id="Mail-Misc">
<h4 class="subsection" id="Mail-Miscellany">33.4.4 Mail Miscellany</h4>

<a class="index-entry-id" id="index-C_002dc-C_002da-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-mml_002dattach_002dfile"></a>
<a class="index-entry-id" id="index-MIME"></a>
<a class="index-entry-id" id="index-Multipurpose-Internet-Mail-Extensions"></a>
<p>You can <em class="dfn">attach</em> a file to an outgoing message by typing
<kbd class="kbd">C-c C-a</kbd> (<code class="code">mml-attach-file</code>) in the mail buffer.  Attaching
is done using the Multipurpose Internet Mail Extensions
(<abbr class="acronym">MIME</abbr>) standard.
</p>
<p>The <code class="code">mml-attach-file</code> command prompts for the name of the file,
and for the attachment&#8217;s <em class="dfn">content type</em>, <em class="dfn">description</em>, and
<em class="dfn">disposition</em>.  The content type is normally detected
automatically; just type <kbd class="key">RET</kbd> to accept the default.  The
description is a single line of text that the recipient will see next
to the attachment; you may also choose to leave this empty.  The
disposition is either &#8216;<samp class="samp">inline</samp>&#8217;, which means the recipient will
see a link to the attachment within the message body, or
&#8216;<samp class="samp">attachment</samp>&#8217;, which means the link will be separate from the
body.
</p>
<a class="index-entry-id" id="index-mail_002dadd_002dattachment"></a>
<p>The <code class="code">mml-attach-file</code> command is specific to Message mode; in
Mail mode use <kbd class="kbd">mail-add-attachment</kbd> instead.  It will prompt only
for the name of the file, and will determine the content type and the
disposition automatically.  If you want to include some description of
the attached file, type that in the message body.
</p>
<p>The actual contents of the attached file are not inserted into the
mail buffer.  Instead, some placeholder text is inserted into the mail
buffer, like this:
</p>
<div class="example smallexample">
<pre class="example-preformatted">&lt;#part type=&quot;text/plain&quot; filename=&quot;~/foo.txt&quot; disposition=inline&gt;
&lt;#/part&gt;
</pre></div>

<p>When you type <kbd class="kbd">C-c C-c</kbd> or <kbd class="kbd">C-c C-s</kbd> to send the message, the
attached file will be delivered with it.
</p>
<a class="index-entry-id" id="index-ispell_002dmessage"></a>
<p>While composing a message, you can do spelling correction on the
message text by typing <kbd class="kbd">M-x ispell-message</kbd>.  If you have yanked
an incoming message into the outgoing draft, this command skips what
was yanked, but it checks the text that you yourself inserted (it
looks for indentation or <code class="code">mail-yank-prefix</code> to distinguish the
cited lines from your input).  See <a class="xref" href="Fixit.xhtml#Spelling">Checking and Correcting Spelling</a>.
</p>
<a class="index-entry-id" id="index-message_002dmode_002dhook"></a>
<a class="index-entry-id" id="index-message_002dsetup_002dhook"></a>
<p>Turning on Message mode (which <kbd class="kbd">C-x m</kbd> does automatically) runs
the normal hooks <code class="code">text-mode-hook</code> and <code class="code">message-mode-hook</code>.
Initializing a new outgoing message runs the normal hook
<code class="code">message-setup-hook</code>; you can use this hook if you want to make
changes to the appearance of the mail buffer.  See <a class="xref" href="Customization.xhtml#Hooks">Hooks</a>.
</p>
<p>The main difference between these hooks is just when they are
invoked.  Whenever you type <kbd class="kbd">C-x m</kbd>, <code class="code">message-mode-hook</code> runs
as soon as the mail buffer is created.  Then the <code class="code">message-setup</code>
function inserts the default contents of the buffer.  After these
default contents are inserted, <code class="code">message-setup-hook</code> runs.
</p>
<p>If you use <kbd class="kbd">C-x m</kbd> to continue an existing composition,
<code class="code">message-mode-hook</code> runs immediately after switching to the mail
buffer.  If the buffer is unmodified, or if you decide to erase it and
start again, <code class="code">message-setup-hook</code> runs after the default contents
are inserted.
</p>
</div>
</div>
<div class="section-level-extent" id="Mail-Signature">
<h3 class="section" id="Mail-Signature-1">33.5 Mail Signature</h3>

<a class="index-entry-id" id="index-mail-signature"></a>
<a class="index-entry-id" id="index-message_002dsignature_002dfile"></a>
<a class="index-entry-id" id="index-message_002dsignature"></a>
<p>You can add a standard piece of text&#8212;your <em class="dfn">mail
signature</em>&#8212;to the end of every message.  This signature may contain
information such as your telephone number or your physical location.
The variable <code class="code">message-signature</code> determines how Emacs handles the
mail signature.
</p>
<p>The default value of <code class="code">message-signature</code> is <code class="code">t</code>; this
means to look for your mail signature in the file <samp class="file">~/.signature</samp>.
If this file exists, its contents are automatically inserted into the
end of the mail buffer.  You can change the signature file via the
variable <code class="code">message-signature-file</code>.
</p>
<p>If you change <code class="code">message-signature</code> to a string, that specifies
the text of the signature directly.
</p>
<a class="index-entry-id" id="index-C_002dc-C_002dw-_0028Message-mode_0029"></a>
<a class="index-entry-id" id="index-message_002dinsert_002dsignature"></a>
<p>If you change <code class="code">message-signature</code> to <code class="code">nil</code>, Emacs will not
insert your mail signature automatically.  You can insert your mail
signature by typing <kbd class="kbd">C-c C-w</kbd> (<code class="code">message-insert-signature</code>) in
the mail buffer.  Emacs will look for your signature in the signature
file.
</p>
<a class="index-entry-id" id="index-mail_002dsignature_002dfile"></a>
<a class="index-entry-id" id="index-mail_002dsignature"></a>
<p>If you use Mail mode rather than Message mode for composing your
mail, the corresponding variables that determine how your signature is
sent are <code class="code">mail-signature</code> and <code class="code">mail-signature-file</code> instead.
</p>
<p>By convention, a mail signature should be marked by a line whose
contents are &#8216;<samp class="samp">-- </samp>&#8217;.  If your signature lacks this prefix, it is
added for you.  The remainder of your signature should be no more than
four lines.
</p>
</div>
<div class="section-level-extent" id="Mail-Amusements">
<h3 class="section" id="Mail-Amusements-1">33.6 Mail Amusements</h3>

<a class="index-entry-id" id="index-spook"></a>
<a class="index-entry-id" id="index-NSA"></a>
<p><kbd class="kbd">M-x spook</kbd> adds a line of randomly chosen keywords to an outgoing
mail message.  The keywords are chosen from a list of words that suggest
you are discussing something subversive.
</p>
<p>The idea behind this feature is the suspicion that the
NSA<a class="footnote" id="DOCF18" href="#FOOT18"><sup>18</sup></a> and other intelligence
agencies snoop on all electronic mail messages that contain keywords
suggesting they might find them interesting.  (The agencies say that
they don&#8217;t, but that&#8217;s what they <em class="emph">would</em> say.)  The idea is that if
lots of people add suspicious words to their messages, the agencies will
get so busy with spurious input that they will have to give up reading
it all.  Whether or not this is true, it at least amuses some people.
</p>
<a class="index-entry-id" id="index-fortune_002dto_002dsignature"></a>
<a class="index-entry-id" id="index-fortune-cookies"></a>
<p>You can use the <code class="code">fortune</code> program to put a fortune cookie
message into outgoing mail.  To do this, add
<code class="code">fortune-to-signature</code> to <code class="code">mail-setup-hook</code>:
</p>
<div class="example">
<pre class="example-preformatted">(add-hook 'mail-setup-hook 'fortune-to-signature)
</pre></div>

<p>You will probably need to set the variable <code class="code">fortune-file</code> before
using this.
</p>
</div>
<div class="section-level-extent" id="Mail-Methods">
<h3 class="section" id="Mail_002dComposition-Methods">33.7 Mail-Composition Methods</h3>
<a class="index-entry-id" id="index-mail_002dcomposition-methods"></a>
<a class="index-entry-id" id="index-Mail-mode"></a>
<a class="index-entry-id" id="index-mode_002c-Mail"></a>

<a class="index-entry-id" id="index-MH-mail-interface"></a>
<a class="index-entry-id" id="index-Message-mode-for-sending-mail"></a>
<p>In this chapter we have described the usual Emacs mode for editing
and sending mail&#8212;Message mode.  This is only one of several
available modes.  Prior to Emacs 23.2, the default mode was Mail mode,
which is similar to Message mode in many respects but lacks features
such as MIME support.  Another available mode is MH-E
(see <a href="https://www.gnu.org/software/emacs/manual/html_node/mh-e/index.html#Top">MH-E</a> in <cite class="cite">The Emacs Interface to MH</cite>).
</p>
<a class="index-entry-id" id="index-mail_002duser_002dagent"></a>
<a class="index-entry-id" id="index-define_002dmail_002duser_002dagent"></a>
<p>You can choose any of these <em class="dfn">mail user agents</em> as your preferred
method for editing and sending mail.  The commands <kbd class="kbd">C-x m</kbd>,
<kbd class="kbd">C-x 4 m</kbd> and <kbd class="kbd">C-x 5 m</kbd> use whichever agent you have
specified; so do various other parts of Emacs that send mail, such as
the bug reporter (see <a class="pxref" href="Bugs.xhtml#Bugs">Reporting Bugs</a>).  To specify a mail user agent,
customize the variable <code class="code">mail-user-agent</code>.  Currently, legitimate
values include <code class="code">message-user-agent</code> (Message mode)
<code class="code">sendmail-user-agent</code> (Mail mode), <code class="code">gnus-user-agent</code>, and
<code class="code">mh-e-user-agent</code>.  Additional options may be available; check
in the manual of your mail user agent package for details.  You may
also define another mail user agent using
<code class="code">define-mail-user-agent</code>.
</p>
<p>If you select a different mail-composition method, the information
in this chapter about the mail buffer and Message mode does not apply;
the other methods use a different format of text in a different
buffer, and their commands are different as well.
</p>
<a class="index-entry-id" id="index-read_002dmail_002dcommand"></a>
<p>Similarly, to specify your preferred method for reading mail,
customize the variable <code class="code">read-mail-command</code>.  The default is
<code class="code">rmail</code> (see <a class="pxref" href="Rmail.xhtml#Rmail">Reading Mail with Rmail</a>).
</p></div>
</div>
<div class="footnotes-segment">
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT18" href="#DOCF18">(18)</a></h5>
<p>The US National Security Agency.</p>
</div>



</body>
</html>
